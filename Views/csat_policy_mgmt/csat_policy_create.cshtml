
@{
    ViewData["Title"] = "Create Policy";
    Layout = "~/Views/Shared/ownyit_main_page.cshtml";
}

<body onload="displayapplyonload(); displaypolicydetailsdata();">
    @*<div class="row">
            <div class="headerbar">
                <a href="#" style="padding-left:10px;">Policy Enforcement</a>
            </div>
        </div>*@
    <div class="row">
        <div class="ibox float-e-margins ">
            <div class="ibox-content" style="padding:4px;">
                <div class="pull-right form_label btn_top_margin">
                    <button type="button" class="190 div_none btn btn-primary day" data-toggle="modal" data-target="#nacpolicy_popup" onclick="getnacdatatable()">NAC Policy</button>
                    <button type="button" class="btn btn-primary day" data-toggle="modal" onclick="displaypolicypopupdata()">Create Policy</button>
                </div>
                <ul class="breadcrumb" style="margin-bottom:0px;">
                    <li>
                        @Html.ActionLink("Policy Enforcement", "csat_policy_mgmt", "csat_policy_mgmt")
                        <i class="icon-angle-right"></i>
                    </li>
                    <li>Define Policy</li>
                </ul>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-sm-12 col-md-12 col-lg-12" style="margin-top: 5px;">
            @*<div class="row">
                <div class="ibox float-e-margins ">
                    <div class="ibox-content" style="padding:4px;">
                        <ul class="breadcrumb" style="margin-bottom:0px;">
                            <li>
                                @Html.ActionLink("Policy Enforcement", "csat_policy_mgmt", "csat_policy_mgmt")
                                <i class="icon-angle-right"></i>
                            </li>
                            <li>Define Policy</li>
                        </ul>
                    </div>
                </div>
                </div>*@

            @*<div class="row">
                    <div class="col-sm-12 col-md-12 col-lg-12">
                        <div class="row">
                            <div class="col-xs-12">
                                <form class="form-horizontal" method="post">
                                    <div class="form-group">
                                        <label for="nameField" class="col-xs-1"></label>
                                        <div class="pull-right col-xs-2" style="margin-right: 108px;">
                                            <button type="button" class="btn btn-primary  day" data-toggle="modal" onclick="displaypolicypopupdata()">Create Policy</button>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>*@

            <div class="row ibox">
                <div class="col-xs-1"></div>
                <div class="col-sm-10 col-md-10 col-lg-10 ibox2-content">
                    <div>
                        <div class="col-sm-12 col-md-12 col-lg-12" id="divpolicydetails_div">
                            <table id="divpolicydetails" class="table table-striped table-bordered " width="100%"></table>
                        </div>
                    </div>
                    @*<div class="table-responsive" id="divpolicydetails">

                        </div>*@
                    @*<div class="space_bottom">&nbsp;</div>*@
                </div>
            </div>

            <div class="row ibox2">
                <div class="col-sm-12 col-md-12 col-lg-12 ibox2-content">
                    <div class="row">
                        <div class="col-xs-12">
                            <form class="" method="post" name="frm_applypolicy" id="frm_applypolicy">
                                <div class="form-group">
                                    <label for="nameField" class="col-xs-1"></label>
                                    <label for="nameField" class="col-sm-1 form_label">Apply Policy On</label>
                                    <div class="col-xs-3">
                                        <select class="form-control col-sm-3 col-lg-3 col-md-3 " name="Branch/Unit" id="DrpOU">
                                            <option value="01" selected>Branch/ Unit</option>
                                            <option value="02">System</option>
                                            @*<option value="03">User</option>*@
                                        </select>
                                    </div>
                                </div>
                                <div id="system_show" style="display:none">
                                    <div class="form-group">
                                        <label for="nameField" class="col-xs-1  text-align-right">System Name</label>
                                        <div class="col-xs-2">
                                            <input type="text" class="form-control col-sm-3 col-lg-3 col-md-3" placeholder="" name="SN1" id="SN1">
                                        </div>
                                        <label for="nameField" class="col-xs-1  text-align-right">IP Address</label>
                                        <div class="col-xs-2">
                                            <input type="text" class="form-control col-sm-3 col-lg-3 col-md-3" placeholder="" name="IP1" id="IP1">
                                        </div>
                                        <input type="button" class="btn btn-primary" value="Show" onclick="Func_syswise()">
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>

                <div class="col-xs-1"></div>
                <div class="col-sm-10 col-md-10 col-lg-10 ibox2-content">
                    <div>
                        <div class="col-sm-12 col-md-12 col-lg-12" id="apppolicy_div">
                            <table id="apppolicy" class="table table-striped table-bordered " width="100%"></table>
                        </div>
                    </div>
                    <div class='pull-left col-xs-1'><button type='button' class='btn btn-primary' id='btnpolicyapplied' onclick="apply_policy()" style='display:none'> Apply</button></div>
                </div>
                <div>&nbsp;</div>
            </div>

            @*<div class="row" style="margin-bottom: 20px;">
                    <div>&nbsp;</div>
                    <div class="col-sm-12 col-md-12 col-lg-12">
                        <div class="row">
                            <div class="col-xs-10">
                                <label for="nameField" class="col-sm-1"></label>
                                <div class="pull-left col-xs-1">
                                    <button type="button" class="btn btn-primary" id="btnpolicyapplied">Apply</button>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>*@

            <div class="space_bottom">&nbsp;</div>

        </div>
    </div>
    <div class="modal fade" id="policy_popup" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static" data-keyboard="false">
        <div class="modal-dialog  modal-lg ">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true" onclick="cleardata()"> &times;</button>
                    <h6 class=" modal-title">
                        Create Policy
                    </h6>
                </div>
                <div class="modal-body model_body_scroll">
                    <div class="row">
                        <div class="col-xs-12">
                            <form class="form-horizontal" method="post" id="CreatePolicyValidation" name="CreatePolicyValidation">
                                @*<div class="form-group">
                                        <label for="nameField" class="col-xs-2">Type of Policy</label>
                                        <div class="col-xs-3">
                                            <select class="form-control col-sm-3 col-lg-3 col-md-3" name="Policy_apply" id="Policypopup_apply">
                                                <option value="1" selected>Hardware</option>
                                                <option value="2">Rules</option>
                                                <option value="3">Share</option>
                                                <option value="4">User Policy</option>
                                                <option value="6">Remote Desktop Policy</option>
                                                <option value="42">Password Complexity</option>
                                                <option value="7">IP Change Restriction</option>
                                                <option value="11">Login Restriction Policy</option>
                                                <option value="8">Shutdown Policy</option>
                                                <option value="10">Power Saver Policy</option>
                                                <option value="9">IP + Port Blocking</option>
                                            </select>
                                        </div>
                                    </div>*@
                                <div class="form-group">
                                    <label for="nameField" class="col-xs-1 form_label">Policy Name</label>
                                    <div class="col-xs-3">
                                        <input type="text" name="txtpolicyname" class="form-control" placeholder="Policy Name" id="txtpolicyname" autocomplete="off">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="nameField" class="col-xs-1 form_label">Description</label>
                                    <div class="col-xs-3">
                                        <textarea class="form-control" rows="2" placeholder="Description" id="txtpolicydesc" name="txtpolicydesc" autocomplete="off"></textarea>
                                    </div>
                                </div>
                                @*<button type="submit" class='btn btn-primary' id='CreatePolicyValidationFormSubmit' style="display:none" >Create</button>*@
                            </form>
                        </div>
                    </div>
                    <div class="row">
                        <div class="pull-right col-xs-1" style="margin-right:15px;">
                            <button type="submit" class="btn btn-primary" id="rules_form"> Define Rules</button>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-12 col-md-12 col-lg-12">
                            <div>
                                <div class="col-sm-12 col-md-12 col-lg-12" id="divpolicydata_div">
                                    <table id="divpolicydata" class="table table-striped table-bordered " width="100%"></table>
                                </div>
                            </div>
                            <div class='pull-left col-xs-1'>
                                @*<button type="button" class='btn btn-primary' name='submit1' id='btnsavepolicy'>Create</button>*@
                                <input type='button' class='btn btn-primary' value='Create' name='btnsavepolicy' id='btnsavepolicy' onclick="save_policy()" style="display:none">
                            </div>

                            <div class="space_bottom">&nbsp;</div>
                        </div>

                    </div>

                    <div id="rules_form_show" style="display:none;">

                        <div class="space_bottom">&nbsp;</div>

                        <div class="row">

                            <div class="col-xs-12" style="border-bottom:1px solid #dedede;padding-bottom:8px;">
                                <div>
                                    <h6>
                                        Create Rules
                                    </h6>
                                </div>
                            </div>

                            <div class="space_bottom">&nbsp;</div>

                            <div class="col-xs-12">
                                <form class="form-horizontal" method="post" id="CreateRulesF" name="CreateRulesF">
                                    <div class="form-group">
                                        <label for="nameField" class="col-xs-2">Type of Rules</label>
                                        <div class="col-xs-3">
                                            <select class="form-control col-sm-3 col-lg-3 col-md-3 " name="Policy_apply" id="select_policy">
                                                <option value="1" class="117 div_none" selected>Hardware</option>
                                                <option value="2" class="118 div_none">Rules</option>
                                                <option value="3" class="119 div_none">Share</option>
                                                <option value="4" class="120 div_none">User Policy</option>
                                                <option value="6" class="121 div_none">Remote Desktop Policy</option>
                                                <option value="42" class="122 div_none">Password Complexity</option>
                                                <option value="7" class="123 div_none">IP Change Restriction</option>
                                                <option value="11" class="124 div_none">Login Restriction Policy</option>
                                                <option value="8" class="125 div_none">Shutdown Policy</option>
                                                <option value="10" class="126 div_none">Power Saver Policy</option>
                                                <option value="9" class="127 div_none">IP + Port Blocking</option>
                                                <option value="12" class="128 div_none">Event Monitoring</option>
                                                <option value="13" class="129 div_none">Disk Cleanup</option>
                                                <option value="15" class="183 div_none">Firewall</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="nameField" class="col-xs-2">Rules Name</label>
                                        <div class="col-xs-3">
                                            <input type="text" name="txtrulesname" class="form-control" placeholder="Rules Name" id="txtrulesname" autocomplete="off">
                                        </div>
                                    </div>

                                    <div id="hardware" class="hideable">
                                        <div class="form-group">
                                            <label for="nameField" class="col-xs-2">Hardware Type</label>
                                            <div class="col-xs-3">
                                                <select class="form-control col-sm-3 col-lg-3 col-md-3 " id="dl_hrd_type">
                                                    <option value="1">Floppy Drive</option>
                                                    <option value="2">CD Drive</option>
                                                    <option value="3">Sound Card</option>
                                                    <option value="4">Printer</option>
                                                    <option value="5">WI-FI</option>
                                                    <option value="6">USB Port</option>
                                                    <option value="7">USB Printer</option>
                                                    <option value="8">USB Modem</option>
                                                    <option value="9">USB Storage</option>
                                                    <option value="10">Bluetooth</option>
                                                    <option value="11">USB Read & Write</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div style="display:none" id="usb">
                                            <div class="form-group">
                                                <label for="nameField" class="col-xs-2">Action</label>
                                                <div class="col-xs-2 col-md-1 col-lg-1" style="padding-top:2px;">
                                                    <div class="radio">
                                                        <label> <input type="radio" name="SerialNumber1" id="hwwrite" value="1" checked> Write Only </label>
                                                    </div>
                                                </div>
                                                <div class="col-xs-2 col-md-1 col-lg-1" style="padding-top:2px;">
                                                    <div class="radio">
                                                        <label> <input type="radio" name="SerialNumber1" id="hwread" value="0"> Read Only </label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div id="nonusb">
                                            <div class="form-group">
                                                <label for="nameField" class="col-xs-2">Action</label>
                                                <div class="col-xs-2 col-md-1 col-lg-1" style="padding-top:2px;">
                                                    <div class="radio">
                                                        <label> <input type="radio" name="SerialNumber" id="allenable" value="1" checked> Enable </label>
                                                    </div>
                                                </div>
                                                <div class="col-xs-2 col-md-1 col-lg-1" style="padding-top:2px;">
                                                    <div class="radio">
                                                        <label> <input type="radio" name="SerialNumber" id="alldisable" value="0"> Disable </label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div id="rules" class="hideable">
                                        <div class="form-group">
                                            <label for="nameField" class="col-xs-2">Select Rules</label>
                                            <div class="col-xs-3">
                                                <select class="form-control col-sm-3 col-lg-3 col-md-3 " id="select_rules_subtype">
                                                    <option value="1">CPU Usage Monitoring</option>
                                                    <option value="2">Memory Usage Monitoring</option>
                                                    <option value="3">Disk Usage Monitoring</option>
                                                    <option value="4">Application Monitoring</option>
                                                    <option value="5">Application Kill</option>
                                                </select>
                                            </div>
                                        </div>

                                        <div id="cpu_usage_monitoring" class="hideable1">
                                            <div class="form-group">
                                                <label for="nameField" class="col-xs-2">Define Higher CPU Usage in %</label>
                                                <div class="col-xs-3">
                                                    <input type="text" name="txtcpuusage" class="form-control" placeholder="%" id="txtcpuusage" autocomplete="off">
                                                </div>
                                            </div>
                                        </div>

                                        <div id="memory_usage_monitoring" class="hideable1">
                                            <div class="form-group">
                                                <label for="nameField" class="col-xs-2">Define Higher Memory Usage in %</label>
                                                <div class="col-xs-3">
                                                    <input type="text" name="txtmemoryusage" class="form-control" placeholder="%" id="txtmemoryusage" autocomplete="off">
                                                </div>
                                            </div>
                                        </div>

                                        <div id="disk_usage_monitoring" class="hideable1">
                                            <div class="form-group">
                                                <label for="nameField" class="col-xs-2">Define Higher Disk Usage in %</label>
                                                <div class="col-xs-3">
                                                    <input type="text" name="txtdiskusage" class="form-control" placeholder="%" id="txtdiskusage" autocomplete="off">
                                                </div>
                                            </div>
                                        </div>

                                        <div id="application_monitoring" class="hideable1">
                                            @*<div class="form-group">
                                                    <label for="nameField" class="col-xs-2">Select Process</label>
                                                    <div class="col-xs-3">
                                                        <select class="form-control col-sm-3 col-lg-3 col-md-3 " name="drp_process" id="drp_process"></select>
                                                    </div>
                                                </div>*@
                                            @*<div class="form-group">
                                                    <label for="nameField" class="col-xs-2">Threshold Type</label>
                                                    <div class="col-xs-3">
                                                        <select class="form-control col-sm-3 col-lg-3 col-md-3 " id="drp_Threshold">

                                                            <option value="0">Memory</option>
                                                            <option value="1">CPU</option>

                                                        </select>
                                                    </div>

                                                </div>*@
                                            <div class="form-group">
                                                <label for="nameField" class="col-xs-2">CPU Define Higher  Usage in %</label>
                                                <div class="col-xs-3">
                                                    <input type="text" name="txtcputhresold" class="form-control" placeholder="%" id="txtcputhresold" autocomplete="off">
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label for="nameField" class="col-xs-2">Memory Define Higher  Usage in %</label>
                                                <div class="col-xs-3">
                                                    <input type="text" name="txtmemorythresold" class="form-control" placeholder="%" id="txtmemorythresold" autocomplete="off">
                                                </div>
                                            </div>
                                            @*<div class="form-group">
                                                    <label for="nameField" class="col-xs-2">Process CRC</label>
                                                    <div class="col-sm-5 col-md-5 col-lg-5">
                                                        <div class="table-responsive" id="processcrc">
                                                            <table class='table table-striped table-bordered policynew_datatable' style='width:100%;'>
                                                                <thead>
                                                                    <tr>
                                                                        <th class='select' data-orderable='false'><input type='checkbox' class='parent' data-group='.group4' /></th>
                                                                        <th>List of Process CRC</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                            </table>
                                                        </div>
                                                    </div>
                                                </div>*@
                                        </div>

                                        <div id="application_kill" class="hideable1">
                                            <div class="form-group">
                                                <label for="nameField" class="col-xs-2">Select Process</label>
                                                <div class="col-xs-3">
                                                    <div id="action_select">
                                                        <select class="form-control col-sm-3 col-lg-3 col-md-3 process_alert" name="drp_process" id="drp_process"></select>
                                                    </div>
                                                    <div id="action_text">
                                                        <input type="text" class="form-control process_alert" name="process_name" id="process_name" placeholder="Process Name" autocomplete="off" />
                                                    </div>
                                                </div>
                                                <div class="col-xs-1">
                                                    <div class="checkbox">
                                                        <label><input type="checkbox" id="action_check"></label>
                                                    </div>
                                                </div>
                                            </div>
                                            @*<div class="form-group">
                                                    <label for="nameField" class="col-xs-2">Threshold Type</label>
                                                    <div class="col-xs-3">
                                                        <select class="form-control col-sm-3 col-lg-3 col-md-3 " id="drp_Threshold">
                                                            <option value="0">Memory</option>
                                                            <option value="1">CPU</option>
                                                        </select>
                                                    </div>
                                                </div>
                                                <div class="form-group">
                                                    <label for="nameField" class="col-xs-2">Define Higher  Usage in %</label>
                                                    <div class="col-xs-3">
                                                        <input type="text" name="" class="form-control" placeholder="%" id="txtthresold">
                                                    </div>
                                                </div>*@
                                            <div class="form-group">
                                                <label for="nameField" class="col-xs-2">Process CRC</label>
                                                <div class="col-sm-5 col-md-5 col-lg-5">
                                                    <div class="table-responsive" id="processcrc">
                                                        <table class='table table-striped table-bordered policynew_datatable' style='width:100%;'>
                                                            <thead>
                                                                <tr>
                                                                    <th class='select' data-orderable='false'><input type='checkbox' class='parent' data-group='.group4' /></th>
                                                                    <th>List of Process CRC</th>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div id="share" class="hideable">
                                        <div class="form-group">
                                            @*<label for="nameField" class="col-xs-2">Action</label>*@
                                            <label for="nameField" class="col-xs-2">Share Delete Day</label>
                                            <div class="col-xs-3">
                                                <select class="form-control col-sm-3 col-lg-3 col-md-3 " name="share_delete_days" id="share_delete_days">
                                                    <option value="">NA</option>
                                                    <option value="0">0</option>
                                                    <option value="1">1</option>
                                                    <option value="2">2</option>
                                                    <option value="3">3</option>
                                                    <option value="4">4</option>
                                                    <option value="5">5</option>
                                                    <option value="6">6</option>
                                                    <option value="7">7</option>
                                                    <option value="8">8</option>
                                                    <option value="9">9</option>
                                                    <option value="10">10</option>
                                                    <option value="11">11</option>
                                                    <option value="12">12</option>
                                                    <option value="13">13</option>
                                                    <option value="14">14</option>
                                                    <option value="15">15</option>
                                                    <option value="16">16</option>
                                                    <option value="17">17</option>
                                                    <option value="18">18</option>
                                                    <option value="19">19</option>
                                                    <option value="20">20</option>
                                                    <option value="21">21</option>
                                                    <option value="22">22</option>
                                                    <option value="23">23</option>
                                                    <option value="24">24</option>
                                                    <option value="25">25</option>
                                                    <option value="26">26</option>
                                                    <option value="27">27</option>
                                                    <option value="28">28</option>
                                                    <option value="29">29</option>
                                                    <option value="30">30</option>
                                                    <option value="30">31</option>
                                                </select>
                                                @*<select class="form-control col-sm-3 col-lg-3 col-md-3 " id="share_action">
                                                        <option value="1">Disable</option>
                                                        <option value="2">Delete</option>
                                                    </select>*@
                                            </div>
                                        </div>
                                        @*<div class="form-group">
                                                <label for="nameField" class="col-xs-2">Share Disable Day</label>
                                                <div class="col-xs-3">
                                                    <select class="form-control col-sm-3 col-lg-3 col-md-3 " id="share_days">
                                                        <option value="1">1</option>
                                                        <option value="2">2</option>
                                                        <option value="3">3</option>
                                                        <option value="4">4</option>
                                                        <option value="5">5</option>
                                                        <option value="6">6</option>
                                                        <option value="7">7</option>
                                                        <option value="8">8</option>
                                                        <option value="9">9</option>
                                                        <option value="10">10</option>
                                                    </select>
                                                </div>
                                            </div>*@
                                    </div>

                                    <div id="user_policy" class="hideable">
                                        @*<div class="form-group">
                                            <label for="nameField" class="col-xs-2">Password not Changed [Delete] </label>
                                            <div class="col-xs-3">
                                                <select class="form-control col-sm-3 col-lg-3 col-md-3 " id="userrulesdaydelete">
                                                    <option value="NA">NA</option>
                                                    <option value="1">1</option>
                                                    <option value="2">2</option>
                                                    <option value="3">3</option>
                                                    <option value="4">4</option>
                                                    <option value="5">5</option>
                                                    <option value="6">6</option>
                                                    <option value="7">7</option>
                                                    <option value="8">8</option>
                                                    <option value="9">9</option>
                                                    <option value="10">10</option>
                                                    <option value="11">11</option>
                                                    <option value="12">12</option>
                                                    <option value="13">13</option>
                                                    <option value="14">14</option>
                                                    <option value="15">15</option>
                                                    <option value="16">16</option>
                                                    <option value="17">17</option>
                                                    <option value="18">18</option>
                                                    <option value="19">19</option>
                                                    <option value="20">20</option>
                                                    <option value="21">21</option>
                                                    <option value="22">22</option>
                                                    <option value="23">23</option>
                                                    <option value="24">24</option>
                                                    <option value="25">25</option>
                                                    <option value="26">26</option>
                                                    <option value="27">27</option>
                                                    <option value="28">28</option>
                                                    <option value="29">29</option>
                                                    <option value="30">30</option>
                                                    <option value="30">31</option>
                                                </select>
                                                @*<input type="text" name="" class="form-control" placeholder="Day" id="userrulesday">*@
                                        @*</div>
                                            </div>
                                            <div class="form-group">
                                                <label for="nameField" class="col-xs-2">Password not Changed [Disable] </label>
                                                <div class="col-xs-3">
                                                    <select class="form-control col-sm-3 col-lg-3 col-md-3 " id="userrulesdaydisable">
                                                        <option value="NA">NA</option>
                                                        <option value="1">1</option>
                                                        <option value="2">2</option>
                                                        <option value="3">3</option>
                                                        <option value="4">4</option>
                                                        <option value="5">5</option>
                                                        <option value="6">6</option>
                                                        <option value="7">7</option>
                                                        <option value="8">8</option>
                                                        <option value="9">9</option>
                                                        <option value="10">10</option>
                                                        <option value="11">11</option>
                                                        <option value="12">12</option>
                                                        <option value="13">13</option>
                                                        <option value="14">14</option>
                                                        <option value="15">15</option>
                                                        <option value="16">16</option>
                                                        <option value="17">17</option>
                                                        <option value="18">18</option>
                                                        <option value="19">19</option>
                                                        <option value="20">20</option>
                                                        <option value="21">21</option>
                                                        <option value="22">22</option>
                                                        <option value="23">23</option>
                                                        <option value="24">24</option>
                                                        <option value="25">25</option>
                                                        <option value="26">26</option>
                                                        <option value="27">27</option>
                                                        <option value="28">28</option>
                                                        <option value="29">29</option>
                                                        <option value="30">30</option>
                                                        <option value="30">31</option>
                                                    </select>*@
                                        @*<input type="text" name="" class="form-control" placeholder="Day" id="userrulesday">*@
                                        @*</div>*@
                                        @*</div>*@
                                        <div class="form-group">
                                            <label for="nameField" class="col-xs-2">Select Rules</label>
                                            <div class="col-xs-3">
                                                <select class="form-control col-sm-3 col-lg-3 col-md-3 " id="userrulealert">
                                                    <option value="1">Disable</option>
                                                    <option value="2">Delete</option>
                                                    <option value="3">Alert</option>
                                                </select>
                                            </div>
                                        </div>


                                        <div class="form-group">
                                            <label for="nameField" class="col-xs-2">Password not Changed Day</label>
                                            <div class="col-xs-3">
                                                <select class="form-control col-sm-3 col-lg-3 col-md-3 " id="userrulesdayalert" name="userrulesdayalert">
                                                    <option value="">NA</option>
                                                    <option value="0">0</option>
                                                    <option value="1">1</option>
                                                    <option value="2">2</option>
                                                    <option value="3">3</option>
                                                    <option value="4">4</option>
                                                    <option value="5">5</option>
                                                    <option value="6">6</option>
                                                    <option value="7">7</option>
                                                    <option value="8">8</option>
                                                    <option value="9">9</option>
                                                    <option value="10">10</option>
                                                    <option value="11">11</option>
                                                    <option value="12">12</option>
                                                    <option value="13">13</option>
                                                    <option value="14">14</option>
                                                    <option value="15">15</option>
                                                    <option value="16">16</option>
                                                    <option value="17">17</option>
                                                    <option value="18">18</option>
                                                    <option value="19">19</option>
                                                    <option value="20">20</option>
                                                    <option value="21">21</option>
                                                    <option value="22">22</option>
                                                    <option value="23">23</option>
                                                    <option value="24">24</option>
                                                    <option value="25">25</option>
                                                    <option value="26">26</option>
                                                    <option value="27">27</option>
                                                    <option value="28">28</option>
                                                    <option value="29">29</option>
                                                    <option value="30">30</option>
                                                    <option value="30">31</option>
                                                </select>
                                            </div>
                                        </div>

                                        @*<div class="form-group">
                                                <label for="nameField" class="col-xs-2">User</label>
                                                <div class="col-xs-3">
                                                    <select class="form-control col-sm-3 col-lg-3 col-md-3 " id="drpuser"></select>
                                                </div>
                                            </div>*@
                                        @*<div class="form-group">
                                                <label for="nameField" class="col-xs-2">Action</label>
                                                <div class="col-xs-3">
                                                    <select class="form-control col-sm-3 col-lg-3 col-md-3 " id="userpolicyaction">
                                                        <option value="0">Alert</option>
                                                        <option value="1">Disable</option>
                                                        <option value="2">Delete</option>
                                                    </select>
                                                </div>
                                            </div>*@
                                    </div>

                                    <div id="remote_desktop_policy" class="hideable">
                                        <div class="form-group">
                                            <label for="nameField" class="col-xs-2">Action</label>
                                            <div class="col-xs-2 col-md-1 col-lg-1" style="padding-top:2px;">
                                                <div class="radio">
                                                    <label> <input type="radio" name="SerialNumber2" id="rmtenable" value="1" checked> Enable </label>
                                                </div>
                                            </div>
                                            <div class="col-xs-2 col-md-1 col-lg-1" style="padding-top:2px;">
                                                <div class="radio">
                                                    <label> <input type="radio" name="SerialNumber2" id="rmtdisable" value="0"> Disable </label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div id="password_complexity" class="hideable">
                                        <div class="form-group">
                                            <label for="nameField" class="col-xs-2">Action</label>
                                            <div class="col-xs-2 col-md-1 col-lg-1" style="padding-top:2px;">
                                                <div class="radio">
                                                    <label> <input type="radio" name="SerialNumber3" id="passenable" value="1" checked> Enable </label>
                                                </div>
                                            </div>
                                            <div class="col-xs-2 col-md-1 col-lg-1" style="padding-top:2px;">
                                                <div class="radio">
                                                    <label> <input type="radio" name="SerialNumber3" id="passdisable" value="0"> Disable </label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div id="ip_change_restriction" class="hideable">
                                        <div class="form-group">
                                            <label for="nameField" class="col-xs-2">Action</label>
                                            <div class="col-xs-2 col-md-1 col-lg-1" style="padding-top:2px;">
                                                <div class="radio">
                                                    <label> <input type="radio" name="SerialNumber4" id="ipchgenable" value="1" checked> Enable </label>
                                                </div>
                                            </div>
                                            <div class="col-xs-2 col-md-1 col-lg-1" style="padding-top:2px;">
                                                <div class="radio">
                                                    <label> <input type="radio" name="SerialNumber4" id="ipchgdisable" value="0"> Disable </label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div id="login_restriction_policy" class="hideable">
                                        <div class="form-group">
                                            <label for="nameField" class="col-xs-2">OS Type</label>
                                            <div class="col-xs-2 col-md-1 col-lg-1" style="padding-top:2px;">
                                                <div class="radio">
                                                    <label> <input type="radio" name="SerialNumber7" id="oswindows" value="0" checked> Windows </label>
                                                </div>
                                            </div>
                                            <div class="col-xs-2 col-md-1 col-lg-1" style="padding-top:2px;">
                                                <div class="radio">
                                                    <label> <input type="radio" name="SerialNumber7" id="oslinux" value="1"> Linux </label>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label for="nameField" class="col-xs-2">User Name</label>
                                            <div class="col-xs-3">
                                                <select class="form-control col-sm-3 col-lg-3 col-md-3 " name="drploginuser" id="drploginuser"></select>
                                            </div>
                                        </div>

                                        <div class="form-group">
                                            <label for="nameField" class="col-xs-2">Week Selection</label>
                                            <div class="col-xs-4">
                                                <div class="table-responsive">
                                                    <table class="table table-striped table-bordered tbldemo" style="width:100%">
                                                        <thead>
                                                            <tr>
                                                                <th class="col-sm-1 icon_center" data-orderable="false"><input type="checkbox" class="parent" data-group=".group1" id="check11[]" onclick='checkallitems(this,this.id)' /></th>
                                                                <th class="col-sm-5" data-orderable="false"> Select Days</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            <tr>
                                                                <td class="col-sm-1 icon_center"><input type="checkbox" class="group1" name="check11[]" id='Sunday' value="Sunday" /></td>
                                                                <td class="col-sm-5">
                                                                    Sunday
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td class="col-sm-1 icon_center"><input type="checkbox" class="group1" name="check11[]" id='Monday' value="Monday" /></td>
                                                                <td class="col-sm-5">
                                                                    Monday
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td class="col-sm-1 icon_center"><input type="checkbox" class="group1" name="check11[]" id='Tuesday' value="Tuesday" /></td>
                                                                <td class="col-sm-5">
                                                                    Tuesday
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td class="col-sm-1 icon_center"><input type="checkbox" class="group1" name="check11[]" id='Wednesday' value="Wednesday" /></td>
                                                                <td class="col-sm-5">
                                                                    Wednesday
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td class="col-sm-1 icon_center"><input type="checkbox" class="group1" name="check11[]" id='Thursday' value="Thursday" /></td>
                                                                <td class="col-sm-5">
                                                                    Thursday
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td class="col-sm-1 icon_center"><input type="checkbox" class="group1" name="check11[]" id='Friday' value="Friday" /></td>
                                                                <td class="col-sm-5">
                                                                    Friday
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td class="col-sm-1 icon_center"><input type="checkbox" class="group1" name="check11[]" id='Saturday' value="Saturday" /></td>
                                                                <td class="col-sm-5">
                                                                    Saturday
                                                                </td>
                                                            </tr>

                                                        </tbody>
                                                    </table>
                                                </div>
                                                <label for="nameField" class="col-xs-3">Start Time</label>
                                                <div class="col-xs-3">
                                                    <select class="form-control col-sm-3 col-lg-3 col-md-3 " id="starthour">
                                                        <option value="00">00</option>
                                                        <option value="01">01</option>
                                                        <option value="02">02</option>
                                                        <option value="03">03</option>
                                                        <option value="04">04</option>
                                                        <option value="05">05</option>
                                                        <option value="06">06</option>
                                                        <option value="07">07</option>
                                                        <option value="08">08</option>
                                                        <option value="09" selected>09</option>
                                                        <option value="10">10</option>
                                                        <option value="11">11</option>
                                                        <option value="12">12</option>
                                                        <option value="13">13</option>
                                                        <option value="14">14</option>
                                                        <option value="15">15</option>
                                                        <option value="16">16</option>
                                                        <option value="17">17</option>
                                                        <option value="18">18</option>
                                                        <option value="19">19</option>
                                                        <option value="20">20</option>
                                                        <option value="21">21</option>
                                                        <option value="22">22</option>
                                                        <option value="23">23</option>
                                                    </select>
                                                </div>
                                                <label for="nameField" class="col-xs-3">End Time</label>
                                                <div class="col-xs-3">
                                                    <select class="form-control col-sm-3 col-lg-3 col-md-3 " id="endhour">
                                                        <option value="00">00</option>
                                                        <option value="01">01</option>
                                                        <option value="02">02</option>
                                                        <option value="03">03</option>
                                                        <option value="04">04</option>
                                                        <option value="05">05</option>
                                                        <option value="06">06</option>
                                                        <option value="07">07</option>
                                                        <option value="08">08</option>
                                                        <option value="09">09</option>
                                                        <option value="10">10</option>
                                                        <option value="11">11</option>
                                                        <option value="12">12</option>
                                                        <option value="13">13</option>
                                                        <option value="14">14</option>
                                                        <option value="15">15</option>
                                                        <option value="16">16</option>
                                                        <option value="17">17</option>
                                                        <option value="18" selected>18</option>
                                                        <option value="19">19</option>
                                                        <option value="20">20</option>
                                                        <option value="21">21</option>
                                                        <option value="22">22</option>
                                                        <option value="23">23</option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>
                                        @*<div class="form-group">
                                                     <label for="nameField" class="col-xs-2">Action</label>

                                                     <div class="col-xs-2 col-md-1 col-lg-1" style="padding-top:2px;">
                                                         <div class="radio">
                                                             <label> <input type="radio" name="Serial Number" value="1" checked> Enable </label>
                                                         </div>
                                                     </div>
                                                     <div class="col-xs-2 col-md-1 col-lg-1" style="padding-top:2px;">
                                                         <div class="radio">
                                                             <label> <input type="radio" name="Serial Number" value="0"> Disable </label>
                                                         </div>
                                                     </div>
                                            </div>*@

                                    </div>

                                    <div id="shutdown_policy" class="hideable">
                                        <div class="form-group">
                                            <label for="nameField" class="col-xs-2">Shutdown at O'clock</label>
                                            <div class="col-xs-3">
                                                <input type="text" name="time" class="form-control" placeholder="HH:mm" id="shutdowbnclock">
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label for="nameField" class="col-xs-2">Action</label>
                                            <div class="col-xs-2 col-md-1 col-lg-1" style="padding-top:2px;">
                                                <div class="radio">
                                                    <label> <input type="radio" name="SerialNumber5" id="shutenable" value="0" checked> Gracefully  </label>
                                                </div>
                                            </div>
                                            <div class="col-xs-2 col-md-1 col-lg-1" style="padding-top:2px;">
                                                <div class="radio">
                                                    <label>
                                                        <input type="radio" name="SerialNumber5" id="shutdisable" value="1"> Forcefully
                                                    </label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div id="power_saver_policy" class="hideable">
                                        <div class="form-group">
                                            <label for="nameField" class="col-xs-2">Select Rules</label>
                                            <div class="col-xs-3">
                                                <select class="form-control col-sm-3 col-lg-3 col-md-3 " id="powersavermode">
                                                    <option value="1">Turn Off Monitor</option>
                                                    <option value="2">System Stand By</option>
                                                    <option value="3">System Hibernate</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label for="nameField" class="col-xs-2">Action</label>
                                            <div class="col-xs-3">
                                                <select class="form-control col-sm-3 col-lg-3 col-md-3 " id="powersaverMinutes">
                                                    <option value="1"> After 1 mins</option>
                                                    <option value="2"> After 2 mins</option>
                                                    <option value="5"> After 5 mins</option>
                                                    <option value="10"> After 10 mins</option>
                                                    <option value="15"> After 15 mins</option>
                                                    <option value="20"> After 20 mins</option>
                                                    <option value="25"> After 25 mins</option>
                                                    <option value="30"> After 30 mins</option>
                                                    <option value="45"> After 30 mins</option>

                                                </select>
                                            </div>
                                        </div>
                                    </div>

                                    <div id="ipport_blocking_policy" class="hideable">
                                        <div class="form-group">
                                            <label for="nameField" class="col-xs-2">Select Protocol</label>
                                            <div class="col-xs-3">
                                                <select class="form-control col-sm-3 col-lg-3 col-md-3 " id="protocol">
                                                    <option value="1">TCP</option>
                                                    <option value="2">UDP</option>
                                                    <option value="3">ICMP</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label for="nameField" class="col-xs-2">Source IP </label>
                                            <div class="col-xs-3">
                                                <input type="text" name="" class="form-control" placeholder="Source IP" id="txtsourceip" autocomplete="off">
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label for="nameField" class="col-xs-2">Source Port </label>
                                            <div class="col-xs-3">
                                                <input type="text" name="" class="form-control" placeholder="Source Port" id="txtsourceport" autocomplete="off">
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label for="nameField" class="col-xs-2">Destination IP </label>
                                            <div class="col-xs-3">
                                                <input type="text" name="" class="form-control" placeholder="Destination IP" id="txtdestip" autocomplete="off">
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label for="nameField" class="col-xs-2">Destination Port </label>
                                            <div class="col-xs-3">
                                                <input type="text" name="" class="form-control" placeholder="Destination Port" id="txtdestport" autocomplete="off">
                                            </div>
                                        </div>

                                        <div class="form-group">
                                            <label for="nameField" class="col-xs-2">Action</label>
                                            <div class="col-xs-2 col-md-1 col-lg-1" style="padding-top:2px;">
                                                <div class="radio">
                                                    <label> <input type="radio" name="SerialNumber6" value="0" id="ipblockenable" checked> Allow  </label>
                                                </div>
                                            </div>
                                            <div class="col-xs-2 col-md-1 col-lg-1" style="padding-top:2px;">
                                                <div class="radio">
                                                    <label><input type="radio" name="SerialNumber6" id="ipblockdisable" value="1"> Deny </label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div id="event_monitoring" class="hideable">
                                        <div class="form-group">
                                            <label for="nameField" class="col-xs-2">Event Type</label>
                                            <div class="col-xs-3">
                                                <select class="form-control col-sm-3 col-lg-3 col-md-3" name="Type" id="drp_event_type_new">
                                                    <option value="1">Application</option>
                                                    <option value="2">Security</option>
                                                    <option value="3">System</option>
                                                    <option value="4">Setup</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label for="nameField" class="col-xs-2">Event ID</label>
                                            <div class="col-xs-3">
                                                <input class="form-control" type="text" name="txt_event_id_new" placeholder="Event ID" onkeypress="return isNumberKey(event)" maxlength="6" id="txt_event_id_new" autocomplete="off" />
                                            </div>
                                        </div>
                                    </div>

                                    <div id="disk_cleanup" class="hideable">
                                        <div class="form-group">
                                            <label for="nameField" class="col-xs-2">Schedule Type</label>
                                            <div class="col-xs-3">
                                                <select class="form-control col-sm-2 col-lg-2 col-md-2" name="scheduletype" id="scheduletype">
                                                    <option value="1" selected>Daily</option>
                                                    <option value="2">weekly</option>
                                                    <option value="3">Monthly</option>
                                                </select>
                                            </div>
                                        </div>

                                        <div id="daily" class="daily">
                                            <div class="form-group">
                                                <label for="nameField" class="col-xs-2">Schedule Time </label>
                                                <div class="col-xs-3">
                                                    <input type="text" name="time" class="form-control" placeholder="HH:mm" id="date">
                                                </div>
                                            </div>
                                        </div>
                                        <div id="weekly" style="display:none;">
                                            <div class="form-group">
                                                <label for="nameField" class="col-xs-2">Schedule Time </label>
                                                <div class="col-xs-3">
                                                    <select class="form-control col-sm-2 col-lg-2 col-md-2" name="weeklyday" id="weeklyday">
                                                        <option value="-1">Select Day</option>
                                                        <option value="0">Sunday</option>
                                                        <option value="1">Monday</option>
                                                        <option value="2">Tuesday</option>
                                                        <option value="3">Wednesday</option>
                                                        <option value="4">Thursday</option>
                                                        <option value="5">Friday</option>
                                                        <option value="6">Saturday</option>
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label for="nameField" class="col-xs-2"></label>
                                                <div class="col-xs-3">
                                                    <input type="text" name="time" class="form-control" placeholder="HH:mm" id="date1">
                                                </div>
                                            </div>
                                        </div>
                                        <div id="monthly" style="display:none;">
                                            <div class="form-group">
                                                <label for="nameField" class="col-xs-2">Schedule Time </label>
                                                <div class="col-xs-3">
                                                    <select class="form-control col-sm-2 col-lg-2 col-md-2" name="monthlydate" id="monthlydate">
                                                        <option value="-1">Select Date</option>
                                                        <option value="1">1</option>
                                                        <option value="2">2</option>
                                                        <option value="3">3</option>
                                                        <option value="4">4</option>
                                                        <option value="5">5</option>
                                                        <option value="6">6</option>
                                                        <option value="7">7</option>
                                                        <option value="8">8</option>
                                                        <option value="9">9</option>
                                                        <option value="10">10</option>
                                                        <option value="11">11</option>
                                                        <option value="12">12</option>
                                                        <option value="13">13</option>
                                                        <option value="14">14</option>
                                                        <option value="15">15</option>
                                                        <option value="16">16</option>
                                                        <option value="17">17</option>
                                                        <option value="18">18</option>
                                                        <option value="19">19</option>
                                                        <option value="20">20</option>
                                                        <option value="21">21</option>
                                                        <option value="22">22</option>
                                                        <option value="23">23</option>
                                                        <option value="24">24</option>
                                                        <option value="25">25</option>
                                                        <option value="26">26</option>
                                                        <option value="27">27</option>
                                                        <option value="28">28</option>
                                                        <option value="29">29</option>
                                                        <option value="30">30</option>
                                                        <option value="31">31</option>
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label for="nameField" class="col-xs-2"></label>
                                                <div class="col-xs-3">
                                                    <input type="text" name="time" class="form-control " placeholder="HH:mm" id="time">
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div id="firewall_rules" class="hideable">
                                        <div class="form-group">
                                            <label for="nameField" class="col-xs-2">Select Rule</label>
                                            <div class="col-xs-3">
                                                <select class="form-control col-sm-3 col-lg-3 col-md-3" name="Type" id="select_firewall_rules">
                                                    <option value="1">Firewall Rule</option>
                                                    @*<option value="5">DCM Rules</option>*@
                                                </select>
                                            </div>
                                        </div>
                                        @*<div class="form-group">
                                                <label for="nameField" class="col-xs-2">Source IP  </label>
                                                <div class="col-xs-3">
                                                    <input type="text" name="" class="form-control ip_address" placeholder="Source IP " id="txtfwsourceip" autocomplete="off">
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label for="nameField" class="col-xs-2">Source Port  </label>
                                                <div class="col-xs-3">
                                                    <input type="text" name="" class="form-control" placeholder="Source Port" id="txtfwsourceport" onkeypress="return isNumberKey(event)" autocomplete="off">
                                                </div>
                                            </div>*@
                                        <div class="form-group">
                                            <label for="nameField" class="col-xs-2">Local Port</label>
                                            <div class="col-xs-3">
                                                <input type="text" name="txtfwsourceport" class="form-control" placeholder="Local Port" id="txtfwsourceport" autocomplete="off">
                                                @*<input type="text" name="" class="form-control" placeholder="Local Port" id="txtfwsourceport" onkeypress="return isNumberKey(event)" autocomplete="off">*@
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label for="nameField" class="col-xs-2">Destination IP  </label>
                                            <div class="col-xs-3">
                                                <input type="text" name="txtfwdestinationip" class="form-control ip_address" placeholder="Destination IP" id="txtfwdestinationip" autocomplete="off">
                                            </div>
                                        </div>
                                        @*<div class="form-group">
                                                <label for="nameField" class="col-xs-2">Destination Port  </label>
                                                <div class="col-xs-3">
                                                    <input type="text" name="" class="form-control" placeholder="Destination Port" id="txtfwdestinationport" onkeypress="return isNumberKey(event)" autocomplete="off">
                                                </div>
                                            </div>*@
                                        <div class="form-group">
                                            <label for="nameField" class="col-xs-2">Direction</label>
                                            <div class="col-xs-3">
                                                <select class="form-control col-sm-3 col-lg-3 col-md-3" name="Type" id="firewall_direction">
                                                    <option value="2">Any</option>
                                                    <option value="1">Inbound</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label for="nameField" class="col-xs-2">Perform action</label>
                                            <div class="col-xs-3">
                                                <select class="form-control col-sm-3 col-lg-3 col-md-3" name="Type" id="block_allow_rules">
                                                    <option value="0">Block</option>
                                                    <option value="1">Allow</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label for="nameField" class="col-xs-2">Protocol</label>
                                            <div class="col-xs-3">
                                                <select class="form-control col-sm-3 col-lg-3 col-md-3" name="Type" id="protocol_rules">
                                                    <option value="NA">Any</option>
                                                    <option value="6">TCP</option>
                                                    <option value="17">UDP</option>
                                                    <option value="1">ICMP</option>
                                                    <option value="2">IGMP</option>
                                                    <option value="4">IPV4</option>
                                                    <option value="41">IPV6</option>
                                                    <option value="27">RDP</option>
                                                    <option value="115">I2TP</option>
                                                    <option value="132">SCTPC</option>
                                                    <option value="58">IPV6-ICMP</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label for="nameField" class="col-xs-2">Description</label>
                                        <div class="col-xs-3">
                                            <textarea class="form-control" rows="2" placeholder="Description" id="txtdescription" name="txtdescription" autocomplete="off"></textarea>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label for="nameField" class="col-xs-2"></label>
                                        <div class="pull-left col-xs-1">
                                            @*<input type="button" class="btn btn-primary" value="Save" name="submit2" id="btnsaverules">*@
                                            @*<button type="button" class="btn btn-primary day" id="btnsaverules" onclick="saverules()">Save</button>*@
                                            <button type="submit" class="btn btn-primary day" id="btnsaverules">Save</button>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    @*<button type="button" class="btn btn-primary" data-dismiss="modal" onclick="cleardata()">Close</button>*@
                </div>
            </div><!-- /.modal-content -->
        </div><!-- /.modal-dialog -->
    </div>

    <div class="modal fade" id="nacpolicy_popup" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static" data-keyboard="false">
        <div class="modal-dialog  modal-md ">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true" onclick="cleardata_nac()"> &times;</button>
                    <h6 class=" modal-title">
                        NAC Policy
                    </h6>
                </div>
                <div class="modal-body model_body_scroll">
                    <div class="row">
                        <div class="col-xs-12">
                            <form class="form-horizontal" method="post" name="frm_nacpolicy" id="frm_nacpolicy">
                                <div class="form-group">
                                    <label for="nameField" class="col-xs-2 form_label">Policy Name</label>
                                    <div class="col-xs-5">
                                        <input type="text" name="nacpolicyname" class="form-control" placeholder="Policy Name" id="nacpolicyname" autocomplete="off">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="nameField" class="col-xs-2 form_label">Policy Description</label>
                                    <div class="col-xs-5">
                                        <textarea class="form-control" rows="2" placeholder="Description" id="nacpolicydesc" name="nacpolicydesc" autocomplete="off"></textarea>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="nameField" class="col-xs-2 form_label">IP Address</label>
                                    <div class="col-xs-5">
                                        <input type="text" name="nacip" class="form-control ip_address" placeholder="IP Address" id="nacip" autocomplete="off">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="nameField" class="col-xs-2">Direction</label>
                                    <div class="col-xs-5">
                                        <select class="form-control col-sm-3 col-lg-3 col-md-3" name="nactype" id="nactype">
                                            <option value="2">Any</option>
                                            @*<option value="1">Inbound</option>*@
                                        </select>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="nameField" class="col-xs-2">Perform action</label>
                                    <div class="col-xs-5">
                                        <select class="form-control col-sm-3 col-lg-3 col-md-3" name="nacaction" id="nacaction">
                                            @*<option value="0">Block</option>*@
                                            <option value="1">Allow</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="nameField" class="col-xs-2">Protocol</label>
                                    <div class="col-xs-5">
                                        <select class="form-control col-sm-3 col-lg-3 col-md-3" id="nacprotocol" name="nacprotocol">
                                            <option value="NA">Any</option>
                                            <option value="6">TCP</option>
                                            <option value="17">UDP</option>
                                            <option value="1">ICMP</option>
                                            <option value="2">IGMP</option>
                                            <option value="4">IPV4</option>
                                            <option value="41">IPV6</option>
                                            <option value="27">RDP</option>
                                            <option value="115">I2TP</option>
                                            <option value="132">SCTPC</option>
                                            <option value="58">IPV6-ICMP</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="form-group mt5">
                                    <label for="nameField" class="col-xs-2"></label>
                                    <div class="col-xs-5">
                                        <input type="button" class="btn btn-primary" onclick="add_nac()" value="Add New" name="" />
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-12 col-md-12 col-lg-12">
                            <div>
                                <div id="bindnachtml_div">
                                    <table id="bindnachtml" class="table table-bordered display nowrap" width="100%"></table>
                                </div>
                            </div>
                            <div class="space_bottom">&nbsp;</div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="pull-left col-xs-1">
                            <input type="button" class="btn btn-primary" value="Save" name="SaveNAC" id="btnsavenac">
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    @*<button type="button" class="btn btn-primary" data-dismiss="modal" onclick="cleardata()">Close</button>*@
                </div>
            </div><!-- /.modal-content -->
        </div><!-- /.modal-dialog -->
    </div>
    <div class="modal fade" id="system_unlink" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static" data-keyboard="false">
        <div class="modal-dialog  modal-md" style="margin-top: 82px;">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close reset_btn_id" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h6 class=" modal-title" id="systemlist_policy_name">
                        System List
                    </h6>
                </div>
                <div class="modal-body model_body_scroll">
                    <div class="row">
                        <div class="pull-right col-xs-2">
                            <input type="button" class="btn btn-primary" value="Add System" name="btapply" onclick="applybtnpolicy()" style="margin-left: 20px;" />
                        </div>
                    </div>
                    <div class="row">
                        @*<div class="col-sm-12 col-md-12 col-lg-12" id="div_system_linked_unlink">
                            </div>*@
                        <div class="col-sm-12 col-md-12 col-lg-12" id="div_system_linked_unlink_div">
                            <table id="div_system_linked_unlink" class="table table-striped table-bordered " width="100%"></table>
                        </div>
                    </div>
                </div>
            </div><!-- /.modal-content -->
        </div><!-- /.modal-dialog -->
    </div>

    <!--apply policy-->
    <div class="modal fade" id="apply_new_popup" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static" data-keyboard="false">
        <div class="modal-dialog  modal-md" style="margin-top: 82px;">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close reset_btn_id" aria-hidden="true" data-dismiss="modal" onclick="cleardata()">&times;</button>
                    <h6 class="modal-title" id="apply_policy_name">
                        Apply Policy
                    </h6>
                </div>
                <div class="modal-body model_body_scroll">
                    <div class="row">
                        <div class="col-sm-12 col-md-12 col-lg-12">
                            <form class="form-horizontal" method="post" name="frm_applypolicy1" id="frm_applypolicy1">
                                <div class="form-group" style="margin-left:0px">
                                    <label for="nameField" class="col-xs-2 form_label">OS Type</label>
                                    <div class="col-xs-2 col-md-2 col-lg-2" style="padding-top:2px;">
                                        <div class="radio">
                                            <label> <input type="radio" name="SerialNumber8" id="os_windows" value="0" checked> Windows </label>
                                        </div>
                                    </div>
                                    <div class="col-xs-1 col-md-1 col-lg-1" style="padding-top:2px;">
                                        <div class="radio">
                                            <label> <input type="radio" name="SerialNumber8" id="os_linux" value="1"> Linux </label>
                                        </div>
                                    </div>
                                    <label for="nameField" class="col-xs-2 form_label" style="margin-left:10px;">IP Address</label>
                                    <div class="col-xs-3 col-md-3 col-lg-3" style="padding-top:2px;">
                                        <input type="text" class="form-control col-sm-3 col-lg-3 col-md-3" placeholder="" name="IP2" id="IP2">
                                    </div>
                                    <input type="button" class="btn btn-primary" value="Show" onclick="Func_ipwise()">
                                </div>
                                @*<div class="form-group">
                                                                <label for="nameField" class="col-sm-2 form_label">Apply Policy On</label>
                                                                <div class="col-xs-8">
                                                                    <select class="form-control col-sm-3 col-lg-3 col-md-3" name="Branch/Unit" id="applyDrpOU">
                                                <option value="01">Branch/ Unit</option>
                                                <option value="02">System</option>
                                                <option value="03">User</option>
                                            </select>
                                        </div>
                                    </div>*@
                            </form>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-sm-12 col-md-12 col-lg-12" id="apply_policy_popup_div">
                            <table id="apply_policy_popup" class="table table-striped table-bordered " width="100%"></table>
                        </div>
                    </div>
                    @*<div class="row">
                            <div class="col-xs-5" style="margin-top:-20px;">
                                <button type='button' class="btn btn-primary" onclick="btnpolicyappliedonclick()">Apply</button>
                                <button type="button" class="btn btn-primary" data-dismiss="modal" name="close" onclick="cleardata();">Cancel</button>
                            </div>
                        </div>*@
                    @*<div class="modal-footer" style="margin-top:-10px;">
                            <button type="button" class="btn btn-primary" data-dismiss="modal" onclick="cleardata();" style="margin-right:-20px;">Close</button>
                        </div>*@
                </div><!-- /.modal-content -->
            </div><!-- /.modal-dialog -->
        </div>
    </div>
    <!--apply policy -->
    <!--delete_policy  model  content-->
    <div class="modal fade" id="delete_policy" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static" data-keyboard="false">
        <div class="modal-dialog  modal-small">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h6 class=" modal-title">
                        Conformation
                    </h6>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-xs-10">
                            <form class="form-horizontal" method="post">
                                <div class="form-group">
                                    <label for="nameField" class="col-xs-12">
                                        <i class="glyphicon glyphicon-exclamation-sign delete_msg"></i>
                                        <span style="font-weight:normal;margin-left:30px;">Are you sure you want to delete this record?</span>
                                    </label>
                                </div>
                                <div class="form-group">
                                    <label for="nameField" class="col-xs-4"></label>
                                    <div class="col-xs-6">
                                        <input type="button" class="btn btn-primary" name="yes" value="Yes" onclick="removepolicy1()" />
                                        <input type="button" class="btn btn-default" name="no" value="No" data-dismiss="modal" />
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div><!-- /.modal-content -->
        </div><!-- /.modal-dialog -->
    </div>
    <div class="modal fade" id="notdelete_policy" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static" data-keyboard="false">
        <div class="modal-dialog  modal-md" style="width:690px;">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h6 class=" modal-title">
                        Remove Policy
                    </h6>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-xs-10">
                            <form class="form-horizontal" method="post">
                                <div class="form-group">
                                    <label for="nameField" class="col-xs-12" style="margin-left:50px;">
                                        <i class="glyphicon glyphicon-exclamation-sign delete_msg"></i>
                                        <span style="font-weight:normal;margin-left:30px;">This policy already applied on device(s). So, please unapply from device(s) then delete policy.</span>
                                    </label>
                                </div>
                                <div class="form-group">
                                    <label for="nameField" class="col-xs-6"></label>
                                    <div class="col-xs-4">
                                        <input type="button" class="btn btn-primary" name="ok" value="OK" data-dismiss="modal" />
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div><!-- /.modal-content -->
        </div><!-- /.modal-dialog -->
    </div>

    <!--End delete_policy   device model  content-->
</body>
<script>

    $(document).ready(function () {
        validateSingleForm("#frm_applypolicy");
        validateSingleForm("#frm_applypolicy1");
        validateSingleForm("#frm_nacpolicy");

    });
</script>
<script type="text/javascript">

    datatable_simple();
    $(document).ready(function () {
        $("#txtfwsourceport").prop('disabled', false);
        $("#txtfwdestinationip").prop('disabled', false);
        $('#scheduletype').on('change', function () {

            if (this.value == '1') {
                $("#daily").show();
            }
            else {
                $("#daily").hide();
            }
            if (this.value == '2') {
                $("#weekly").show();
            }
            else {
                $("#weekly").hide();
            }

            if (this.value == '3') {
                $("#monthly").show();
            }
            else {
                $("#monthly").hide();
            }

        });
    });

</script>
<style type="text/css">
    .hideable {
        display: none
    }

    .hideable1 {
        display: none
    }
</style>
<script>
    $(document).ready(function () {
        $("#rules_form").click(function () {
            $("#rules_form_show").toggle();
        });
    });

</script>
<script>
    $(document).ready(function () {
        $('#dl_hrd_type').on('change', function () {
            if (this.value == '1' || this.value == '2' || this.value == '3' || this.value == '4' || this.value == '5' || this.value == '6' || this.value == '7' || this.value == '8' || this.value == '9' || this.value == '10')
            {
                $("#nonusb").show();
                $("#usb").hide();
            }
            else {
                $("#usb").show();
                $("#nonusb").hide();
            }
        });
    });

    function RefereshHardwareType() {
        $('#dl_hrd_type').on('change', function () {
            if (this.value == '1' || this.value == '2' || this.value == '3' || this.value == '4' || this.value == '5' || this.value == '6' || this.value == '7' || this.value == '8' || this.value == '9' || this.value == '10') {
                $("#nonusb").show();
                $("#usb").hide();
            }
            else {
                $("#usb").show();
                $("#nonusb").hide();
            }
        }).change();
    }

    $(function () {
        $("#select_policy").on("change", function () {
            var selected_policy = $(this).children("option").filter(":selected").text();
            $(".hideable").hide();
            if (selected_policy == "Hardware") {
                $("#hardware").show();
            }
            else if (selected_policy == "Rules") {
                $("#rules").show();
            }
            else if (selected_policy == "Share") {
                $("#share").show();
            }
            else if (selected_policy == "User Policy") {
                $("#user_policy").show();



			@*url='@Url.Content("~/csat_policy_mgmt/binduser/")';
	           $.ajax({
	          type: "POST",
	          url: url,
	        success: function (dt)
	         {

			//debugger;
			   jQuery('#drpuser').html('');
				  var setuserdata= $('#drpuser');
			        var optiondata="<option value='-1'>Select User</option>";
					 for(var i=0; i< dt.length;i++)
					 {
					    optiondata+="<option value='"+dt[i].user_name+"'>"+dt[i].user_name+"</option>";
					 }
	                setuserdata.append(optiondata);


	         }
	          });*@

            }
            else if (selected_policy == "Remote Desktop Policy") {
                $("#remote_desktop_policy").show();
            }
			else if (selected_policy == "Password Complexity") {
                $("#password_complexity").show();
            }
            else if (selected_policy == "IP Change Restriction") {
                $("#ip_change_restriction").show();
            }
            else if (selected_policy == "Login Restriction Policy") {
                $("#login_restriction_policy").show();
                var ostype = 0;
                url = '@Url.Content("~/csat_policy_mgmt/binduser?ostype=")' + ostype;
	            $.ajax({
	                type: "POST",
	                url: url,
	                success: function (dt) {
                        //debugger;
			            jQuery('#drploginuser').html('');
				        var setloginuserdata= $('#drploginuser');
			            var optiondata1="<option value=''>Select User</option>";
					    for(var i=0; i< dt.length;i++)
					    {
					        optiondata1+="<option value='"+dt[i].username+"'>"+dt[i].username+"</option>";
					    }
                        setloginuserdata.append(optiondata1);
                    }
	            });
            }
            else if (selected_policy == "Shutdown Policy") {
                $("#shutdown_policy").show();
            }
            else if (selected_policy == "Power Saver Policy") {
                $("#power_saver_policy").show();
            }
            else if (selected_policy == "IP + Port Blocking") {
                $("#ipport_blocking_policy").show();
            }
            else if (selected_policy == "Event Monitoring") {
                $("#event_monitoring").show();
            }
            else if (selected_policy == "Disk Cleanup") {
                $("#disk_cleanup").show();
            }
            else if (selected_policy == "Firewall") {
                $("#firewall_rules").show();
            }
        }).change();
    });
	function Refereshpolicy()
	{
            $("#select_policy").on("change", function () {
            var selected_policy = $(this).children("option").filter(":selected").text();
            $(".hideable").hide();
            if (selected_policy == "Hardware") {
                $("#hardware").show();
            }
            else if (selected_policy == "Rules") {
                $("#rules").show();
            }
            else if (selected_policy == "Share") {
                $("#share").show();
            }
            else if (selected_policy == "User Policy") {
                $("#user_policy").show();
            }
            else if (selected_policy == "Remote Desktop Policy") {
                $("#remote_desktop_policy").show();
            }
			else if (selected_policy == "Password Complexity") {
                $("#password_complexity").show();
            }
            else if (selected_policy == "IP Change Restriction") {
                $("#ip_change_restriction").show();
            }
            else if (selected_policy == "Login Restriction Policy") {
                $("#login_restriction_policy").show();
                var ostype = 0;
                url = '@Url.Content("~/csat_policy_mgmt/binduser?ostype=")' + ostype;
	            $.ajax({
	                type: "POST",
	                url: url,
	                success: function (dt) {
                        //debugger;
			            jQuery('#drploginuser').html('');
				        var setloginuserdata= $('#drploginuser');
			            var optiondata1="<option value=''>Select User</option>";
					    for(var i=0; i< dt.length;i++)
					    {
					        optiondata1+="<option value='"+dt[i].username+"'>"+dt[i].username+"</option>";
					    }
                        setloginuserdata.append(optiondata1);
                    }
	            });
            }
            else if (selected_policy == "Shutdown Policy") {
                $("#shutdown_policy").show();
            }
            else if (selected_policy == "Power Saver Policy") {
                $("#power_saver_policy").show();
            }
            else if (selected_policy == "IP + Port Blocking") {
                $("#ipport_blocking_policy").show();
            }
            else if (selected_policy == "Event Monitoring") {
                $("#event_monitoring").show();
            }
            else if (selected_policy == "Disk Cleanup") {
                $("#disk_cleanup").show();
            }
            else if (selected_policy == "Firewall") {
                $("#firewall_rules").show();
            }
        }).change();
	}
    $(function () {
        $("#select_rules_subtype").on("change", function () {
            var selected_policy2 = $(this).children("option").filter(":selected").text();
            $(".hideable1").hide();
			if (selected_policy2 == "CPU Usage Monitoring") {
                $("#cpu_usage_monitoring").show();
            }
            if (selected_policy2 == "Memory Usage Monitoring") {
                $("#memory_usage_monitoring").show();
            }
            if (selected_policy2 == "Disk Usage Monitoring") {
                $("#disk_usage_monitoring").show();
            }

            if (selected_policy2 == "Application Kill") {
                $("#application_kill").show();
				jQuery('#processcrc').html('');
				 var Setcrc = $('#processcrc');

			 var tablehead="<table class='table table-striped table-bordered crc_datatable' style='width:100%;'><thead><tr>"+
			               "<th class='select' data-orderable='false'><input type='checkbox' class='parent' data-group='.group4' /></th><th>List of Process CRC</th></tr></thead><tbody>";
			  Setcrc.append(tablehead);
				 //debugger;
					  url='@Url.Content("~/csat_policy_mgmt/bindprocess/")';
	           $.ajax({
	          type: "POST",
	          url: url,
	        success: function (dt)
	         {

			//debugger;
			   jQuery('#drp_process').html('');
				  var setprocessdata= $('#drp_process');
			        var optiondata="<option value=''>Select Process</option>";
					 for(var i=0; i< dt.length;i++)
					 {
					    optiondata+="<option value='"+dt[i].process_name+"'>"+dt[i].process_name+"</option>";
					 }
	                setprocessdata.append(optiondata);
	         }
	          });
            }
            if (selected_policy2 == "Application Monitoring") {
                $("#application_monitoring").show();

            }

        }).change();
    });
</script>
<script type="text/javascript">
    $('#action_text').hide();
    $('#action_check').on('click', function () {
        if ($(this).is(':checked')) {
            $('#action_select').hide();
            $('#action_text').show();

        }
        else {
            $('#action_select').show();
            $('#action_text').hide();
        }
    });
</script>
<script>
var varprocess="";
   $("#drp_process").change(function () {
	 //debugger;
	 varprocess= this.value ;
        var url = '@Url.Content("~/csat_policy_mgmt/bindprocess_crc?process=")'+ this.value ;
     $.ajax({
         type: "POST",
         url: url,
         success: function (dt) {
		 //debugger;
		       jQuery('#processcrc').html('');
             var Setcrc = $('#processcrc');
			 var trdata="";
             var tablehead ="<table class='table table-striped table-bordered tbldemo' style='width:100%;'><thead><tr>"+
			               "<th class='select' data-orderable='false'><input type='checkbox' class='parent' data-group='.group4' /></th><th>List of Process CRC</th></tr></thead><tbody>";
			 for(var i=0;i< dt.length;i++)
			 {
			 trdata+="<tr><td class='select'><input type='checkbox' class='group4' name='check[]' value='"+dt[i].crc+"' id='gridrawcheck4' onchange='UncheckMain4()'  /></td><td>"+dt[i].crc+"</td></tr>";

			 }
			 tablehead= tablehead+trdata;
			 Setcrc.append(tablehead);

             datatable_simple();

			 $(".parent").each(function (index) {
	 // debugger;
        var group = $(this).data("group");
        var parent = $(this);

        parent.change(function () {  //"select all" change
		// debugger;
            $(group).prop('checked', parent.prop("checked"));
			UncheckMain4();
        });
        $(group).change(function () {
		 //debugger;
            parent.prop('checked', false);
            if ($(group + ':checked').length == $(group).length) {
                parent.prop('checked', true);
            }
        });
    });

		 }
		 });
		 });

		  var crc="";
	 function UncheckMain4() {
    //  debugger;
	   crc="";
	   var checkboxes = document.querySelectorAll('input[id="gridrawcheck4"]');
	   for (var i = 0; i < checkboxes.length; i++) {
		if (checkboxes[i].checked == true) {
          crc += "," + checkboxes[i].value;
        }
		else
		{

		}

		}
		//alert(crc);
    }

    var Actionvalue = "";
    var Actionvalue1 = "";
    var Actionvalue2 = "";
    var Actionvalue3 = "";
    var Actionvalue4 = "";
    var Actionvalue5 = "";
    var Actionvalue6 = "";
    var Actionvalue7 = "";
    var Actionvalue8 = "";
    $('input[name=SerialNumber]').change(function () {
        Actionvalue = this.value;
    });
    $('input[name=SerialNumber1]').change(function () {
        Actionvalue1 = this.value;
    });
    $('input[name=SerialNumber2]').change(function () {
        Actionvalue2 = this.value;
    });
    $('input[name=SerialNumber3]').change(function () {
        Actionvalue3 = this.value;
    });
    $('input[name=SerialNumber4]').change(function () {
        Actionvalue4 = this.value;
    });
    $('input[name=SerialNumber5]').change(function () {
        Actionvalue5 = this.value;
    });
    $('input[name=SerialNumber6]').change(function () {
        Actionvalue6 = this.value;
    });
    $('input[name=SerialNumber7]').change(function () {
        Actionvalue7 = this.value;
        url = '@Url.Content("~/csat_policy_mgmt/binduser?ostype=")' + Actionvalue7;
	            $.ajax({
	                type: "POST",
	                url: url,
	                success: function (dt) {
                        //debugger;
			            jQuery('#drploginuser').html('');
				        var setloginuserdata= $('#drploginuser');
			            var optiondata1="<option value=''>Select User</option>";
					    for(var i=0; i< dt.length;i++)
					    {
					        optiondata1+="<option value='"+dt[i].username+"'>"+dt[i].username+"</option>";
					    }
                        setloginuserdata.append(optiondata1);
                    }
	            });
    });
    var apptable;
    $('input[name=SerialNumber8]').change(function () {
        Actionvalue8 = this.value;
        var policy_id = apply_policyid;
        var url1 = '@Url.Content("~/csat_policy_mgmt/Get_Policy?policyid=")' + policy_id + '&ostype=' + Actionvalue8;
        $.ajax({
            type: "POST",
            url: url1,
            success: function (data) {
                document.getElementById('apply_policy_name').innerText = 'Apply Policy [ Policy Name : ' + data.policy_name + ' ]';
                var agent_divclear = document.getElementById('apply_policy_popup_div');
                agent_divclear.innerHTML = '&nbsp;';
                $('#apply_policy_popup_div').append("<table id='apply_policy_popup' class='table table-striped table-bordered' width='100%'></table></div><div class='form-group'><div class='col-xs-5' style='margin-left:-10px;'>&nbsp;<input type='button' class='btn btn-primary' name='Add' value='Apply' id='addpolicydevice' onclick='btnpolicyappliedonclick()' />&nbsp;<input type='button' class='btn btn-primary' data-dismiss='modal' name='close' value='Cancel' /></div></div>");
                apptable = document.getElementById('apply_policy_popup');
                var data1 = [];
                for (var i = 0; i < data.getapppolicydata.length; i++) {
                    data1.push([data.getapppolicydata[i].device_id, data.getapppolicydata[i].ou_longname, data.getapppolicydata[i].device_name, data.getapppolicydata[i].ip, data.getapppolicydata[i].ostype]);
                }
                apptable = $("#apply_policy_popup").DataTable({
                    data: data1, scrollX: !0, searching: !1,
                    'columnDefs': [{ 'targets': 0, 'checkboxes': { 'selectRow': true } }, { orderable: false, targets: 1 }], 'select': { 'style': 'multi' },
                    columns: [{ title: "", width: '10px' }, { title: "Branch/ Unit", width: '170px' }, { title: "System Name", width: '90px' }, { title: "IP Address", width: '80px' }, { title: "OS Type", width: '20px' }]
                });
                $(".table").css({ "width": "100%" });
                $(".dataTables_scrollHeadInner ").css({ "width": "100%" });
            }
        });
    });
</script>
<script>
var thtype="";
    //$('#btnsaverules').on("click", function () {
    function saverules() {
        //debugger;
        //if ($("#txtrulesname").val() == "") {
        //    alert("Please enter rules name !");
        //    return false;
        //}

        var rulestype = document.getElementById("select_policy").value;
        var rulesname = document.getElementById("txtrulesname").value;
        var status = "";
        Actionvalue = $('input[name=SerialNumber]:checked').val();
        Actionvalue1 = $('input[name=SerialNumber1]:checked').val();
        Actionvalue2 = $('input[name=SerialNumber2]:checked').val();
        Actionvalue3 = $('input[name=SerialNumber3]:checked').val();
        Actionvalue4 = $('input[name=SerialNumber4]:checked').val();
        Actionvalue5 = $('input[name=SerialNumber5]:checked').val();
        Actionvalue6 = $('input[name=SerialNumber6]:checked').val();
        Actionvalue7 = $('input[name=SerialNumber7]:checked').val();
        //Actionvalue = $('input[type=radio]:checked').val();

        var rulesdesc = document.getElementById("txtdescription").value;
        var Htype = "";
        var url = "";
        var subtype = "";
        var Etype = "";
        //debugger;
        if (rulestype == "1") {
            Htype = document.getElementById("dl_hrd_type").value;
            if (Htype == "11") {
                status = Actionvalue1;
                url = '@Url.Content("~/csat_policy_mgmt/Create_Rules?rulestype=")' + rulestype + '&rulesname=' + rulesname + '&hwtype=' + Htype + '&status=' + status + '&desc=' + rulesdesc;
            }
            else {
                status = Actionvalue;
                url = '@Url.Content("~/csat_policy_mgmt/Create_Rules?rulestype=")' + rulestype + '&rulesname=' + rulesname + '&hwtype=' + Htype + '&status=' + status + '&desc=' + rulesdesc;
            }
        }
        if (rulestype == "2") {
            subtype = document.getElementById("select_rules_subtype").value;
            if (subtype == "1") {
                //if ($("#txtcpuusage").val() == "") {
                //    alert("Please enter cpu usage !");
                //    return false;
                //}
                status = document.getElementById("txtcpuusage").value;
                url = '@Url.Content("~/csat_policy_mgmt/Create_Rules?rulestype=")' + rulestype + '&rulesname=' + rulesname + '&hwtype=' + subtype + '&status=' + status + '&desc=' + rulesdesc;
            }
            else if (subtype == "2") {
                //if ($("#txtmemoryusage").val() == "") {
                //    alert("Please enter memory usage !");
                //    return false;
                //}
                status = document.getElementById("txtmemoryusage").value;
                url = '@Url.Content("~/csat_policy_mgmt/Create_Rules?rulestype=")' + rulestype + '&rulesname=' + rulesname + '&hwtype=' + subtype + '&status=' + status + '&desc=' + rulesdesc;
            }
            else if (subtype == "3") {
                //if ($("#txtdiskusage").val() == "") {
                //    alert("Please enter disk usage !");
                //    return false;
                //}
                status = document.getElementById("txtdiskusage").value;
                url = '@Url.Content("~/csat_policy_mgmt/Create_Rules?rulestype=")' + rulestype + '&rulesname=' + rulesname + '&hwtype=' + subtype + '&status=' + status + '&desc=' + rulesdesc;
            }
            else if (subtype == "4") {
                //if ($("#txtcputhresold").val() == "") {
                //    alert("Please enter cpu usage !");
                //    return false;
                //}
                //if ($("#txtmemorythresold").val() == "") {
                //    alert("Please enter memory usage !");
                //    return false;
                //}
                thtype = document.getElementById("txtmemorythresold").value;
                //varcrc=crc;
                // varprocess
                // thtype
                status = document.getElementById("txtcputhresold").value;
                url = '@Url.Content("~/csat_policy_mgmt/Create_Rules?rulestype=")' + rulestype + '&rulesname=' + rulesname + '&hwtype=' + subtype + '&status=' + varprocess + '&desc=' + rulesdesc + '&crc=' + crc + '&thersold=' + thtype + '&thersoldper=' + status;
            }
            else if (subtype == "5") {
                if (varprocess == "") {
                    varprocess = document.getElementById("process_name").value;
                }
                //if (varprocess == "") {
                //    if ($("#process_name").val() == "" || $("#drp_process").val() == "-1") {
                //        alert("Please enter proocess !");
                //        return false;
                //    }
                //}

                //else {
                //    if ($(".process_alert").val() == "-1") {
                //        alert("Please select proocess !");
                //        return false;
                //    }
                //}

                //thtype= document.getElementById("drp_Threshold").value;
                //varcrc=crc;
                // varprocess
                // thtype
                // status=document.getElementById("txtthresold").value;
                url = '@Url.Content("~/csat_policy_mgmt/Create_Rules?rulestype=")' + rulestype + '&rulesname=' + rulesname + '&hwtype=' + subtype + '&status=' + varprocess + '&desc=' + rulesdesc + '&crc=' + crc + '&thersold=' + thtype + '&thersoldper=' + status;
            }

            //url='@Url.Content("~/csat_policy_mgmt/Create_Rules?rulestype=")'+rulestype+'&rulesname='+rulesname+'&hwtype='+subtype+'&status='+status+'&desc='+rulesdesc;
        }
        else if (rulestype == "3") {
            //if ($("#share_delete_days").val() == "na") {
            //    alert("please select share delete day !");
            //    return false;
            //}
            subtype = document.getElementById("share_delete_days").value;
            // status= document.getElementById("share_days").value;
            url = '@Url.Content("~/csat_policy_mgmt/Create_Rules?rulestype=")' + rulestype + '&rulesname=' + rulesname + '&hwtype=' + subtype + '&status=' + status + '&desc=' + rulesdesc;
        }
        else if (rulestype == "6") {
            status = Actionvalue2;
            url = '@Url.Content("~/csat_policy_mgmt/Create_Rules?rulestype=")' + rulestype + '&rulesname=' + rulesname + '&status=' + status + '&desc=' + rulesdesc;
        }
        else if (rulestype == "7"){
            status = Actionvalue4;
            url = '@Url.Content("~/csat_policy_mgmt/Create_Rules?rulestype=")' + rulestype + '&rulesname=' + rulesname + '&status=' + status + '&desc=' + rulesdesc;
        }
        else if (rulestype == "42") {
            status = Actionvalue3;
            url = '@Url.Content("~/csat_policy_mgmt/Create_Rules?rulestype=")' + rulestype + '&rulesname=' + rulesname + '&status=' + status + '&desc=' + rulesdesc;
        }
        else if (rulestype == "10") {
            var powermode = document.getElementById("powersavermode").value;
            var powerminutes = document.getElementById("powersaverMinutes").value;
            url = '@Url.Content("~/csat_policy_mgmt/Create_Rules?rulestype=")' + rulestype + '&rulesname=' + rulesname + '&hwtype=' + powermode + '&status=' + powerminutes + '&desc=' + rulesdesc;
        }
        else if (rulestype == "8") {
            var downclock = document.getElementById("shutdowbnclock").value;
            status = Actionvalue5;
            url = '@Url.Content("~/csat_policy_mgmt/Create_Rules?rulestype=")' + rulestype + '&rulesname=' + rulesname + '&hwtype=' + status + '&status=' + downclock + '&desc=' + rulesdesc;
        }
        else if (rulestype == "4") // User Password Change
        {
            saverules();
            //if ($("#userrulesdayalert").val() == "NA") {
            //    alert("Please select password changed day !");
            //    return false;
            //}
            // var subtype = document.getElementById("userpolicyaction").value;
            var subtype = document.getElementById("userrulealert").value;
            var status = document.getElementById("userrulesdayalert").value;
            //var user = document.getElementById("userrulesdaydisable").value;
            //var userlogin1 = document.getElementById("drpuser").value;
            url = '@Url.Content("~/csat_policy_mgmt/Create_Rules?rulestype=")' + rulestype + '&rulesname=' + rulesname + '&hwtype=' + subtype + '&status=' + status + '&desc=' + rulesdesc;
        }
        else if (rulestype == "9") {
            if ($("#txtsourceip").val() == "") {
                alert("Please enter source ip !");
                return false;
            }
            if ($("#txtsourceport").val() == "") {
                alert("Please enter source port !");
                return false;
            }
            if ($("#txtdestip").val() == "") {
                alert("Please enter destination ip !");
                return false;
            }
            if ($("#txtdestport").val() == "") {
                alert("Please enter destination port !");
                return false;
            }
            var protocol = document.getElementById("protocol").value;
            status = Actionvalue6;
            var sourceip = document.getElementById("txtsourceip").value;
            var sourceport = document.getElementById("txtsourceport").value;
            var destip = document.getElementById("txtdestip").value;
            var destport = document.getElementById("txtdestport").value;
            url = '@Url.Content("~/csat_policy_mgmt/Create_Rules?rulestype=")' + rulestype + '&rulesname=' + rulesname + '&hwtype=' + protocol + '&status=' + status + '&desc=' + rulesdesc + '&crc=' + sourceip + '&thersold=' + sourceport + '&thersoldper=' + destip + '&destport=' + destport;
        }


        else if (rulestype == "11") // Login restriction
        {
            var ostype = Actionvalue7;
            //if ($("#drploginuser").val() == "") {
            //    alert("Please select user !");
            //    return false;
            //}
            var strDay = '';
            //  debugger;
            if (document.getElementById("Sunday").checked == true) {
                if (strDay.trim().Length > 0)
                    strDay = strDay + ";Su";
                else
                    strDay = strDay + "Su,";
            }
            if (document.getElementById("Monday").checked == true) {
                if (strDay.trim().Length > 0)
                    strDay = strDay + ";M";
                else
                    strDay = strDay + "M,";

            }
            if (document.getElementById("Tuesday").checked == true) {
                if (strDay.trim().Length > 0)
                    strDay = strDay + ";T";
                else
                    strDay = strDay + "T,";
            }
            if (document.getElementById("Wednesday").checked == true) {
                if (strDay.trim().Length > 0)
                    strDay = strDay + ";W";
                else
                    strDay = strDay + "W,";
            }
            if (document.getElementById("Thursday").checked == true) {
                if (strDay.trim().Length > 0)
                    strDay = strDay + ";Th";
                else
                    strDay = strDay + "Th,";
            }
            if (document.getElementById("Friday").checked == true) {
                if (strDay.trim().Length > 0)
                    strDay = strDay + ";F";
                else
                    strDay = strDay + "F,";
            }
            if (document.getElementById("Saturday").checked == true) {
                if (strDay.trim().Length > 0)
                    strDay = strDay + ";Sa";
                else
                    strDay = strDay + "Sa,";
            }
            if (strDay == "") {
                alert("Please select week !");
                return false;
            }
            var strhour = document.getElementById("starthour").value;
            var endhour = document.getElementById("endhour").value;
            var userlogin = document.getElementById("drploginuser").value;
            url = '@Url.Content("~/csat_policy_mgmt/Create_Rules?rulestype=")' + rulestype + '&rulesname=' + rulesname + '&hwtype=' + strDay + '&status=' + strhour + '&destport=' + endhour + '&desc=' + rulesdesc + '&crc=' + userlogin + '&ostype=' + ostype;
        }
        if (rulestype == "12") {
            //if ($("#txt_event_id_new").val() == "") {
            //    alert("Please enter event id !");
            //    return false;
            //}
            Etype = document.getElementById("drp_event_type_new").value;
            Eid = document.getElementById("txt_event_id_new").value;
            url = '@Url.Content("~/csat_policy_mgmt/Create_Rules?rulestype=")' + rulestype + '&rulesname=' + rulesname + '&eventtype=' + Etype + '&eventid=' + Eid + '&desc=' + rulesdesc;
        }
        if (rulestype == "13") {
            var backuptype1 = document.getElementById("scheduletype").value;
            var backuptime = '';
            var bacupdetails = '';
            if (backuptype1 == '1') {
                backuptime = document.getElementById("date").value;
                bacupdetails = '-1';
            }
            if (backuptype1 == '2') {
                if ($("#weeklyday").val() == "-1") {
                    alert("Please select week day  !");
                    return false;
                }
                backuptime = document.getElementById("date1").value;
                bacupdetails = document.getElementById("weeklyday").value;
            }
            if (backuptype1 == '3') {
                if ($("#monthlydate").val() == "-1") {
                    alert("Please select date !");
                    return false;
                }
                backuptime = document.getElementById("time").value;
                bacupdetails = document.getElementById("monthlydate").value;
            }
            url = '@Url.Content("~/csat_policy_mgmt/Create_Rules?rulestype=")' + rulestype + '&rulesname=' + rulesname + '&backuptype=' + backuptype1 + '&backupdetails=' + bacupdetails + '&backuptime=' + backuptime + '&desc=' + rulesdesc;
        }
        if (rulestype == "15") {
           // debugger;
            firewall_rules = document.getElementById("select_firewall_rules").value;
            //if ($("#txtfwdestinationip").val() == "") {
            //    alert("Please enter destination ip !");
            //    return false;
            //}
            //fw_sourceip = document.getElementById("txtfwsourceip").value;
            fw_sourceip = "";
            fw_sourceport = document.getElementById("txtfwsourceport").value;
            fw_destinationip = document.getElementById("txtfwdestinationip").value;
            fw_destinationport = "";
            //fw_destinationport = document.getElementById("txtfwdestinationport").value;
            fw_direction = document.getElementById("firewall_direction").value;
            fw_perform_action = document.getElementById("block_allow_rules").value;
            fw_protocol_rules = document.getElementById("protocol_rules").value;
            url = '@Url.Content("~/csat_policy_mgmt/Create_Rules?rulestype=")' + rulestype + '&rulesname=' + rulesname + '&firewall_rules=' + firewall_rules + '&fw_sourceip=' + fw_sourceip + '&fw_sourceport=' + fw_sourceport + '&fw_destinationip=' + fw_destinationip + '&fw_destinationport=' + fw_destinationport + '&fw_direction=' + fw_direction + '&fw_perform_action=' + fw_perform_action + '&fw_protocol_rules=' + fw_protocol_rules + '&desc=' + rulesdesc;
            //url = '@Url.Content("~/csat_policy_mgmt/Create_Rules?rulestype=")' + rulestype + '&rulesname=' + rulesname + '&firewall_rules=' + firewall_rules + '&fw_destinationip=' + fw_destinationip + '&fw_destinationport=' + fw_destinationport + '&fw_direction=' + fw_direction + '&fw_perform_action=' + fw_perform_action + '&fw_protocol_rules=' + fw_protocol_rules + '&desc=' + rulesdesc;
        }
        $.ajax({
            type: "POST",
            url: url,
            success: function (result) {
                // debugger;
                alert(result);
                document.getElementById("txtrulesname").value = '';
                document.getElementById("txtdescription").value = '';
                document.getElementById("dl_hrd_type").value = 1;
                document.getElementById("select_policy").value = "1";
                document.getElementById("txtcpuusage").value = '';
                document.getElementById("txtmemoryusage").value = '';
                document.getElementById("txtdiskusage").value = '';
                //document.getElementById("allday").checked = false;
                document.getElementById("Sunday").checked = false;
                document.getElementById("Monday").checked = false;
                document.getElementById("Tuesday").checked = false;
                document.getElementById("Wednesday").checked = false;
                document.getElementById("Thursday").checked = false;
                document.getElementById("Friday").checked = false;
                document.getElementById("Saturday").checked = false;
                document.getElementById("starthour").value = '09';
                document.getElementById("endhour").value = '18';
                //    document.getElementById("userrulesdaydelete").value = '';
                document.getElementById("userrulealert").value = 1;
                document.getElementById("userrulesdayalert").value = '';
                document.getElementById("txtmemorythresold").value = '';
                document.getElementById("txtcputhresold").value = '';
                document.getElementById("drp_event_type_new").value = '1';
                document.getElementById("txt_event_id_new").value = '';
                document.getElementById('scheduletype').value = "1";
                document.getElementById("select_firewall_rules").value = '1';
                //document.getElementById("txtfwsourceip").value = '';
                document.getElementById("txtfwdestinationip").value = '';
                document.getElementById("txtfwsourceport").value = '';
                //document.getElementById("txtfwdestinationport").value = '';
                document.getElementById("firewall_direction").value = '2';
                document.getElementById("block_allow_rules").value = '0';
                document.getElementById("protocol_rules").value = '';
                $("#daily").show();
                $("#weekly").hide();
                $("#monthly").hide();
                Refereshpolicy();
                RefereshHardwareType();
                policy_datatable();
                @*window.location.href = '@Url.Content("~/csat_policy_mgmt/csat_policy_create")';*@
            }
        });
    }

</script>
<script>
    var policyidall = "";
    var ptable;
 function displaypolicydetailsdata()
 {
     $("#overlay").show();
     $("#overlay").fadeIn(300);
     var url= '@Url.Content("~/csat_policy_mgmt/Get_Policy_Details_data")';
	   $.ajax({
	     type: "Post",
		 url: url,
		 success: function(data)
         {
            //debugger;
             var agent_divclear = document.getElementById('divpolicydetails_div');
             agent_divclear.innerHTML = '&nbsp;';
             $('#divpolicydetails_div').append("<table id='divpolicydetails' class='table table-striped table-bordered' width='100%'></table>");
             ptable = document.getElementById('divpolicydetails');
             var data1 = [];
             for (var i = 0; i < data.policydetailsdata.length; i++) {
                 var manage = "<div class='icon'><i class='glyphicon glyphicon-pencil manage_icon' type='button' data-toggle='modal' style = 'padding-top:2px;'  onclick='openLinkedDevice(" + data.policydetailsdata[i].policy_id + ")' title='Manage' ></i></div>";
                 data1.push([data.policydetailsdata[i].policy_id, data.policydetailsdata[i].policy_name, data.policydetailsdata[i].policy_details, data.policydetailsdata[i].cnt, manage]);
             }
             ptable = $("#divpolicydetails").DataTable({
                 data: data1, scrollX: !0, searching: !1, dom: "<'top'lB>rt<'bottom'ip><'clear'>", buttons: ["colvis"],
                 'columnDefs': [{ 'targets': 0, 'checkboxes': { 'selectRow': true } }, { orderable: false, targets: 1 }], 'select': { 'style': 'multi' },
                 columns: [{ title: "", width: '10px' }, { title: "Policy Name", width: '90px' }, { title: "Description", width: '170px' }, { title: "Applied Count", width: '60px' }, { title: "Manage", width: '50px' }]
             });
             $(".table").css({ "width": "100%" });
             $(".dataTables_scrollHeadInner ").css({ "width": "100%" });
             btnpolicyapplied();
             //$('#btnpolicyapplied').on('click', function (e) {
             //    var form = this;
             //    var rows_selected = otable.column(0).checkboxes.selected();
             //    $.each(rows_selected, function (index) {
             //        policyidall = "";
             //        for (var i = 0; i < rows_selected.length; i++) {
             //            policyidall += "," + rows_selected[i];
             //        }
             //        return false;
             //    });
             //});

		 }

       }).done(function () {
           setTimeout(function () {
               $("#overlay").fadeOut(300);
           }, 500);
       });
    }
    function btnpolicyapplied() {
        var rows_selected = ptable.column(0).checkboxes.selected();
        $.each(rows_selected, function (index) {
            policyidall = "";
            for (var i = 0; i < rows_selected.length; i++) {
                policyidall += "," + rows_selected[i];
            }
            return false;
        });
    }
    var atable;
    var id = "";
    var applyon = document.getElementById("DrpOU").value;
    function displayapplyonload() {
       // debugger;
        var url = '@Url.Content("~/csat_policy_mgmt/GetPolicy?name=")' + applyon;
        $.ajax({
            type: "Post",
            url: url,
            success: function (data) {
               // debugger;
                var agent_divclear = document.getElementById('apppolicy_div');
                agent_divclear.innerHTML = '&nbsp;';
                $('#apppolicy_div').append("<table id='apppolicy' class='table table-striped table-bordered' width='100%'></table>");
                atable = document.getElementById('apppolicy');
                var data1 = [];
                for (var i = 0; i < data.getapppolicydata.length; i++) {
                    data1.push([data.getapppolicydata[i].ou_nodelinkage_ouid, data.getapppolicydata[i].ou, data.getapppolicydata[i].count]);
                }
                atable = $("#apppolicy").DataTable({
                    data: data1, scrollX: !0, searching: !1, dom: "<'top'lB>rt<'bottom'ip><'clear'>", buttons: ["colvis"],
                    'columnDefs': [{ 'targets': 0, 'checkboxes': { 'selectRow': true } }, { orderable: false, targets: 1 }], 'select': { 'style': 'multi' },
                    columns: [{ title: "", width: '10px' }, { title: "Branch/ Unit", width: '170px' }, { title: "Count", width: '50px' }]
                });
                $(".table").css({ "width": "100%" });
                $(".dataTables_scrollHeadInner ").css({ "width": "100%" });
                $("#btnpolicyapplied").show();
            }
        });
    }
    //$('#DrpOU').change(function () {
    //    if ($(this).val() == '02') {
    //        $("#system_show").show();
    //    }
    //    else {
    //        $("#system_show").hide();
    //    }
    //});
    $("#DrpOU").change(function () {
        if ($(this).val() == '02') {
            $("#system_show").show();
        }
        else {
            $("#system_show").hide();
        }
        var url = '@Url.Content("~/csat_policy_mgmt/GetPolicy?name=")' + this.value ;
        $.ajax({
            type: "POST",
            url: url,
            success: function (data) {
            //debugger;
                if (data.gridtype == 'OU') {
                    var agent_divclear = document.getElementById('apppolicy_div');
                    agent_divclear.innerHTML = '&nbsp;';
                    $('#apppolicy_div').append("<table id='apppolicy' class='table table-striped table-bordered' width='100%'></table>");
                    atable = document.getElementById('apppolicy');
                    var data1 = [];
                    for (var i = 0; i < data.getapppolicydata.length; i++) {
                        data1.push([data.getapppolicydata[i].ou_nodelinkage_ouid, data.getapppolicydata[i].ou, data.getapppolicydata[i].count]);
                    }
                    atable = $("#apppolicy").DataTable({
                        data: data1, scrollX: !0, searching: !1, dom: "<'top'lB>rt<'bottom'ip><'clear'>", buttons: ["colvis"],
                        'columnDefs': [{ 'targets': 0, 'checkboxes': { 'selectRow': true } }, { orderable: false, targets: 1 }], 'select': { 'style': 'multi' },
                        columns: [{ title: "", width: '10px' }, { title: "Branch/ Unit", width: '170px' }, { title: "Count", width: '50px' }]
                    });
                    $(".table").css({ "width": "100%" });
                    $(".dataTables_scrollHeadInner ").css({ "width": "100%" });
                    $("#btnpolicyapplied").show();
                     //$('#btnpolicyapplied').on('click', function (e) {
                     //    var form = this;
                     //    id = "";
                     //    var rows_selected = otable.column(0).checkboxes.selected();
                     //    $.each(rows_selected, function (index) {
                     //        for (var i = 0; i < rows_selected.length; i++) {
                     //            id += "," + rows_selected[i];
                     //        }
                     //        get_selected_device(policyidall, id)
                     //        return false;
                     //    });
                     //});
                }
                if (data.gridtype == 'System') {
                    var agent_divclear = document.getElementById('apppolicy_div');
                    agent_divclear.innerHTML = '&nbsp;';
                    $('#apppolicy_div').append("<table id='apppolicy' class='table table-striped table-bordered' width='100%'></table>");
                    atable = document.getElementById('apppolicy');
                    var data1 = [];
                    for (var i = 0; i < data.getapppolicydata.length; i++) {
                        data1.push([data.getapppolicydata[i].device_id, data.getapppolicydata[i].ou_longname, data.getapppolicydata[i].device_name, data.getapppolicydata[i].ip]);
                    }
                    atable = $("#apppolicy").DataTable({
                        data: data1, scrollX: !0, searching: !1, dom: "<'top'lB>rt<'bottom'ip><'clear'>", buttons: ["colvis"],
                        'columnDefs': [{ 'targets': 0, 'checkboxes': { 'selectRow': true } }, { orderable: false, targets: 1 }], 'select': { 'style': 'multi' },
                        columns: [{ title: "", width: '10px' }, { title: "Branch/ Unit", width: '170px' }, { title: "System Name", width: '50px' }, { title: "IP Address", width: '50px' }]
                    });
                    $(".table").css({ "width": "100%" });
                    $(".dataTables_scrollHeadInner ").css({ "width": "100%" });

                    $("#btnpolicyapplied").show();
                }
                if (data.gridtype == 'User') {
                    var agent_divclear = document.getElementById('apppolicy_div');
                    agent_divclear.innerHTML = '&nbsp;';
                    $('#apppolicy_div').append("<table id='apppolicy' class='table table-striped table-bordered' width='100%'></table>");
                    atable = document.getElementById('apppolicy');
                    var data1 = [];
                    for (var i = 0; i < data.getapppolicydata.length; i++) {
                        data1.push([data.getapppolicydata[i].user, data.getapppolicydata[i].user]);
                    }
                    atable = $("#apppolicy").DataTable({
                        data: data1, scrollX: !0, searching: !1, dom: "<'top'lB>rt<'bottom'ip><'clear'>", buttons: ["colvis"],
                        'columnDefs': [{ 'targets': 0, 'checkboxes': { 'selectRow': true } }, { orderable: false, targets: 1 }], 'select': { 'style': 'multi' },
                        columns: [{ title: "", width: '10px' }, { title: "User Name", width: '170px' }]
                    });
                    $(".table").css({ "width": "100%" });
                    $(".dataTables_scrollHeadInner ").css({ "width": "100%" });
                    $("#btnpolicyapplied").show();
                }
            }
        });
    });
    function Func_syswise() {
        var $valid = $('#frm_applypolicy').valid();
        if (!$valid) {
            $validatorform.focusInvalid();
            return false;
        } else {
            var applyon = document.getElementById("DrpOU").value;
            var ip_value = document.getElementById("IP1").value;
            var sysname = document.getElementById("SN1").value;
            var url = '@Url.Content("~/csat_policy_mgmt/GetPolicy_ipvalue?name=")' + applyon + '&ip=' + ip_value + '&devicename=' + sysname;
            $.ajax({
                type: "POST",
                url: url,
                success: function (data) {
                    //debugger;
                    if (data.gridtype == 'System') {
                        var agent_divclear = document.getElementById('apppolicy_div');
                        agent_divclear.innerHTML = '&nbsp;';
                        $('#apppolicy_div').append("<table id='apppolicy' class='table table-striped table-bordered' width='100%'></table>");
                        atable = document.getElementById('apppolicy');
                        var data1 = [];
                        for (var i = 0; i < data.getapppolicydata.length; i++) {
                            data1.push([data.getapppolicydata[i].device_id, data.getapppolicydata[i].ou_longname, data.getapppolicydata[i].device_name, data.getapppolicydata[i].ip]);
                        }
                        atable = $("#apppolicy").DataTable({
                            data: data1, scrollX: !0, searching: !1, dom: "<'top'lB>rt<'bottom'ip><'clear'>", buttons: ["colvis"],
                            'columnDefs': [{ 'targets': 0, 'checkboxes': { 'selectRow': true } }, { orderable: false, targets: 1 }], 'select': { 'style': 'multi' },
                            columns: [{ title: "", width: '10px' }, { title: "Branch/ Unit", width: '170px' }, { title: "System Name", width: '50px' }, { title: "IP Address", width: '50px' }]
                        });
                        $(".table").css({ "width": "100%" });
                        $(".dataTables_scrollHeadInner ").css({ "width": "100%" });
                        $("#btnpolicyapplied").show();
                    }
                }
            });
        }
    }

   $("#Policy_apply_details").change(function(){

	displaypolicydetailsdata();
   });


    var policy_selected = "";
    var device_selected = "";
    function apply_policy() {
        //debugger;
        var applyon = document.getElementById("DrpOU").value;
        id = "";
        policyidall = "";

        var rows_selected = atable.column(0).checkboxes.selected();
        $.each(rows_selected, function (index) {
            for (var i = 0; i < rows_selected.length; i++) {
                id += "," + rows_selected[i];
            }
            return false;
        });
        device_selected = id;

        var rows_selected1 = ptable.column(0).checkboxes.selected();
        $.each(rows_selected1, function (index) {
            for (var i = 0; i < rows_selected1.length; i++) {
                policyidall += "," + rows_selected1[i];
            }
            return false;
        });
        policy_selected = policyidall;

        if (device_selected != "" && policy_selected != "") {
            var url = '@Url.Content("~/csat_policy_mgmt/Get_Policy_Apply?policyid=")' + policy_selected + '&applyid=' + device_selected+'&applytype='+applyon;
	        $.ajax({
	            type: "Post",
		        url: url,
		        success: function(result)
		        {
                    alert(result);
		            window.location.href = '@Url.Content("~/csat_policy_mgmt/csat_policy_create")';
		        }
		    });
        }
        else {
            alert("Select any one !");
            return false;
        }
        displaypolicydetailsdata();
        displayapplyonload();
    }

</script>
<script>
    function displaypolicypopupdata()
    {
        $('#policy_popup').modal('show');
        policy_datatable();
    }
    var rulesid = "";
    function policy_datatable() {
        var url= '@Url.Content("~/csat_policy_mgmt/Get_Policy_data")';
	    $.ajax({
	        type: "Post",
		    url: url,
		    success: function(data)
            {
               // debugger;
                var agent_divclear = document.getElementById('divpolicydata_div');
                agent_divclear.innerHTML = '&nbsp;';
                $('#divpolicydata_div').append("<table id='divpolicydata' class='table table-striped table-bordered' width='100%'></table>");
                otable = document.getElementById('divpolicydata');
                var data1 = [];
                for (var i = 0; i < data.policydata.length; i++) {
                    data1.push([data.policydata[i].rules_id, data.policydata[i].policy_type, data.policydata[i].rules_name,data.policydata[i].remarks]);
                }
                var otable = $("#divpolicydata").DataTable({
                    data: data1, scrollX: !0, searching: !1,
                    'columnDefs': [{ 'targets': 0, 'checkboxes': { 'selectRow': true } }, { orderable: false, targets: 0 }], 'select': { 'style': 'multi' },
                    columns: [{ title: "", width: '10px' }, { title: "Rules Type", width: '90px' }, { title: "Rules Name", width: '90px' }, { title: "Description", width: '90px' }]
                });
                $(".table").css({ "width": "100%" });
                $(".dataTables_scrollHeadInner ").css({ "width": "100%" });
                $("#btnsavepolicy").show();
                $('#btnsavepolicy').on('click', function (e) {
                    var form = this;
                    rulesid = "";
                    var rows_selected = otable.column(0).checkboxes.selected();
                    $.each(rows_selected, function (index) {
                        for (var i = 0; i < rows_selected.length; i++) {
                            rulesid += "," + rows_selected[i];
                        }
                        save_policy();
                        return false;
                    });
                });
		    }
	    });
    }


    @*function save_policy() {
        //debugger;
	   var policy= document.getElementById("txtpolicyname").value;
        var pdesc = document.getElementById("txtpolicydesc").value;
        //if ($("#txtpolicyname").val() == "") {
        //    alert("Please enter Policy Name !");
        //    return false;
        //}
        //if ($("#txtpolicydesc").val() == "") {
        //    alert("Please enter Policy Detail !");
        //    return false;
        //}
        var $valid = $('#CreatePolicyValidation').valid();
        if (rulesid != '') {
            if (!$valid) {
                $validatorform.focusInvalid();
                return false;
            }
            else {
                if (rulesid != '') {
                    var url = '@Url.Content("~/csat_policy_mgmt/Get_Policy_Save?rulesid=")' + rulesid + '&policyname=' + policy + '&description=' + pdesc;
                    $.ajax({
                        type: "Post",
                        url: url,
                        success: function (result) {
                            //debugger;
                            alert(result);
                            document.getElementById("txtpolicyname").value = '';
                            document.getElementById("txtpolicydesc").value = '';
                            $('#policy_popup').modal('hide');
                            displaypolicydetailsdata();
                            window.location.href = '@Url.Content("~/csat_policy_mgmt/csat_policy_create")';
                        }
                    });
                }
            //else {
            //       alert("Select any one !");
            //       return false;
            //}
            }
        }
        //else {
        //    alert("Select any one !");
        //    return false;
        //}
    };*@

    function save_policy() {
        //debugger;
	   var policy= document.getElementById("txtpolicyname").value;
	   var pdesc= document.getElementById("txtpolicydesc").value;
        //if ($("#txtpolicyname").val() == "") {
        //    alert("Please enter Policy Name !");
        //    return false;
        //}
        //if ($("#txtpolicydesc").val() == "") {
        //    alert("Please enter Policy Detail !");
        //    return false;
        //}
        var $valid = $('#CreatePolicyValidation').valid();
        if (!$valid) {
            $validatorform.focusInvalid();
            return false;
        }
        else {
            if (rulesid != '') {
                var url = '@Url.Content("~/csat_policy_mgmt/Get_Policy_Save?rulesid=")' + rulesid + '&policyname=' + policy + '&description=' + pdesc;
                $.ajax({
                    type: "Post",
                    url: url,
                    success: function (result) {
                        //debugger;
                        alert(result);
                        document.getElementById("txtpolicyname").value = '';
                        document.getElementById("txtpolicydesc").value = '';
                        $('#policy_popup').modal('hide');
                        displaypolicydetailsdata();
                        window.location.href = '@Url.Content("~/csat_policy_mgmt/csat_policy_create")';
                    }
                });
            }
            else {
                   alert("Select any one !");
                   return false;
            }
        }
    };

    var apply_policyid = '';
    var applydeviceid = "";
    // Unapply policy
    function openLinkedDevice(policy_id) {
        //debugger;
        apply_policyid = policy_id;
        $('#system_unlink').modal('show');
        var url1 = '@Url.Content("~/csat_policy_mgmt/get_apply_policy_devices?policy_id=")' + policy_id;
	    $.ajax({
        type: "POST",
        url: url1,
            success: function (data) {
                var agent_divclear = document.getElementById('div_system_linked_unlink_div');
                agent_divclear.innerHTML = '&nbsp;';
                $('#div_system_linked_unlink_div').append("<table id='div_system_linked_unlink' class='table table-striped table-bordered' width='100%'></table></div><div class='form-group'><div class='col-xs-5' style='margin-left:-10px;'>&nbsp;<input type='button' class='btn btn-primary' name='Add' value='Remove' id='unlinkdevice'/>&nbsp;<input type='button' class='btn btn-primary' data-dismiss='modal' name='close' value='Cancel' /></div></div>");
                otable = document.getElementById('div_system_linked_unlink');
                var data1 = [];
                for (var i = 0; i < data.applypolicydevice.length; i++) {
                    data1.push([data.applypolicydevice[i].device_id, data.applypolicydevice[i].ou_longname, data.applypolicydevice[i].device_name, data.applypolicydevice[i].ip]);
                }
                var otable = $("#div_system_linked_unlink").DataTable({
                    data: data1, scrollX: !0, searching: !1,
                    'columnDefs': [{ 'targets': 0, 'checkboxes': { 'selectRow': true } }, { orderable: false, targets: 1 }], 'select': { 'style': 'multi' },
                    columns: [{ title: "", width: '10px' }, { title: "Branch/ Unit", width: '170px' }, { title: "System Name", width: '90px' }, { title: "IP Address", width: '80px' }]
                });
                $(".table").css({ "width": "100%" });
                $(".dataTables_scrollHeadInner ").css({ "width": "100%" });
                $('#unlinkdevice').on('click', function (e) {
                    var form = this;
                    var rows_selected = otable.column(0).checkboxes.selected();
                    $.each(rows_selected, function (index) {
                        //debugger;
                        applydeviceid = "";
                        for (var i = 0; i < rows_selected.length; i++) {
                            applydeviceid += "," + rows_selected[i];
                        }
                        unlinkdevice(applydeviceid, policy_id);
                        return false;
                    });
                });

			}
		});
    }


    function unlinkdevice(applydeviceid, policy_id) {
       // debugger;
        if (applydeviceid != '') {
            var url1 = '@Url.Content("~/csat_policy_mgmt/Get_Policy_Unapply?policyid=")' + policy_id + '&deviceid=' + applydeviceid;
            $.ajax({
                type: "POST",
                url: url1,
                success: function (result) {
                    alert(result);
                    $('#system_unlink').modal('hide');
                    displaypolicydetailsdata();
                    @*window.location.href = '@Url.Content("~/csat_policy_mgmt/csat_policy_create")';*@
                }
            });
        }
        else {
            alert('Please select any device..');
        }
    }

    var remove_policyid = '';
    var remove_cnt = '';
    function removepolicy(policy_id,cnt) {
        remove_policyid = policy_id;
        remove_cnt = cnt;
        if (remove_cnt > 0)
            $('#notdelete_policy').modal('show');
        else
            $('#delete_policy').modal('show');
    }
    function removepolicy1() {
        var url1 = '@Url.Content("~/csat_policy_mgmt/Get_Policy_remove?policyid=")' + remove_policyid;
            $.ajax({
                type: "POST",
                url: url1,
                success: function (result) {
                    alert(result);
                    $('#delete_policy').modal('hide');
                    displaypolicydetailsdata();
                    window.location.href = '@Url.Content("~/csat_policy_mgmt/csat_policy_create")';
                }
            });

     //   alert(remove_policyid);
    }
</script>
<script type="text/javascript">
    function isNumberKey(evt) {
        var charCode = (evt.which) ? evt.which : evt.keyCode;
        if (charCode != 46 && charCode > 31
            && (charCode < 48 || charCode > 57))
            return false;
        return true;
    }
    $('#txtfwsourceport').on('change', function () {
        var source = "";
        source = document.getElementById('txtfwsourceport').value;
        if (source != "") {
            $("#txtfwsourceport").prop('disabled', false);
            $("#txtfwdestinationip").prop('disabled', 'disabled');
        }
        else {
            $("#txtfwsourceport").prop('disabled', false);
            $("#txtfwdestinationip").prop('disabled', false);
        }
    });
    $('#txtfwdestinationip').on('change', function () {
        var destination = "";
        destination = document.getElementById('txtfwdestinationip').value;
        if (destination != "") {
            $("#txtfwdestinationip").prop('disabled', false);
            $("#txtfwsourceport").prop('disabled', 'disabled');
        }
        else {
            $("#txtfwsourceport").prop('disabled', false);
            $("#txtfwdestinationip").prop('disabled', false);
        }
    });
</script>

<script>
   // var policy_id="";
    var adddevicepolicy = "";
    function applybtnpolicy() {
        //debugger;
        $('#apply_new_popup').modal('show');
        Func_ipwise();
    }
    function Func_ipwise() {
        var $valid = $('#frm_applypolicy1').valid();
        if (!$valid) {
            $validatorform.focusInvalid();
            return false;
        } else {
            var policy_id = apply_policyid;
            Actionvalue8 = $('input[name=SerialNumber8]:checked').val();
            var ip_value2 = document.getElementById("IP2").value;
            var url1 = '@Url.Content("~/csat_policy_mgmt/Get_Policy_ip?policyid=")' + policy_id + '&ostype=' + Actionvalue8 + '&ip=' + ip_value2;
            $.ajax({
                type: "POST",
                url: url1,
                success: function (data) {
                    document.getElementById('apply_policy_name').innerText = 'Apply Policy [ Policy Name : ' + data.policy_name + ' ]';
                    var agent_divclear = document.getElementById('apply_policy_popup_div');
                    agent_divclear.innerHTML = '&nbsp;';
                    $('#apply_policy_popup_div').append("<table id='apply_policy_popup' class='table table-striped table-bordered' width='100%'></table></div><div class='form-group'><div class='col-xs-5' style='margin-left:-10px;'>&nbsp;<input type='button' class='btn btn-primary' name='Add' value='Apply' id='addpolicydevice' onclick='btnpolicyappliedonclick()'  />&nbsp;<input type='button' class='btn btn-primary' data-dismiss='modal' name='close' value='Cancel' /></div></div>");
                    apptable = document.getElementById('apply_policy_popup');
                    var data1 = [];
                    for (var i = 0; i < data.getapppolicydata.length; i++) {
                        data1.push([data.getapppolicydata[i].device_id, data.getapppolicydata[i].ou_longname, data.getapppolicydata[i].device_name, data.getapppolicydata[i].ip, data.getapppolicydata[i].ostype]);
                    }
                    apptable = $("#apply_policy_popup").DataTable({
                        data: data1, scrollX: !0, searching: !1,
                        'columnDefs': [{ 'targets': 0, 'checkboxes': { 'selectRow': true } }, { orderable: false, targets: 1 }], 'select': { 'style': 'multi' },
                        columns: [{ title: "", width: '10px' }, { title: "Branch/ Unit", width: '170px' }, { title: "System Name", width: '90px' }, { title: "IP Address", width: '80px' }, { title: "OS Type", width: '20px' }]
                    });
                    $(".table").css({ "width": "100%" });
                    $(".dataTables_scrollHeadInner ").css({ "width": "100%" });
                    //$('#addpolicydevice').on('click', function (e) {
                    //    var form = this;
                    //    var rows_selected = otable.column(0).checkboxes.selected();
                    //    $.each(rows_selected, function (index) {
                    //        //debugger;
                    //        adddevicepolicy = "";
                    //        for (var i = 0; i < rows_selected.length; i++) {
                    //            adddevicepolicy += "," + rows_selected[i];
                    //        }
                    //        btnpolicyappliedonclick(adddevicepolicy, policy_id);
                    //        return false;
                    //    });
                    //});
                }
            });
        }
    }

    @*function policyapplyonload(data) {
        // debugger;
        document.getElementById('apply_policy_name').innerText = 'Apply Policy [ Policy Name : ' + data.policy_name + ' ]';
        var gridheader = '';
        jQuery('#apppolicyon').html('');
        var Setapppolicy = $('#apppolicyon');
        var apppolicyheader = "";
        var apppolicyrows = "";
        apppolicyheader += "<table class='table table-striped table-bordered tblpaging'  style='width: 100 %;'><thead><tr><th class='select' data-orderable='false'><input type='checkbox' class='parent' data-group='.group33' /></th>" +
            apppolicyheader + " <th>Branch/ Unit</th><th class='icon'>Count</th></tr></thead><tbody>";
        for (var i = 0; i < data.getapppolicydata.length; i++) {

            apppolicyrows += "<tr><td class='select'><input type='checkbox' class='group33' name='check[]' id='gridrawcheck33' value='" + data.getapppolicydata[i].ou_nodelinkage_ouid + "' onchange='UncheckMain33()' /></td>" +
                "<td>" + data.getapppolicydata[i].ou + "</td>" +
                "<td class='icon'>" + data.getapppolicydata[i].count + "</td></tr>";
        }
        apppolicyheader = apppolicyheader + apppolicyrows + "</tbody></table>";
        //$("#btnpolicyappliedon").show();
        Setapppolicy.append(apppolicyheader);
        datatable_paging();

        $(".parent").each(function (index) {
            // debugger;
            var group = $(this).data("group");
            var parent = $(this);

            parent.change(function () {  //"select all" change
                // debugger;
                $(group).prop('checked', parent.prop("checked"));
                UncheckMain33();
            });
            $(group).change(function () {
                //debugger;
                parent.prop('checked', false);
                if ($(group + ':checked').length == $(group).length) {
                    parent.prop('checked', true);
                }
            });
        });
    }
    $("#applyDrpOU").change(function () {
        var policy_id = apply_policyid;
        var url = '@Url.Content("~/csat_policy_mgmt/Get_Policy?name=")' + this.value + '&policyid=' + policy_id ;
         $.ajax({
         type: "POST",
         url: url,
         success: function (data) {
            //  debugger;

             jQuery('#apppolicyon').html('');
             var Setapppolicy = $('#apppolicyon');

			 var apppolicyheader ="";
             var apppolicyrows = "";
             if (data.gridtype == 'OU') {
                 apppolicyheader += "<table class='table table-striped table-bordered tblpaging'  style='width: 100 %;'><thead><tr> <th class='select' data-orderable='false'><input type='checkbox' class='parent' data-group='.group33' /></th>" +
                     apppolicyheader + "<th>Branch/ Unit</th><th class='count'>Count</th></tr></thead><tbody>";
                 for (var i = 0; i < data.getapppolicydata.length; i++) {

                     apppolicyrows += "<tr><td class='select'><input type='checkbox' class='group33' name='check[]' id='gridrawcheck33' value='" + data.getapppolicydata[i].ou_nodelinkage_ouid +"' onchange='UncheckMain33()' /></td>" +
                         "<td>" + data.getapppolicydata[i].ou+ "</td>" +
                         "<td>" + data.getapppolicydata[i].count + "</td></tr>";
                 }
                 apppolicyheader = apppolicyheader + apppolicyrows + "</tbody></table>";
                 //$("#btnpolicyappliedon").show();
                 Setapppolicy.append(apppolicyheader);
                 datatable_paging();

             }
             if (data.gridtype == 'System') {
                 apppolicyheader += "<table class='table table-striped table-bordered tblpaging'  style='width: 100 %;'><thead><tr><th class='select' data-orderable='false'><input type='checkbox' class='parent' data-group='.group33' /></th><th class='col-sm-6'>Branch/ Unit</th><th class='col-sm-3'>System Name</th><th  class='col-sm-3'>IP Address</th></tr></thead><tbody>";
                 for (var i = 0; i < data.getapppolicydata.length; i++) {

                     apppolicyrows += "<tr><td class='select'><input type='checkbox' class='group33' name='check[]' id='gridrawcheck33' value='" + data.getapppolicydata[i].device_id +"' onchange='UncheckMain33()' /></td>" +
                         "<td>" + data.getapppolicydata[i].ou_longname + "</td>" +
                         "<td>" + data.getapppolicydata[i].device_name + "</td>" +
						 "<td>" + data.getapppolicydata[i].ip + "</td></tr>";

                 }
                 apppolicyheader = apppolicyheader + apppolicyrows + "</tbody></table>";
                 //$("#btnpolicyappliedon").show();
                 Setapppolicy.append(apppolicyheader);
                 datatable_paging();

             }
             if (data.gridtype == 'User') {
                 apppolicyheader += "<table class='table table-striped table-bordered tblpaging'  style='width: 100 %;'><thead><tr> <th class='select' data-orderable='false'><input type='checkbox' class='parent' data-group='.group33' /></th><th>User Name</th></tr></thead><tbody>";
                 for (var i = 0; i < data.getapppolicydata.length; i++) {

                     apppolicyrows += "<tr><td class='select'><input type='checkbox' class='group33' name='check[]' id='gridrawcheck33' value='" + data.getapppolicydata[i].user +"' onchange='UncheckMain33()' /></td>" +
                         "<td>" + data.getapppolicydata[i].user + "</td></tr>";

                 }
                 apppolicyheader = apppolicyheader + apppolicyrows + "</tbody></table>";
                 //$("#btnpolicyappliedon").show();
                 Setapppolicy.append(apppolicyheader);
                 datatable_paging();

             }

             $(".parent").each(function (index) {
                // debugger;
                 var group = $(this).data("group");
                 var parent = $(this);

                 parent.change(function () {  //"select all" change
                    // debugger;
                     $(group).prop('checked', parent.prop("checked"));
                     UncheckMain33();
                 });
                 $(group).change(function () {
                   //  debugger;
                     parent.prop('checked', false);
                     if ($(group + ':checked').length == $(group).length) {
                         parent.prop('checked', true);
                     }
                 });
             });


            }
        });
     });*@
        //var applypid = "";
        //function UncheckMain33() {
        //    // debugger;
        //    applypid = "";
        //    var checkboxes = document.querySelectorAll('input[id="gridrawcheck33"]');
        //    for (var i = 0; i < checkboxes.length; i++) {
        //        if (checkboxes[i].checked == true) {
        //            applypid += "," + checkboxes[i].value;
        //        }
        //        else {

        //        }

        //    }
        //   // alert(applypid);
        //}

    function btnpolicyappliedonclick() {
        //debugger;
        var policy_id = apply_policyid;
        var rows_selected = apptable.column(0).checkboxes.selected();
        $.each(rows_selected, function (index) {
            //debugger;
            adddevicepolicy = "";
            for (var i = 0; i < rows_selected.length; i++) {
                adddevicepolicy += "," + rows_selected[i];
            }
            return false;
        });

        if (adddevicepolicy != '') {
            var url = '@Url.Content("~/csat_policy_mgmt/Get_Policy_Apply_link_popup?policyid=")' + policy_id + '&applyid=' + adddevicepolicy;
            $.ajax({
                type: "Post",
                url: url,
                success: function (result) {
                    alert(result);
                    $('#apply_new_popup').modal('hide');
                    $('#system_unlink').modal('hide');
                    displaypolicydetailsdata();
                }
            });
        }
        else {
            alert("Select any one !");
            return false;
        }
    }

</script>
<script>

    var Etable;
    var nacstr = "";
    var ArrayObject = [];
    function add_nac() {
        //debugger;
        var nacpolicyname = document.getElementById("nacpolicyname").value;
        var nacpolicydesc = document.getElementById("nacpolicydesc").value;
        var nacip = document.getElementById("nacip").value;
        var nactype = document.getElementById("nactype").value;
        var nacaction = document.getElementById("nacaction").value;
        var nacprotocol = document.getElementById("nacprotocol").value;
        var $valid = $('#frm_nacpolicy').valid();
        if (!$valid) {
            $validatorform.focusInvalid();
            return false;
        }
        else {
            var ELevel = new Object();
            ELevel.nacpolicyname = nacpolicyname;
            ELevel.nacip = nacip;
            ELevel.nactype = nactype;
            ELevel.nacaction = nacaction;
            ELevel.nacprotocol = nacprotocol;
            ELevel.nacpolicydesc = nacpolicydesc;
            ArrayObject.push(ELevel);
            localStorage.setItem("NAC_Add", JSON.stringify(ArrayObject));
            getnacdatatable();
            document.getElementById("nacip").value = "";
            return (true);
        }
    }
    function getnacdatatable() {
        //debugger;
        var ArrayObject1 = "";
        ArrayObject1 = JSON.parse(localStorage.getItem("NAC_Add"));
        nacstr = localStorage.getItem("NAC_Add");
        var user_divclear = document.getElementById('bindnachtml_div');
        user_divclear.innerHTML = '&nbsp;';
        $('#bindnachtml_div').append("<table id='bindnachtml' class='table table-bordered' width='100%'></table>");
        Etable = document.getElementById('bindnachtml');
        var data2 = [];
        var nacdelete = "";
        if (ArrayObject1 != "" && ArrayObject1 != null) {
            for (var i = 0; i < ArrayObject1.length; i++) {
                var EObject = ArrayObject1[i];

                if (EObject.nactype == 2)
                    EObject.nactype = "Any";
                else
                    EObject.nactype = "Inbound";

                if (EObject.nacaction == 0)
                    EObject.nacaction = "Block";
                else
                    EObject.nacaction = "Allow";

                if (EObject.nacprotocol == "NA")
                    EObject.nacprotocol = "Any";
                else if (EObject.nacprotocol == "6")
                    EObject.nacprotocol = "TCP";
                else if (EObject.nacprotocol == "17")
                    EObject.nacprotocol = "UDP";
                else if (EObject.nacprotocol == "1")
                    EObject.nacprotocol = "ICMP";
                else if (EObject.nacprotocol == "2")
                    EObject.nacprotocol = "IGMP";
                else if (EObject.nacprotocol == "4")
                    EObject.nacprotocol = "IPV4";
                else if (EObject.nacprotocol == "41")
                    EObject.nacprotocol = "IPV6";
                else if (EObject.nacprotocol == "27")
                    EObject.nacprotocol = "RDP";
                else if (EObject.nacprotocol == "115")
                    EObject.nacprotocol = "I2TP";
                else if (EObject.nacprotocol == "132")
                    EObject.nacprotocol = "SCTPC";
                else if (EObject.nacprotocol == "58")
                    EObject.nacprotocol = "IPV6-ICMP";

                nacdelete = "<i class=' glyphicon glyphicon-trash manage_icon' type='button' data-toggle='modal' title='Delete' onclick=Deletenac('" + ArrayObject1[i].nacip + "')></i>";
                data2.push([EObject.nacip, EObject.nactype, EObject.nacaction, EObject.nacprotocol, nacdelete]);
            }
        }
        else {

        }
        Etable = $("#bindnachtml").DataTable({
            data: data2, scrollX: !0, searching: !1,
            columns: [{ title: "IP Address" }, { title: "Direction" }, { title: "Perform Action" }, { title: "Protocol" }, { title: "Delete", orderable: false, className: 'dt-center'}]
        }).columns.adjust();

        $(".table").css({ "width": "100%" });
        $(".dataTables_scrollHeadInner ").css({ "width": "100%" });
    }
    function Deletenac(nacip) {
        ArrayObject = JSON.parse(localStorage.getItem("NAC_Add")) || {}; //fetch cart from storage
        for (var i = 0; i < ArrayObject.length; i++) { //loop over the collection
            if (ArrayObject[i].nacip === nacip) { //see if ids match
                ArrayObject.splice(i, 1); //remove item from array
                localStorage.setItem("NAC_Add", JSON.stringify(ArrayObject)); //set item back into storage
                break; //exit loop
            }
        }
        getnacdatatable();
    }
    $('#btnsavenac').on("click", function () {
        //debugger;
        var policy_name = document.getElementById("nacpolicyname").value;
        var policy_desc = document.getElementById("nacpolicydesc").value;
        var rulestype = "17"; //document.getElementById("select_policy").value;
        var firewall_rules = "1"; //document.getElementById("select_firewall_rules").value;
        var nacstr = localStorage.getItem("NAC_Add");
        var url = '@Url.Content("~/csat_policy_mgmt/Create_NACPolicy?rulestype=")' + rulestype + '&firewall_rules=' + firewall_rules + '&nac_str=' + nacstr + '&policyname=' + policy_name + '&policydesc=' + policy_desc;
        $.ajax({
            type: "POST",
            url: url,
            success: function (result) {
                // debugger;
                alert(result);
                cleardata_nac();
                Refereshpolicy();
                RefereshHardwareType();
                policy_datatable();
                displaypolicydetailsdata();
                window.location.href = '@Url.Content("~/csat_policy_mgmt/csat_policy_create")';
            }
        });
    });
    function cleardata_nac() {
        $("#nacpolicy_popup").hide();
        document.getElementById("nacpolicyname").value = "";
        document.getElementById("nacpolicydesc").value = "";
        document.getElementById("nacip").value = "";
        document.getElementById("nactype").value = "2";
        document.getElementById("nacaction").value = "1";
        document.getElementById("nacprotocol").value = "NA";
        localStorage.removeItem("NAC_Add");
        localStorage.setItem("NAC_Add", JSON.stringify([]));
        setTimeout(function () {
            localStorage.clear();
        }, 200);
    }

</script>
<script>
    $(".parent").each(function (index) {
        // debugger;
        var group = $(this).data("group");
        var parent = $(this);

        parent.change(function () {  //"select all" change
            // debugger;
            $(group).prop('checked', parent.prop("checked"));
            getcheckedvalue();
        });
        $(group).change(function () {
            //  debugger;
            parent.prop('checked', false);
            if ($(group + ':checked').length == $(group).length) {
                parent.prop('checked', true);
            }
        });
    });
    var checkeduser = "";
    function checkallitems(source, parentid) {
        checkeduser = "";
        var checkboxes = document.querySelectorAll('input[id="' + parentid + '"]');
        for (var i = 1; i < checkboxes.length; i++) {
            if (checkboxes[i] != source) {
                checkboxes[i].checked = source.checked;
                checkeduser += "," + checkboxes[i].value;
            }
        }
    }

    function getcheckedvalue() {
        checkeduser = "";
        var checkboxes = document.querySelectorAll('input[name="check11[]"]');
        for (var i = 1; i < checkboxes.length; i++) {
            if (checkboxes[i].checked == true) {
                checkeduser += "," + checkboxes[i].value;
            }
            else {
            }
        }
    }

    function cleardata() {
        document.getElementById('txtpolicyname').value = '';
        document.getElementById('txtpolicydesc').value = '';
        document.getElementById("txtrulesname").value = '';
        document.getElementById("txtdescription").value = '';
        document.getElementById('select_policy').value = '1';
        $("#hardware").show();
        document.getElementById('dl_hrd_type').value = '1';
        $("#nonusb").show();
        $("#usb").hide();
        document.getElementById("allenable").checked = true;
        document.getElementById("alldisable").checked = false;
        document.getElementById("hwwrite").checked = true;
        document.getElementById("hwread").checked = false;
        //rules
        $("#rules").hide();
        document.getElementById('select_rules_subtype').value = '1';
        document.getElementById('txtcpuusage').value = '';
        document.getElementById('txtmemoryusage').value = '';
        document.getElementById('txtdiskusage').value = '';
        document.getElementById('txtcputhresold').value = '';
        $("#cpu_usage_monitoring").show();
        $("#disk_usage_monitoring").hide();
        $("#memory_usage_monitoring").hide();
        $("#application_monitoring").hide();
        $("#application_kill").hide();
        document.getElementById('drp_process').value = '-1';
        document.getElementById('processcrc').value = '';
        //share
        $("#share").hide();
        document.getElementById('share_delete_days').value = '';
        //user
        $("#user_policy").hide();
        document.getElementById('userrulealert').value = '1';
        document.getElementById('userrulesdayalert').value = '';
        //remote
        $("#remote_desktop_policy").hide();
        document.getElementById("rmtenable").checked = true;
        document.getElementById("rmtdisable").checked = false;
        //password complex
        $("#password_complexity").hide();
        document.getElementById("passenable").checked = true;
        document.getElementById("passdisable").checked = false;
        //ip change
        $("#ip_change_restriction").hide();
        document.getElementById("ipchgenable").checked = true;
        document.getElementById("ipchgdisable").checked = false;
        //login restriction
        $("#login_restriction_policy").hide();
        document.getElementById("oswindows").checked = true;
        document.getElementById("oslinux").checked = false;
        document.getElementById('drploginuser').value = '';
        document.getElementById('starthour').value = '0';
        document.getElementById('endhour').value = '0';
        //shutdown_policy
        $("#shutdown_policy").hide();
        document.getElementById("shutenable").checked = true;
        document.getElementById("shutdisable").checked = false;
        //power saver
        $("#power_saver_policy").hide();
        document.getElementById('powersavermode').value = '1';
        document.getElementById('powersaverMinutes').value = '1';
        //ip port blocking
        $("#ipport_blocking_policy").hide();
        document.getElementById('protocol').value = '1';
        document.getElementById("txtsourceip").value = '';
        document.getElementById("txtsourceport").value = '';
        document.getElementById("txtdestip").value = '';
        document.getElementById("txtdestport").value = '';
        document.getElementById("ipblockenable").checked = true;
        document.getElementById("ipblockdisable").checked = false;
        //event monitoring
        $("#event_monitoring").hide();
        document.getElementById('drp_event_type_new').value = '1';
        document.getElementById("txt_event_id_new").value = '';
        //disk_cleanup
        $("#disk_cleanup").hide();
        document.getElementById('scheduletype').value = '1';
        document.getElementById('weeklyday').value = '-1';
        document.getElementById('monthlydate').value = '-1';
        //firewall_rules
        $("#firewall_rules").hide();
        document.getElementById("select_firewall_rules").value = '1';
        //document.getElementById("txtfwsourceip").value = '';
        document.getElementById("txtfwdestinationip").value = '';
        document.getElementById("txtfwsourceport").value = '';
        //document.getElementById("txtfwdestinationport").value = '';
        document.getElementById("firewall_direction").value = '2';
        document.getElementById("block_allow_rules").value = '0';
        document.getElementById("protocol_rules").value = 'NA';
        // $('#tblweek').html('');

        //document.getElementById("applyDrpOU").value = '01';
    }
</script>
<script>
    $(function () {
        $('input[name="time"]').daterangepicker({

            //autoUpdateInput: true,
            singleDatePicker: true,
            timePicker: true,
            timePickerSeconds: false,
            timePicker24Hour: true,
            startDate: moment(),
            locale: {
                cancelLabel: 'Clear',
                format: 'HH:mm',
            }
        });
        $('.calendar-table').css('display', 'none');

        $('input[name="time"]').on('apply.daterangepicker', function (ev, picker) {

            $(this).val(picker.startDate.format('HH:mm'));
        });

        $('input[name="time"]').on('cancel.daterangepicker', function (ev, picker) {
            $(this).val('');
        });
        $(".model_body_scroll").bind('scroll', function () {
            $(".daterangepicker").hide();
        });
    });

</script>
<script>
    (function (g) {
        "function" === typeof define && define.amd ? define(["jquery"], g) : g(window.jQuery || window.Zepto)
    })(function (g) {
        var y = function (a, f, d) {
            var k = this,
                x;
            a = g(a);
            f = "function" === typeof f ? f(a.val(), void 0, a, d) : f;
            k.init = function () {
                d = d || {};
                k.byPassKeys = [9, 16, 17, 18, 36, 37, 38, 39, 40, 91];
                k.translation = {
                    0: {
                        pattern: /\d/
                    },
                    9: {
                        pattern: /\d/,
                        optional: !0
                    },
                    "#": {
                        pattern: /\d/,
                        recursive: !0
                    },
                    A: {
                        pattern: /[a-zA-Z0-9]/
                    },
                    S: {
                        pattern: /[a-zA-Z]/
                    }
                };
                k.translation = g.extend({}, k.translation, d.translation);
                k = g.extend(!0, {}, k, d);
                a.each(function () {
                    !1 !==
                        d.maxlength && a.attr("maxlength", f.length);
                    d.placeholder && a.attr("placeholder", d.placeholder);
                    a.attr("autocomplete", "off");
                    c.destroyEvents();
                    c.events();
                    var b = c.getCaret();
                    c.val(c.getMasked());
                    c.setCaret(b + c.getMaskCharactersBeforeCount(b, !0))
                })
            };
            var c = {
                getCaret: function () {
                    var b;
                    b = 0;
                    var e = a.get(0),
                        c = document.selection,
                        e = e.selectionStart;
                    if (c && !~navigator.appVersion.indexOf("MSIE 10")) b = c.createRange(), b.moveStart("character", a.is("input") ? -a.val().length : -a.text().length), b = b.text.length;
                    else if (e ||
                        "0" === e) b = e;
                    return b
                },
                setCaret: function (b) {
                    if (a.is(":focus")) {
                        var e;
                        e = a.get(0);
                        e.setSelectionRange ? e.setSelectionRange(b, b) : e.createTextRange && (e = e.createTextRange(), e.collapse(!0), e.moveEnd("character", b), e.moveStart("character", b), e.select())
                    }
                },
                events: function () {
                    a.on("keydown.mask", function () {
                        x = c.val()
                    });
                    a.on("keyup.mask", c.behaviour);
                    a.on("paste.mask drop.mask", function () {
                        setTimeout(function () {
                            a.keydown().keyup()
                        }, 100)
                    });
                    a.on("change.mask", function () {
                        a.data("changeCalled", !0)
                    });
                    a.on("blur.mask",
                        function (b) {
                            b = g(b.target);
                            b.prop("defaultValue") !== b.val() && (b.prop("defaultValue", b.val()), b.data("changeCalled") || b.trigger("change"));
                            b.data("changeCalled", !1)
                        });
                    a.on("focusout.mask", function () {
                        d.clearIfNotMatch && c.val().length < f.length && c.val("")
                    })
                },
                destroyEvents: function () {
                    a.off("keydown.mask keyup.mask paste.mask drop.mask change.mask blur.mask focusout.mask").removeData("changeCalled")
                },
                val: function (b) {
                    var e = a.is("input");
                    return 0 < arguments.length ? e ? a.val(b) : a.text(b) : e ? a.val() : a.text()
                },
                getMaskCharactersBeforeCount: function (b,
                    e) {
                    for (var a = 0, c = 0, d = f.length; c < d && c < b; c++) k.translation[f.charAt(c)] || (b = e ? b + 1 : b, a++);
                    return a
                },
                determineCaretPos: function (b, a, d, h) {
                    return k.translation[f.charAt(Math.min(b - 1, f.length - 1))] ? Math.min(b + d - a - h, d) : c.determineCaretPos(b + 1, a, d, h)
                },
                behaviour: function (b) {
                    b = b || window.event;
                    var a = b.keyCode || b.which;
                    if (-1 === g.inArray(a, k.byPassKeys)) {
                        var d = c.getCaret(),
                            f = c.val(),
                            n = f.length,
                            l = d < n,
                            p = c.getMasked(),
                            m = p.length,
                            q = c.getMaskCharactersBeforeCount(m - 1) - c.getMaskCharactersBeforeCount(n - 1);
                        p !== f && c.val(p);
                        !l || 65 === a && b.ctrlKey || (8 !== a && 46 !== a && (d = c.determineCaretPos(d, n, m, q)), c.setCaret(d));
                        return c.callbacks(b)
                    }
                },
                getMasked: function (b) {
                    var a = [],
                        g = c.val(),
                        h = 0,
                        n = f.length,
                        l = 0,
                        p = g.length,
                        m = 1,
                        q = "push",
                        s = -1,
                        r, u;
                    d.reverse ? (q = "unshift", m = -1, r = 0, h = n - 1, l = p - 1, u = function () {
                        return -1 < h && -1 < l
                    }) : (r = n - 1, u = function () {
                        return h < n && l < p
                    });
                    for (; u();) {
                        var v = f.charAt(h),
                            w = g.charAt(l),
                            t = k.translation[v];
                        if (t) w.match(t.pattern) ? (a[q](w), t.recursive && (-1 === s ? s = h : h === r && (h = s - m), r === s && (h -= m)), h += m) : t.optional && (h += m, l -= m), l +=
                            m;
                        else {
                            if (!b) a[q](v);
                            w === v && (l += m);
                            h += m
                        }
                    }
                    b = f.charAt(r);
                    n !== p + 1 || k.translation[b] || a.push(b);
                    return a.join("")
                },
                callbacks: function (b) {
                    var e = c.val(),
                        g = c.val() !== x;
                    if (!0 === g && "function" === typeof d.onChange) d.onChange(e, b, a, d);
                    if (!0 === g && "function" === typeof d.onKeyPress) d.onKeyPress(e, b, a, d);
                    if ("function" === typeof d.onComplete && e.length === f.length) d.onComplete(e, b, a, d)
                }
            };
            k.remove = function () {
                var a = c.getCaret(),
                    d = c.getMaskCharactersBeforeCount(a);
                c.destroyEvents();
                c.val(k.getCleanVal()).removeAttr("maxlength");
                c.setCaret(a - d)
            };
            k.getCleanVal = function () {
                return c.getMasked(!0)
            };
            k.init()
        };
        g.fn.mask = function (a, f) {
            //this.unmask();
            return this.each(function () {
                g(this).data("mask", new y(this, a, f))
            })
        };
        //g.fn.unmask = function () {
        //    return this.each(function () {
        //        try {
        //            g(this).data("mask").remove()
        //        } catch (a) { }
        //    })
        //};
        g.fn.cleanVal = function () {
            return g(this).data("mask").getCleanVal()
        };
        g("*[data-mask]").each(function () {
            var a = g(this),
                f = {};
            "true" === a.attr("data-mask-reverse") && (f.reverse = !0);
            "false" === a.attr("data-mask-maxlength") && (f.maxlength = !1);
            "true" === a.attr("data-mask-clearifnotmatch") && (f.clearIfNotMatch = !0);
            a.mask(a.attr("data-mask"), f)
        })
    });

    $('.ip_address').mask('099.099.099.099');
</script>

<script>

    $(document).ready(function () {
        validateSingleForm('#CreatePolicyValidation');
        validateSingleForm('#CreateRulesF');
    });
    //$('#CreatePolicyValidation').submit(function (e) {
    //    e.preventDefault();
    //    var $valid = $('#CreatePolicyValidation').valid();
    //    if (!$valid) {
    //        $validatorform.focusInvalid();
    //        return false;
    //    } else {
    //        $("#divpolicydata").dataTable().fnDestroy();
    //        policy_datatable()
    //    }
    //})

    $('#CreateRulesF').submit(function (e) {
        e.preventDefault();
        var $valid = $('#CreateRulesF').valid();
        if (!$valid) {
            $validatorform.focusInvalid();
            return false;
        } else {
            saverules()
        }
    })


</script>

