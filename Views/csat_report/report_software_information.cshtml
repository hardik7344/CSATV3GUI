
@{
    ViewData["Title"] = "report_software_information";
    Layout = "~/Views/Shared/ownyit_main_page.cshtml";
}
<!--date-time picker-->
<script type="text/javascript">
    var now = new Date();
    var day = ("0" + now.getDate()).slice(-2);
    var month = ("0" + (now.getMonth() + 1)).slice(-2);
    var today = (day) + "-" + (month) + "-" + now.getFullYear();
    function dateselect() {
        var startdate = '';
        var enddate = '';
        $(function () {
            $('input[name="datefilter"]').daterangepicker({
                // opens: 'left',
                autoUpdateInput: true,
                startDate: moment().startOf('hour').add(-24, 'hour'),
                endDate: moment().startOf('hour'),
                locale: {
                    format: 'DD/MM/YYYY',
                    cancelLabel: 'Clear',
                }
            });

            $('input[name="datefilter"]').on('apply.daterangepicker', function (ev, picker) {
                startdate = picker.startDate.format('DD/MM/YYYY');
                enddate = picker.endDate.format('DD/MM/YYYY');
                $(this).val(picker.startDate.format('DD/MM/YYYY') + ' - ' + picker.endDate.format('DD/MM/YYYY '));
            });

            $('input[name="datefilter"]').on('cancel.daterangepicker', function (ev, picker) {
                $(this).val('');
            });
            $(".model_body_scroll").bind('scroll', function () {
                $(".daterangepicker").hide();
            });
        });
    }
</script>
<script type="text/javascript">

    function Checkinstall() {
        if (document.getElementById('install').checked) {
            document.getElementById('divsoft_install').style.display = 'block';
            document.getElementById('divsoft_notinstall').style.display = 'none';
        }
        if (document.getElementById('notinstall').checked) {
            document.getElementById('divsoft_notinstall').style.display = 'block';
            document.getElementById('divsoft_install').style.display = 'none';
        }
    }
    function Check() {
        if (document.getElementById('Software').checked) {
            document.getElementById('system_view').style.display = 'none';
            document.getElementById('software_view').style.display = 'block';
        }
        else {
            document.getElementById('system_view').style.display = 'block';
            document.getElementById('software_view').style.display = 'none';
        }
        if (document.getElementById('System').checked) {
            document.getElementById('system_view').style.display = 'block';
            document.getElementById('software_view').style.display = 'none';
        }
        else {
            document.getElementById('system_view').style.display = 'none';
            document.getElementById('software_view').style.display = 'block';
        }
    }
    function Check1() {
        if (document.getElementById('Software').checked) {
            document.getElementById('software_install').style.display = 'block';
            document.getElementById('system_install').style.display = 'none';
        }
        else {
            document.getElementById('software_install').style.display = 'block';
            document.getElementById('system_install').style.display = 'none';
        }
        if (document.getElementById('System').checked) {
            document.getElementById('system_install').style.display = 'block';
            document.getElementById('software_install').style.display = 'none';
        }

    }

    $(document).ready(function () {
        $("#software_up").click(function () {
            $("#software_form").toggle();

        });
    });
    $(document).ready(function () {
        $("#system_up").click(function () {
            $("#system_form").toggle();

        });
    });
    $(document).ready(function () {
        $("#product_up").click(function () {
            $("#product_form").toggle();

        });
    });
    $(document).ready(function () {
        $("#product_count_up").click(function () {
            $("#product_count_form").toggle();

        });
    });
    $(document).ready(function () {
        $("#product_system_count_up").click(function () {
            $("#product_system_count_form").toggle();

        });
    });
    $(document).ready(function () {
        $("#product_key_count_up").click(function () {
            $("#product_key_count_form").toggle();

        });
    });

    $(document).ready(function () {
        $("#product_generate_up").click(function () {
            $("#product_generate_form").toggle();
        });
    });



</script>

<div class="row">
    <div class="ibox float-e-margins ">
        <div class="ibox-content" style="padding:4px;">
            <div class="pull-right form_label btn_top_margin">
                <button class="btn btn-primary btn-md day" data-toggle="modal" onclick="productKeypopup()" id="180">Product Key Information</button>
            </div>
            <ul class="breadcrumb" style="margin-bottom:0px;">
                <li>
                    @Html.ActionLink("Reports", "report_agent_information", "csat_report")
                    <i class="icon-angle-right"></i>
                </li>
                <li> Software Information  </li>
            </ul>
        </div>
    </div>
    <!--side menu-->
    <div class="col-sm-2 col-md-2 col-lg-2 no_padding">
        <div class="ibox float-e-margins ">
            <div class="ibox-content sidemenu">
                @{
                    @Html.Partial("csat_report_menu");
                }
            </div>
        </div>
    </div>
    <!--side menu end-->

    <div class="col-sm-10 col-md-10 col-lg-10">
        <div class="ibox float-e-margins" style="margin-bottom: 10px;">
            <div class="ibox-content">
                <div class="row">
                    <div class="col-sm-12 col-md-12 col-lg-12">

                        <div class="row">
                            <div class="col-xs-12">
                                <form class="form-horizontal" method="post">
                                    <div class="form-group">
                                        <label for="nameField" style="margin-top: -5px;background-color: #fff;text-align: center;color: #3D93C8;width: 120px;" class="col-xs-2 form_label">&nbsp;&nbsp;Advance Search&nbsp;&nbsp;</label>
                                        <div class="col-xs-10">
                                        </div>
                                    </div>

                                </form>
                            </div>
                        </div>
                    </div>

                </div>
                <div class="col-sm-12 col-md-12 col-lg-12">
                    <div class="row">
                        <div class="col-xs-12">
                            <form class="form-horizontal" method="post" name="frm_softinform_report" id="frm_softinform_report">
                                <div class="form-group">
                                    <label for="nameField" class="col-xs-2 form_label">Branch/ Unit</label>
                                    <div class="col-xs-6">
                                        <select class="form-control col-sm-3 col-lg-3 col-md-3" name="Branch/Unit" id="DrpOU"></select>
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label for="nameField" class="col-xs-2">Type</label>
                                    <div class="col-xs-2 col-md-1 col-lg-2" style="padding-top:2px;">
                                        <div class="radio">
                                            <label> <input type="radio" name="viewby" value="Software wise" checked="checked" id="Software" onclick="javascript: Check(),Check1(); "> Software wise </label>
                                        </div>
                                    </div>
                                    <div class="col-xs-2 col-md-1 col-lg-2" style="padding-top:2px;">
                                        <div class="radio">
                                            <label> <input type="radio" name="viewby" value="System Wise" id="System" onclick="javascript:Check(),Check1();"> System Wise </label>
                                        </div>
                                    </div>
                                </div>

                                <div id="software_install">
                                    <div class="form-group">
                                        <label for="nameField" class="col-xs-2 ">Software Name</label>
                                        <div class="col-xs-4">
                                            <div class="input-group">
                                                <input type="search" class="form-control" placeholder="Software Search" id="txtsearchsoft" name="txtsearchsoft">
                                                <div class="input-group-btn">
                                                    <button class="btn btn-default" type="button" onclick="softinstalledcount()">
                                                        <i class="glyphicon glyphicon-search"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label for="nameField" class="col-xs-2">Software Status</label>
                                        <div class="col-xs-2 col-md-1 col-lg-2" style="padding-top:2px;">
                                            <div class="radio">
                                                <label> <input type="radio" name="software_name" value="Install" id="install" checked onclick="javascript: Checkinstall();"> Install </label>
                                            </div>
                                        </div>
                                        <div class="col-xs-2 col-md-1 col-lg-2" style="padding-top:2px;">
                                            <div class="radio">
                                                <label> <input type="radio" name="software_name" value="Not Install" id="notinstall" onclick="javascript: Checkinstall();"> Not Install </label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="nameField" class="col-xs-2">Category</label>
                                        <div class="col-xs-2 col-md-1 col-lg-2" style="padding-top:2px;">
                                            <div class="radio">
                                                <label> <input type="radio" name="viewbyauth" value="1" id="Auth">Authorise</label>
                                            </div>
                                        </div>
                                        <div class="col-xs-2 col-md-1 col-lg-2" style="padding-top:2px;">
                                            <div class="radio">
                                                <label> <input type="radio" name="viewbyauth" value="0" id="Unauth">Unauthorise</label>
                                            </div>
                                        </div>
                                        <div class="pull-left col-xs-1">
                                            <input type="button" class="btn btn-primary" value="Show" onclick="softinstalledcount()">
                                        </div>
                                    </div>
                                </div>

                                <div id="system_install" style="display:none">
                                    <div class="form-group">
                                        <label for="nameField" class="col-xs-2">System Name</label>
                                        <div class="col-xs-2" id="selectsys">
                                            <select class="form-control col-sm-3 col-lg-3 col-md-3" name="System Name" id="Device">
                                                <option value='-1'>Select System Name</option>
                                            </select>
                                        </div>
                                        <div class="col-xs-2" id="inputsystemname">
                                            <input type="text" class="form-control col-sm-3 col-lg-3 col-md-3" name="add_systemname" id="add_systemname">
                                        </div>
                                        <div class="col-xs-1">
                                            <input type="checkbox" class="form-check-input" id="add_system_chk" name="add_system_chk" style="width:20px;height:25px;">
                                        </div>
                                        <label for="nameField" class="col-xs-1 form_label" style="margin-left:-48px;">IP Address</label>
                                        <div class="col-xs-2">
                                            <input type="text" class="form-control col-sm-3 col-lg-3 col-md-3" placeholder="" name="IP" id="IP">
                                            @*<select class="form-control col-sm-3 col-lg-3 col-md-3" name="IP Address" id="IP">
                                                    <option value='-1'>Select IP Address</option>
                                                </select>*@
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="nameField" class="col-xs-2">Software By</label>
                                        <div class="col-xs-2 col-md-1 col-lg-2" style="padding-top:2px;">
                                            <div class="radio">
                                                <label> <input type="radio" name="software" value="Install" checked> Install </label>
                                            </div>
                                        </div>
                                        <div class="pull-left col-xs-1">
                                            <input type="button" class="btn btn-primary" value="Show" onclick="softinstalledcountsyswise()">
                                        </div>

                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!--form  content end-->
        <!--software info report form end-->
        <!--software info Datatable start-->
        <div id="software_view">
            <div class="row ibox2">
                <div class="col-sm-12 col-md-12 col-lg-12 ibox2-content" id="tblsoftinstcount_div">
                    <table id="tblsoftinstcount" class="table table-striped table-bordered " width="100%"></table>
                </div>

            </div>
            <div id='divsoft_install'>
                <div class='pull-left col-xs-1'>
                    <input type='button' class='btn btn-primary' value='Details Report' data-toggle='modal' id='btnsoftgeneraterpt' style="display:none">
                </div>
            </div>
            <div id='divsoft_notinstall' style='display:none'>
                <div class='pull-left col-xs-1'>
                    <input type='button' class='btn btn-primary' value='Details Report' data-toggle='modal' id='btnsoftgeneraterpt1' style="display:none">
                </div>
            </div>

            @*<div class='pull-left col-xs-1' style='margin-left:-9px;margin-top:-54px;'>
                    <input type='button' class='btn btn-primary' value='Details Report' data-toggle='modal' id='btnsoftgeneraterpt' style="display:none">
                </div>*@
        </div>

        <div id="system_view" style="display:none">
            <div class="row ibox2">
                <div class="col-sm-12 col-md-12 col-lg-12 ibox2-content" id="tblsoftinstcountsyswise_div">
                    <table id="tblsoftinstcountsyswise" class="table table-striped table-bordered " width="100%"></table>
                </div>

            </div>

        </div>

        @*<div id='divsoft_install'>
                <div class='pull-left col-xs-1' style='margin-left:-9px;margin-top:-54px;'>
                        <input type='button' class='btn btn-primary' value='Details Report' data-toggle='modal' id='btnsoftgeneraterpt' style="display:none">
                    </div>
            </div>*@
        @*<div id='divsoft_notinstall' style='display:none'>
                <div class='pull-left col-xs-1' style='margin-left:-9px;margin-top:-54px;'>
                    <input type='button' class='btn btn-primary' value='Details Report' data-toggle='modal' id='btnsoftgeneraterpt1'>
                </div>
            </div>*@

    </div>
    <div class="space_bottom">&nbsp;</div>
</div>
<!-- software_generat_report  install Data pop-up model box  Content-->
<div class="modal fade" id="software_generat_report" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog  modal-lg" style="margin-top: 82px;">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true" onclick="cleardata()">&times;</button>
                <h6 class=" modal-title">
                    Software Information Report
                </h6>
            </div>
            <div class="modal-body model_body_scroll">
                <div class="row">
                    <div class="col-sm-12 col-md-12 col-lg-12">
                        <!--form  content-->
                        <div class="row">
                            <i id="system_up" class="pull-right glyphicon glyphicon-chevron-down" style="color:#74b1f4;font-size: 12px;"></i>
                            <div class="col-xs-10">
                                <form class="form-horizontal" method="post" id="system_form" name="system_form">
                                    <div class="form-group">
                                        <label for="nameField" class="col-xs-1 form_label">Branch/ Unit</label>
                                        <div class="col-xs-3">
                                            <select class="form-control col-sm-3 col-lg-3 col-md-3" name="Branch/Unit" id="DrpOU2"></select>
                                        </div>
                                        <label for="nameField" class="col-xs-1 form_label">System Name</label>
                                        <div class="col-xs-2" id="selectsys2">
                                            <select class="form-control col-sm-3 col-lg-3 col-md-3" name="System" id="System2">
                                                <option value="-1">Select System Name</option>
                                            </select>
                                        </div>
                                        <div class="col-xs-2" id="inputsystemname2">
                                            <input type="text" class="form-control col-sm-3 col-lg-3 col-md-3" name="add_systemname2" id="add_systemname2">
                                        </div>
                                        <div class="col-xs-1">
                                            <input type="checkbox" class="form-check-input" id="add_system_chk2" name="add_system_chk2" style="width:20px;height:25px;">
                                        </div>
                                        <label for="nameField" class="col-xs-1 form_label">IP Address</label>
                                        <div class="col-xs-2">
                                            <input type="text" class="form-control col-sm-2 col-lg-2 col-md-2" placeholder="" name="IP2" id="IP2">
                                            @*<select class="form-control col-sm-2 col-lg-2 col-md-2" name="IP" id="IP2">
                <option value="-1">Select IP Address</option>
            </select>*@
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label for="nameField" class="col-xs-1 checkbox form_label"> <input type="checkbox" id="soft_gen_check"> Date Range </label>
                                        <div class="col-xs-4">
                                            <div id="soft_gen_text">
                                                <input type="text" class="form-control" id="softgentext" placeholder="DD/MM/YYYY - DD/MM/YYYY" readonly />
                                            </div>
                                            <div id="soft_gen_date">
                                                <input type="text" name="datefilter" class="form-control" placeholder="DD/MM/YYYY -  DD/MM/YYYY " id="date">
                                            </div>
                                        </div>
                                        @*<label for="nameField" class="col-xs-2 ">Date Range</label>
                                            <div class="col-xs-3">
                                                <input type="text" name="datefilter" class="form-control" placeholder="DD/MM/YYYY -  DD/MM/YYYY " id="date">
                                            </div>*@
                                        <label for="nameField" class="col-xs-1">Search</label>
                                        <div class="col-xs-2">
                                            <select class="form-control col-sm-2 col-lg-2 col-md-2" name="type" id="type2">
                                                <option value="-1">Select Type</option>
                                                <option value="software">Software Name</option>
                                                <option value="version">Version </option>
                                                <option value="publisher">Publisher</option>
                                                <option value="location">Install Location</option>
                                            </select>
                                        </div>
                                        <div class="col-xs-3">
                                            <div class="input-group">
                                                <input type="search" class="form-control" placeholder="Search" id="serachvalue2" name="serachvalue2">
                                                <div class="input-group-btn">
                                                    <button class="btn btn-default" type="button" id="btngeneratesoftshow1">
                                                        <i class="glyphicon glyphicon-search"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="pull-left col-xs-1">
                                            <input type="button" class="btn btn-primary" value="Show" id="btngeneratesoftshow">
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                        <!--End form  content-->
                    </div>
                </div>

                <!--software_generat_report  Datatable start-->
                <div class="row">
                    <div class="col-sm-12 col-md-12 col-lg-12 " id="tblsoftgenerate_div">
                        <table id="tblsoftgenerate" class="table table-striped table-bordered display nowrap" width="100%"></table>
                    </div>
                </div>

                <!--software_generat_report  Datatable end-->
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-dismiss="modal" onclick="cleardata()">Close</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div>
<!-- End software_generat_report pop-up model box Content -->
<!-- software_generat_report not install  Data pop-up model box  Content-->
<div class="modal fade" id="software_generat_report1" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog  modal-lg" style="margin-top: 82px;">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true" onclick="cleardata()">&times;</button>
                <h6 class=" modal-title">
                    Software Information Report
                </h6>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-sm-12 col-md-12 col-lg-12">
                        <!--form  content-->
                        <div class="row">
                            <i id="system_up" class="pull-right glyphicon glyphicon-chevron-down" style="color:#74b1f4;font-size: 12px;"></i>
                            <div class="col-xs-10">
                                <form class="form-horizontal" method="post" id="system_form" name="system_form">
                                    <div class="form-group">
                                        <label for="nameField" class="col-xs-1 form_label">Branch/ Unit</label>
                                        <div class="col-xs-4">
                                            <select class="form-control col-sm-3 col-lg-3 col-md-3" name="Branch/Unit" id="DrpOU3"></select>
                                        </div>
                                        <label for="nameField" class="col-xs-1 form_label">System Name</label>
                                        <div class="col-xs-3">
                                            <select class="form-control col-sm-3 col-lg-3 col-md-3" name="System" id="System3">
                                                <option value="-1">Select System Name</option>

                                            </select>
                                        </div>
                                        <label for="nameField" class="col-xs-1 form_label">IP Address</label>
                                        <div class="col-xs-2">
                                            <input type="text" class="form-control col-sm-2 col-lg-2 col-md-2" placeholder="" name="IP3" id="IP3">
                                            @*<select class="form-control col-sm-2 col-lg-2 col-md-2" name="IP" id="IP3">
                                                    <option value="-1">Select IP Address</option>
                                                </select>*@
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="nameField" class="col-xs-1 form_label">Software</label>
                                        <div class="col-xs-4">
                                            <div class="input-group">
                                                <input type="search" class="form-control" placeholder="serachsoft" id="serachsoft">
                                                <div class="input-group-btn">
                                                    <button class="btn btn-default" type="button" id="btngeneratenotinstallsoftshow">
                                                        <i class="glyphicon glyphicon-search"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="pull-left col-xs-1">
                                            <input type="button" class="btn btn-primary" value="Show" id="btngeneratenotinstallsoftshow">
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                        <!--End form  content-->

                    </div>
                </div>
                <!--software_generat_report  Datatable start-->
                <div class="row">
                    <div class="col-sm-12 col-md-12 col-lg-12 " id="tblsoftnotinstallgenerate_div">
                        <table id="tblsoftnotinstallgenerate" class="table table-striped table-bordered display nowrap" width="100%"></table>
                    </div>
                </div>

                <!--software_generat_report  Datatable end-->
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-dismiss="modal" onclick="cleardata()">Close</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div>
<!-- End software_generat_report pop-up model box Content -->
<!-- system_generat_report  Data pop-up model box  Content-->
<div class="modal fade" id="system_generat_report" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog  modal-lg" style="margin-top: 82px;">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true" onclick="cleardata()">&times;</button>
                <h6 class=" modal-title">
                    Software Information Report
                </h6>
            </div>
            <div class="modal-body model_body_scroll">
                <div class="row">
                    <div class="col-sm-12 col-md-12 col-lg-12">
                        <!--form  content-->
                        <div class="row">
                            <i id="system_up" class="pull-right glyphicon glyphicon-chevron-down" style="color:#74b1f4;font-size: 12px;"></i>
                            <div class="col-xs-10">
                                <form class="form-horizontal" method="post" id="system_form" name="system_form">
                                    <div class="form-group">
                                        <label for="nameField" class="col-xs-1 form_label">Branch/ Unit</label>
                                        <div class="col-xs-4">
                                            <select class="form-control col-sm-3 col-lg-3 col-md-3" name="Branch/Unit" id="DrpOU4"></select>
                                        </div>
                                        <label for="nameField" class="col-xs-1 form_label">System Name</label>
                                        <div class="col-xs-3">
                                            <select class="form-control col-sm-3 col-lg-3 col-md-3" name="System" id="System4">
                                                <option value="-1">Select System Name</option>
                                            </select>
                                        </div>
                                        <label for="nameField" class="col-xs-1 form_label">IP Address</label>
                                        <div class="col-xs-2">
                                            <input type="text" class="form-control col-sm-2 col-lg-2 col-md-2" placeholder="" name="IP4" id="IP4">
                                            @*<select class="form-control col-sm-2 col-lg-2 col-md-2" name="IP" id="IP4">
                                                    <option value="-1">Select IP Address</option>
                                                </select>*@
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="nameField" class="col-xs-1 form_label checkbox"> <input type="checkbox" id="system_gen_check"> Date Range </label>
                                        <div class="col-xs-4">
                                            <div id="system_gen_text">
                                                <input type="text" class="form-control" id="systemgentext" placeholder="DD/MM/YYYY - DD/MM/YYYY" readonly />
                                            </div>
                                            <div id="system_gen_date">
                                                <input type="text" name="datefilter" class="form-control" placeholder="DD/MM/YYYY -  DD/MM/YYYY " id="gen_system_date">
                                            </div>
                                        </div>
                                        <label for="nameField" class="col-xs-1">Search</label>
                                        <div class="col-xs-2">
                                            <select class="form-control col-sm-2 col-lg-2 col-md-2" name="type" id="type4">
                                                <option value="-1">Select Type</option>
                                                <option value="software">Software Name</option>
                                                <option value="version">Version </option>
                                                <option value="publisher">Publisher</option>
                                                <option value="location">Install Location</option>
                                            </select>
                                        </div>
                                        <div class="col-xs-3">
                                            <div class="input-group">
                                                <input type="search" class="form-control" placeholder="Search" id="searchsysgenrpt" name="searchsysgenrpt">
                                                <div class="input-group-btn">
                                                    <button class="btn btn-default" type="button" id="sysgenrptshow">
                                                        <i class="glyphicon glyphicon-search"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="pull-left col-xs-1">
                                            <input type="button" class="btn btn-primary" value="Show" id="sysgenrptshow">
                                        </div>
                                    </div>

                                </form>

                            </div>
                        </div>
                        <!--End form  content-->
                    </div>
                </div>
                <!--software_generat_report  Datatable start-->
                <div class="row">
                    <div class="col-sm-12 col-md-12 col-lg-12 " id="tblsysgenrpt_div">
                        <table id="tblsysgenrpt" class="table table-striped table-bordered display nowrap" width="100%"></table>
                    </div>
                </div>
                <!--software_generat_report  Datatable end-->
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-dismiss="modal" onclick="cleardata()">Close</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div>
<!-- End system_generat_report pop-up model box Content -->
<!-- Sotware Count  Data pop-up model box  Content-->
<div class="modal fade" id="software_count" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog  modal-lg" style="margin-top: 82px;">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true" onclick="cleardata()">&times;</button>
                <h6 class=" modal-title">
                    Software Information Report
                </h6>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-sm-12 col-md-12 col-lg-12">
                        <!--form  content-->
                        <div class="row">
                            <i id="software_up" class="pull-right glyphicon glyphicon-chevron-down" style="color:#74b1f4;font-size: 12px;"></i>
                            <div class="col-xs-10">
                                <form class="form-horizontal" method="post" id="software_form" name="software_form">
                                    <div class="form-group">
                                        <label for="nameField" class="col-xs-1 form_label">Branch/ Unit</label>
                                        <div class="col-xs-3">
                                            <select class="form-control col-sm-3 col-lg-3 col-md-3" name="Branch/Unit" id="DrpOU1"></select>
                                        </div>
                                        <label for="nameField" class="col-xs-1 form_label">System Name</label>
                                        <div class="col-xs-2" id="selectsys3">
                                            <select class="form-control col-sm-3 col-lg-3 col-md-3" name="System" id="System1">
                                                <option value="-1">Select System Name</option>
                                            </select>
                                        </div>
                                        <div class="col-xs-2" id="inputsystemname3">
                                            <input type="text" class="form-control col-sm-3 col-lg-3 col-md-3" name="add_systemname3" id="add_systemname3">
                                        </div>
                                        <div class="col-xs-1">
                                            <input type="checkbox" class="form-check-input" id="add_system_chk3" name="add_system_chk3" style="width:20px;height:25px;">
                                        </div>
                                        <label for="nameField" class="col-xs-1 form_label ">IP Address</label>
                                        <div class="col-xs-2">
                                            <input type="text" class="form-control col-sm-2 col-lg-2 col-md-2" placeholder="" name="IP1" id="IP1">
                                            @*<select class="form-control col-sm-2 col-lg-2 col-md-2" name="IP" id="IP1">
                <option value="-1">Select IP Address</option>
            </select>*@
                                        </div>
                                        <div class="pull-left col-xs-1">
                                            <input type="button" class="btn btn-primary" value="Show" id="btnshowsoftdetails">
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                        <!--End form  content-->
                    </div>
                </div>
                <!--Count software  Datatable start-->
                <div class="row">
                    <div class="col-sm-12 col-md-12 col-lg-12 " id="tblsoftinstdetails_div">
                        <table id="tblsoftinstdetails" class="table table-striped table-bordered display nowrap" width="100%"></table>
                    </div>
                </div>
                <!--Count Software Datatable end-->
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-dismiss="modal" onclick="cleardata()">Close</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div>
<!-- End Sotware Count  pop-up model box Content -->
<!-- System Count  Data pop-up model box  Content-->
<div class="modal fade" id="system_count" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog  modal-lg" style="margin-top: 82px;">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true" onclick="cleardata()">&times;</button>
                <h6 class=" modal-title">
                    Software Information Report
                </h6>
            </div>
            <div class="modal-body model_body_scroll">
                <div class="row">
                    <div class="col-sm-12 col-md-12 col-lg-12">
                        <!--form  content-->
                        <div class="row">
                            <i id="system_up" class="pull-right glyphicon glyphicon-chevron-down" style="color:#74b1f4;font-size: 12px;"></i>
                            <div class="col-xs-10">
                                <form class="form-horizontal" method="post" id="system_form" name="system_form">
                                    <div class="form-group">
                                        @*<div class="col-xs-1">
                                                <div class="checkbox">
                                                    <label><input type="checkbox" id="key_check"></label>
                                                </div>
                                            </div>*@
                                        <label for="nameField" class="col-xs-1  form_label"> <input type="checkbox" id="key_check"> Date Range  </label>
                                        <div class="col-xs-4 form_label">
                                            @*Select New Device*@
                                            <div id="key_select">
                                                <input type="text" class="form-control" id="txtkey" placeholder="DD/MM/YYYY - DD/MM/YYYY" readonly />
                                            </div>
                                            <div id="key_text">
                                                <input type="text" name="datefilter" class="form-control" placeholder="DD/MM/YYYY - DD/MM/YYYY " id="system_date">
                                            </div>@*<input type="checkbox" id="multiOptions" class="form-control">*@
                                        </div>
                                        <label for="nameField" class="col-xs-1 ">Search</label>
                                        <div class="col-xs-2">
                                            <select class="form-control col-sm-2 col-lg-2 col-md-2" name="type" id="type1">
                                                <option value="-1">Select Type</option>
                                                <option value="software">Software Name</option>
                                                <option value="version">Version </option>
                                                <option value="publisher">Publisher</option>
                                                <option value="location">Install Location</option>
                                            </select>
                                        </div>
                                        <div class="col-xs-3">
                                            <div class="input-group">
                                                <input type="search" class="form-control" placeholder="Search" id="searchvalue" name="searchvalue">
                                                <div class="input-group-btn">
                                                    <button class="btn btn-default" type="button" id="btnshowinslledsys">
                                                        <i class="glyphicon glyphicon-search"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="pull-left col-xs-1">
                                            <input type="button" class="btn btn-primary" value="Show" id="btnshowinslledsys">
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                        <!--End form  content-->
                    </div>
                </div>
                <!--Count System  Datatable start-->
                <div class="row">
                    <div class="col-sm-12 col-md-12 col-lg-12" id="tblsoftinstsysdetailshead_header">
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-12 col-md-12 col-lg-12 " id="tblsoftinstsysdetailshead_div">
                        <table id="tblsoftinstsysdetailshead" class="table table-striped table-bordered display nowrap" width="100%"></table>
                    </div>
                </div>
                <!--Count System  Datatable end-->
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-dismiss="modal" onclick="cleardata()">Close</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div>
<!-- End System Count  pop-up model box Content -->
<!-- product info pop-up model box  Content-->
<div class="modal fade" id="product_info_popup" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog  modal-lg" style="margin-top: 82px;">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" onclick="clearvalue1()" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h6 class=" modal-title">
                    Product Key Information Report
                </h6>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-sm-12 col-md-12 col-lg-12">
                        <!--form  content-->
                        <div class="row">
                            <i id="product_up" class="pull-right glyphicon glyphicon-chevron-down" style="color:#74b1f4;font-size: 12px;"></i>
                            <div class="col-xs-10">
                                <form class="form-horizontal" method="post" id="product_form" name="product_form">
                                    <div class="form-group">
                                        <label for="nameField" class="col-xs-2 form_label">Branch/ Unit</label>
                                        <div class="col-xs-4">
                                            <select class="form-control col-sm-3 col-lg-3 col-md-3" name="Branch/Unit" id="Drpouproduct1">
                                                <option value='-1'>Select Branch/ Unit</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="nameField" class="col-xs-2">Type</label>
                                        <div class="col-xs-2 col-md-1 col-lg-2 form_label" style="padding-top:2px;">
                                            <div class="radio">
                                                <label> <input type="radio" name="product" id="product_wise" onclick="javascript: Reporton(); " checked> Operating System </label>
                                            </div>
                                        </div>
                                        <div class="col-xs-2 col-md-1 col-lg-2" style="padding-top:2px;">
                                            <div class="radio">
                                                <label> <input type="radio" name="product" id="system_wise" onclick="javascript: Reporton(); "> System</label>
                                            </div>
                                        </div>
                                        <div class="col-xs-2 col-md-1 col-lg-2" style="padding-top:2px;">
                                            <div class="radio">
                                                <label> <input type="radio" name="product" id="product_key_wise" onclick="javascript: Reporton();"> Product Key</label>
                                            </div>
                                        </div>
                                    </div>
                                    <div id="product_show">
                                        <div class="form-group">
                                            <label for="nameField" class="col-xs-2">Operating System</label>
                                            <div class="col-xs-4">
                                                <div class="input-group">
                                                    <input type="search" class="form-control" placeholder="Search" id="txtproductserch" name="txtproductserch">
                                                    <div class="input-group-btn">
                                                        <button class="btn btn-default" type="button" id="btnproductshow">
                                                            <i class="glyphicon glyphicon-search"></i>
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="pull-left col-xs-1">
                                                <input type="button" class="btn btn-primary" value="Show" id="btnproductshow">
                                            </div>
                                        </div>
                                    </div>

                                    <div id="system_show" style="display:none;">
                                        <div class="form-group">
                                            <label for="nameField" class="col-xs-2 ">System Name</label>
                                            <div class="col-xs-3">
                                                <select class="form-control col-sm-3 col-lg-3 col-md-3" name="System" id="drpPsystemname">
                                                    <option value="-1">Select System Name</option>

                                                </select>
                                            </div>
                                            <label for="nameField" class="col-xs-1 form_label ">IP Address</label>
                                            <div class="col-xs-2">
                                                <input type="text" class="form-control col-sm-2 col-lg-2 col-md-2" placeholder="" name="ip" id="drpsystemIP">
                                                @*<select class="form-control col-sm-2 col-lg-2 col-md-2" name="ip" id="drpsystemIP">
                                                        <option value="-1">Select IP Address</option>

                                                    </select>*@
                                            </div>
                                            <div class="pull-left col-xs-1">
                                                <input type="button" class="btn btn-primary" value="Show" id="btnsystemshow">
                                            </div>

                                        </div>
                                    </div>

                                    <div id="product_key_show" style="display:none;">
                                        <div class="form-group">
                                            <label for="nameField" class="col-xs-2">System Name</label>
                                            <div class="col-xs-3">
                                                <select class="form-control col-sm-3 col-lg-3 col-md-3" id="drpkeysystemname">
                                                    <option value="-1">Select System Name</option>

                                                </select>
                                            </div>
                                            <label for="nameField" class="col-xs-1 form_label">IP Address</label>
                                            <div class="col-xs-2">
                                                <input type="text" class="form-control col-sm-2 col-lg-2 col-md-2" placeholder="" name="drpkeyIP" id="drpkeyIP">
                                                @*<select class="form-control col-sm-2 col-lg-2 col-md-2" id="drpkeyIP">
                                                        <option value="-1">Select IP Address</option>

                                                    </select>*@
                                            </div>
                                            <div class="pull-left col-xs-1">
                                                <input type="button" class="btn btn-primary" value="Show" id="btnkeyshow">
                                            </div>

                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                        <!--End form  content-->
                    </div>
                </div>

                <!-- product info  Datatable start-->

                <div id="product_detail">
                    <div class="row">
                        <div class="col-sm-12 col-md-12 col-lg-12 " id="div_product_detail_div">
                            <table id="div_product_detail" class="table table-striped table-bordered display nowrap" width="100%"></table>
                        </div>
                    </div>
                </div>

                <div id="system_detail" style="display:none">
                    <div class="row">
                        <div class="col-sm-12 col-md-12 col-lg-12 " id="div_system_detail_div">
                            <table id="div_system_detail" class="table table-striped table-bordered display nowrap" width="100%"></table>
                        </div>
                    </div>
                </div>

                <div id="product_key_detail" style="display:none">
                    <div class="row">
                        <div class="col-sm-12 col-md-12 col-lg-12 " id="div_pkeywise_div">
                            <table id="div_pkeywise" class="table table-striped table-bordered display nowrap" width="100%"></table>
                        </div>
                    </div>
                </div>


                <!-- product info  Datatable end-->
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" onclick="clearvalue1()" data-dismiss="modal">Close</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div>
<!-- End  product info  pop-up model box Content -->
<!-- product Count  Data pop-up model box  Content-->
<div class="modal fade" id="product_count" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog  modal-lg" style="margin-top: 82px;">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true" onclick="clearvalue()">&times;</button>
                <h6 class=" modal-title">
                    Product Information Report
                </h6>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-sm-12 col-md-12 col-lg-12">

                        <!--form  content-->
                        <div class="row">
                            <i id="product_count_up" class="pull-right glyphicon glyphicon-chevron-down" style="color:#74b1f4;font-size: 12px;"></i>
                            <div class="col-xs-10">
                                <form class="form-horizontal" method="post" id="product_count_form" name="product_count_form">
                                    <div class="form-group">
                                        <label for="nameField" class="col-xs-1 form_label">Branch/ Unit</label>
                                        <div class="col-xs-4">
                                            <select class="form-control col-sm-3 col-lg-3 col-md-3" name="Branch/Unit" id="Drpouproductcount">
                                                <option value='-1'>Select Branch/ Unit</option>
                                            </select>
                                        </div>
                                        <label for="nameField" class="col-xs-1 form_label">System Name</label>
                                        <div class="col-xs-3">
                                            <select class="form-control col-sm-3 col-lg-3 col-md-3" name="System" id="drpsystemcnt">
                                                <option value='-1'>Select System Name</option>
                                            </select>
                                        </div>
                                        <label for="nameField" class="col-xs-1 form_label">IP Address</label>
                                        <div class="col-xs-2">
                                            <input type="text" class="form-control col-sm-2 col-lg-2 col-md-2" placeholder="" name="drpipcnt" id="drpipcnt">
                                            @*<select class="form-control col-sm-2 col-lg-2 col-md-2" name="IP" id="drpipcnt">
                                                    <option value='-1'>Select IP Address</option>
                                                </select>*@
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="nameField" class="col-xs-1">Search</label>
                                        <div class="col-xs-2">
                                            <select class="form-control col-sm-2 col-lg-2 col-md-2" name="type" id="PSearchtype">
                                                <option value="-1">Select Type</option>
                                                <option value="dk.cd_key">Product Key</option>
                                                @*<option value="dk.product_id"> Product ID</option>*@
                                            </select>
                                        </div>
                                        <div class="col-xs-3">
                                            <div class="input-group">
                                                <input type="search" class="form-control" placeholder="Search" id="txtserchvalue" name="txtserchvalue">
                                                <div class="input-group-btn">
                                                    <button class="btn btn-default" type="button" id="btnpcntshow">
                                                        <i class="glyphicon glyphicon-search"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="pull-left col-xs-1">
                                            <input type="button" class="btn btn-primary" value="Show" id="btnpcntshow">
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                        <!--End form  content-->
                    </div>
                </div>

                <!--Count product   Datatable start-->
                <div class="row">
                    <div class="col-sm-12 col-md-12 col-lg-12 " id="div_productkey_header_div">
                        <table id="div_productkey_header" class="table table-striped table-bordered display nowrap" width="100%"></table>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-12 col-md-12 col-lg-12 " id="div_productkeycnt_div">
                        <table id="div_productkeycnt" class="table table-striped table-bordered display nowrap" width="100%"></table>
                    </div>
                </div>

                <!--Count product Datatable end-->
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-dismiss="modal" onclick="clearvalue()">Close</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div>
<!-- End product Count  pop-up model box Content -->
<!-- product_system_count   Data pop-up model box  Content-->
<div class="modal fade" id="product_system_count" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog  modal-lg" style="margin-top: 82px;">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true" onclick="clearvalue()">&times;</button>
                <h6 class=" modal-title">
                    Product Information Report
                </h6>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-sm-12 col-md-12 col-lg-12">
                        <!--form  content-->
                        <div class="row">
                            <i id="product_system_count_up" class="pull-right glyphicon glyphicon-chevron-down" style="color:#74b1f4;font-size: 12px;"></i>
                            <div class="col-xs-10">
                                <form class="form-horizontal" method="post" id="product_system_count_form" name="product_system_count_form">

                                    <div class="form-group">
                                        <label for="nameField" class="col-xs-1 ">Search</label>
                                        <div class="col-xs-2">
                                            <select class="form-control col-sm-2 col-lg-2 col-md-2" name="type" id="sdtype">
                                                <option value="-1">Select Type</option>
                                                <option value="dk.product">Product Name</option>
                                                <option value="dk.cd_key">Product Key</option>
                                                <option value="dk.product_id">Product ID</option>
                                                @*<option value="dk.data1">Product Name</option>
                                                    <option value="dk.product_id">Product Key</option>*@
                                                @*<option value="dk.product_id">Product ID</option>*@
                                            </select>
                                        </div>
                                        <div class="col-xs-3">
                                            <div class="input-group">
                                                <input type="search" class="form-control" placeholder="Search" id="sdvalue" name="sdvalue">
                                                <div class="input-group-btn">
                                                    <button class="btn btn-default" type="button" id="btnsdshow">
                                                        <i class="glyphicon glyphicon-search"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="pull-left col-xs-1">
                                            <input type="button" class="btn btn-primary" value="Show" id="btnsdshow">
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                        <!--End form  content-->
                    </div>
                </div>

                <!--Count product system   Datatable start-->
                <div class="row">
                    <div class="col-sm-12 col-md-12 col-lg-12 ">
                        <div class="table-responsive" id="divsystemdetails123">

                        </div>
                    </div>
                    <div class="col-sm-12 col-md-12 col-lg-12 " id="divstystemdetails2_div">
                        <table id="divstystemdetails2" class="table table-striped table-bordered display nowrap" width="100%"></table>
                    </div>
                </div>

                <!--Count product system  Datatable end-->
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-dismiss="modal" onclick="clearvalue()">Close</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div>
<!-- End product_system_count  pop-up model box Content -->
<!-- product_key_count   Data pop-up model box  Content-->
<div class="modal fade" id="product_key_count" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog  modal-lg" style="margin-top: 82px;">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" onclick="clearvalue()" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h6 class=" modal-title">
                    Product Information Report
                </h6>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-sm-12 col-md-12 col-lg-12">
                        <!--form  content-->
                        <div class="row">
                            <i id="product_key_count_up" class="pull-right glyphicon glyphicon-chevron-down" style="color:#74b1f4;font-size: 12px;"></i>
                            <div class="col-xs-10">
                                <form class="form-horizontal" method="post" id="product_key_count_form" name="product_key_count_form">
                                    <div class="form-group">
                                        <label for="nameField" class="col-xs-1 form_label">Branch/ Unit</label>
                                        <div class="col-xs-4">
                                            <select class="form-control col-sm-3 col-lg-3 col-md-3" name="Branch/Unit" id="drpkou">
                                                <option value="-1">Select Branch/Unit</option>
                                            </select>
                                        </div>
                                        <label for="nameField" class="col-xs-1 form_label">System Name</label>
                                        <div class="col-xs-2">
                                            <select class="form-control col-sm-3 col-lg-3 col-md-3" name="System" id="drpksystem">
                                                <option value="-1">Select System Name</option>
                                            </select>
                                        </div>
                                        <label for="nameField" class="col-xs-1 form_label">IP Address</label>
                                        <div class="col-xs-2">
                                            <input type="text" class="form-control col-sm-2 col-lg-2 col-md-2" placeholder="" name="drpkip" id="drpkip">
                                            @*<select class="form-control col-sm-2 col-lg-2 col-md-2" name="IP" id="drpkip">
                                                    <option value="-1">Select IP Address</option>
                                                </select>*@
                                        </div>
                                        <div class="pull-left col-xs-1">
                                            <input type="button" class="btn btn-primary" value="Show" id="btnkshowreport">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                    </div>
                                </form>
                            </div>
                        </div>
                        <!--End form  content-->
                    </div>
                </div>
                <!--Count product_key_count   Datatable start-->
                <div class="row">
                    <div class="col-sm-12 col-md-12 col-lg-12 " id="divkeyinfo_header_div">
                        <table id="divkeyinfo_header" class="table table-striped table-bordered display nowrap" width="100%"></table>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-12 col-md-12 col-lg-12 " id="divkeyinfo_div">
                        <table id="divkeyinfo" class="table table-striped table-bordered display nowrap" width="100%"></table>
                    </div>
                </div>

                <!--Count product_key_count  Datatable end-->
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" onclick="clearvalue()" data-dismiss="modal">Close</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div>
<!-- End product_key_count  pop-up model box Content -->
<!-- product_generate_report   Data pop-up model box  Content-->
<div class="modal fade" id="product_generate_report" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog  modal-lg" style="margin-top: 82px;">
        <div class="modal-content">
            <div class="modal-header">
                @*<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>*@
                <button type="button" class="close" data-dismiss="modal" onclick="clearvalue()">&times;</button>
                <h6 class=" modal-title">
                    Product Information Report
                </h6>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-sm-12 col-md-12 col-lg-12">
                        <!--form  content-->
                        <div class="row">
                            <i id="product_generate_up" class="pull-right glyphicon glyphicon-chevron-down" style="color:#74b1f4;font-size: 12px;"></i>
                            <div class="col-xs-10">
                                <form class="form-horizontal" method="post" id="product_generate_form" name="product_generate_form">
                                    <div class="form-group">
                                        <label for="nameField" class="col-xs-1 form_label">Branch/ Unit</label>
                                        <div class="col-xs-4">
                                            <select class="form-control col-sm-3 col-lg-3 col-md-3" name="Branch/Unit" id="drpgebnerateou">
                                                <option value="-1">Select Branch/ Unit</option>
                                            </select>
                                        </div>
                                        <label for="nameField" class="col-xs-1 form_label">System Name</label>
                                        <div class="col-xs-3">
                                            <select class="form-control col-sm-3 col-lg-3 col-md-3" name="System" id="drpgeneratesystem">
                                                <option value="-1">Select System Name</option>

                                            </select>
                                        </div>
                                        <label for="nameField" class="col-xs-1 form_label ">IP Address</label>
                                        <div class="col-xs-2">
                                            <input type="text" class="form-control col-sm-2 col-lg-2 col-md-2" placeholder="" name="drpgenerateip" id="drpgenerateip">
                                            @*<select class="form-control col-sm-2 col-lg-2 col-md-2" name="IP" id="drpgenerateip">
                                                    <option value="-1">Select IP Address</option>
                                                </select>*@
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="nameField" class="col-xs-1 ">Search</label>
                                        <div class="col-xs-2">
                                            <select class="form-control col-sm-2 col-lg-2 col-md-2" name="type" id="generatesearachserchtype">
                                                <option value="-1">Select Type</option>
                                                @*<option value="dk.product">Product Name</option>
                                                    <option value="dk.cd_key">Product Key</option>
                                                    <option value="dk.product_id">Product ID</option>*@
                                                <option value="T.data1">OS Name</option>
                                                <option value="ns.data1">Product Key</option>
                                                @*<option value="dk.product_id">Product ID</option>*@
                                            </select>
                                        </div>
                                        <div class="col-xs-3">
                                            <div class="input-group">
                                                <input type="search" class="form-control" placeholder="Search" id="txtgeneratesearach" name="txtgeneratesearach">
                                                <div class="input-group-btn">
                                                    <button class="btn btn-default" type="button" id="btngenerateshow">
                                                        <i class="glyphicon glyphicon-search"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="pull-left col-xs-1">
                                            <input type="button" class="btn btn-primary" value="Show" id="btngenerateshow">
                                        </div>
                                    </div>

                                </form>

                            </div>
                        </div>
                        <!--End form  content-->
                    </div>
                </div>
                <!--product_generate_report   Datatable start-->
                <div class="row">
                    <div class="col-sm-12 col-md-12 col-lg-12 " id="div_generate_report_div">
                        <table id="div_generate_report" class="table table-striped table-bordered display nowrap" width="100%"></table>
                    </div>
                </div>
                <!--product_generate_report  Datatable end-->
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-dismiss="modal" onclick="clearvalue()">Close</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div>
<!-- End product_generate_report  pop-up model box Content -->
<script>
    $(document).ready(function () {
        validateSingleForm("#frm_softinform_report");
        validateSingleForm("#system_form");
        validateSingleForm("#software_form");
        validateSingleForm("#product_form");
        validateSingleForm("#product_count_form");
        validateSingleForm("#product_system_count_form");
        validateSingleForm("#product_key_count_form");
        validateSingleForm("#product_generate_form");

    });
</script>
<script>
    function productKeypopup() {

		var url = '@Url.Content("~/csat_report/GetOU/")';
        $.ajax({
        type: "POST",
        url: url,
        success: function (data) {
        // debugger;
         var SetData = $('#Drpouproduct1');
        jQuery('#Drpouproduct1').html('');

        var oudata = "<option value='-1'>Select Branch/ Unit</option>";
        for (var i = 0; i < data.ou.length; i++) {
            oudata += "<option value='" + data.ou[i].ouid + "'>" + data.ou[i].ouname + "</option>";
        }
        SetData.append(oudata);
        }
        });
        productkeyshow();
       $('#product_info_popup').modal('show');
    }

	 function Reporton() {

        if (document.getElementById('product_wise').checked) {
            document.getElementById('product_detail').style.display = 'block';
            document.getElementById('system_detail').style.display = 'none';
            document.getElementById('product_key_detail').style.display = 'none';
			 document.getElementById('product_show').style.display = 'block';
            document.getElementById('system_show').style.display = 'none';
            document.getElementById('product_key_show').style.display = 'none';
			productname="";
            system="";
            Pkey = "";
        }

        if (document.getElementById('system_wise').checked) {
            document.getElementById('system_detail').style.display = 'block';
            document.getElementById('product_detail').style.display = 'none';
            document.getElementById('product_key_detail').style.display = 'none';
			 document.getElementById('system_show').style.display = 'block';
            document.getElementById('product_show').style.display = 'none';
            document.getElementById('product_key_show').style.display = 'none';
			productname="";
            system="";
            Pkey = "";
        }
        if (document.getElementById('product_key_wise').checked) {
            document.getElementById('product_key_detail').style.display = 'block';
            document.getElementById('product_detail').style.display = 'none';
            document.getElementById('system_detail').style.display = 'none';
			 document.getElementById('product_key_show').style.display = 'block';
            document.getElementById('product_show').style.display = 'none';
            document.getElementById('system_show').style.display = 'none';
			productname="";
            system="";
            Pkey = "";
        }
    }
	var ouidvalue="";
    $("#Drpouproduct1").change(function () {
        ouidvalue = this.value;
    });
	//$('#btnproductsearch').on('click',function()
	//{
	//  productname="";
	//  //debugger;
	//   var searchvalue=document.getElementById('txtproductserch').value;
	//  if(searchvalue !='')
	//      productkeyshow();
	// else
 //       alert('Please enter value in search.');
	//});

	$('#btnproductshow').on('click',function()
    {
        var $valid = $('#product_form').valid();
        if (!$valid) {
            $validatorform.focusInvalid();
            return false;
        } else {
            // debugger;
            productname = "";
            productkeyshow();
        }
    });
    var productname = "";
	function productkeyshow()
	{

	  if(ouidvalue == '')
	      ouidvalue = document.getElementById('Drpouproduct1').value;
	     var searchvalue=document.getElementById('txtproductserch').value;
	  var url = '@Url.Content("~/csat_report/get_productkey_data?ouid=")'+ ouidvalue + '&searching=' + searchvalue;
        $.ajax({
        type: "POST",
        url: url,
            success: function (data) {
                //debugger;
                var software_divclear = document.getElementById('div_product_detail_div');
                software_divclear.innerHTML = '&nbsp;';
                $('#div_product_detail_div').append("<table id='div_product_detail' class='table table-striped table-bordered' width='100%'></table><div class='pull-left col-xs-1' style='margin-top:-14px;'><input type='button' class='btn btn-primary' value='Details Report' data-toggle='modal' id='btnproductGenerate' style='display:none'></div>");
                otable = document.getElementById('div_product_detail');
                var data1 = [];
                for (var i = 0; i < data.productkeywise.length; i++) {
                    var productkey = "<a href='' data-toggle='modal' onclick=bindproductcount('" + encodeURIComponent(data.productkeywise[i].data1) + "'," + data.productkeywise[i].cnt + ")>" + data.productkeywise[i].cnt +"</a>";
                    data1.push([data.productkeywise[i].data1, data.productkeywise[i].data1, productkey]);
                }
                var otable = $("#div_product_detail").DataTable({
                    data: data1, scrollX: !0, searching: !1,
                    'columnDefs': [{ 'targets': 0, 'checkboxes': { 'selectRow': true } }, { orderable: false, targets: 1 }], 'select': { 'style': 'multi' },
                    columns: [{ title: "", width: '10px' }, { title: "Operating System", width: '90px' }, { title: "Total Count", width: '90px' }]
                });
                $(".table").css({ "width": "100%" });
                $(".dataTables_scrollHeadInner ").css({ "width": "100%" });
                $("#btnproductGenerate").show();
                $('#btnproductGenerate').on('click', function (e) {
                    var form = this;
                    productname = "";
                    var rows_selected = otable.column(0).checkboxes.selected();
                    $.each(rows_selected, function (index) {
                        // debugger;
                        for (var i = 0; i < rows_selected.length; i++) {
                            productname += "," + rows_selected[i];
                        }
                        productcount();
                        return false;
                    });
                });
            }

        });

    }
    function productcount() {
     // debugger;
        if (productname == "") {
            alert('You must choose any Opearting System Name.');
        }
     else {
           bindoudata("drpgebnerateou");
           generate_report("Product", productname);
           $('#product_generate_report').modal('show');
         }
    }

     var system = "";
	$("#btnsystemshow").on("click",function()
	{
        system = "";
        varsipvalue = document.getElementById("drpsystemIP").value;
	  //  debugger;
	  var url = '@Url.Content("~/csat_report/get_productkey_system_data?ouid=")'+varsouidvalue+'&ip='+varsipvalue+'&system='+varssystemvalue;
        $.ajax({
        type: "POST",
        url: url,
            success: function (data) {
               // debugger;
                var software_divclear = document.getElementById('div_system_detail_div');
                software_divclear.innerHTML = '&nbsp;';
                $('#div_system_detail_div').append("<table id='div_system_detail' class='table table-striped table-bordered' width='100%'></table><div class='pull-left col-xs-1' style='margin-top:-14px;'><input type='button' class='btn btn-primary' value='Details Report' data-toggle='modal' id='btnsystemGenerate' style='display:none'></div>");
                otable = document.getElementById('div_system_detail');
                var data1 = [];
                for (var i = 0; i < data.productkeysystemdata.length; i++) {
                    var productkey1 = "<a href='' data-toggle='modal' onclick=systemcountpopup('" + data.productkeysystemdata[i].device_name + "','" + data.productkeysystemdata[i].ip + "'," + data.productkeysystemdata[i].device_id + ")>" + data.productkeysystemdata[i].cnt +"</a>";
                    data1.push([data.productkeysystemdata[i].device_id, data.productkeysystemdata[i].device_name, data.productkeysystemdata[i].ip, productkey1]);
                }
                var otable = $("#div_system_detail").DataTable({
                    data: data1, scrollX: !0, searching: !1,
                    'columnDefs': [{ 'targets': 0, 'checkboxes': { 'selectRow': true } }, { orderable: false, targets: 1 }], 'select': { 'style': 'multi' },
                    columns: [{ title: "", width: '10px' }, { title: "System Name", width: '90px' }, { title: "IP Address", width: '90px' }, { title: "Total Count", width: '90px' }]
                });
                $(".table").css({ "width": "100%" });
                $(".dataTables_scrollHeadInner ").css({ "width": "100%" });
                $("#btnsystemGenerate").show();
                $('#btnsystemGenerate').on('click', function (e) {
                    var form = this;
                    system = "";
                    var rows_selected = otable.column(0).checkboxes.selected();
                    $.each(rows_selected, function (index) {
                        //debugger;
                        for (var i = 0; i < rows_selected.length; i++) {
                            system += "," + rows_selected[i];
                        }
                        systemcount();
                        return false;
                    });
                });
        }

        });
	});

    function systemcount() {
         //debugger;
        if (system == "") {
            alert('You must choose any system.');
        }
        else {

            bindoudata("drpgebnerateou");
            generate_report("System", system);
            $('#product_generate_report').modal('show');
        }

    }
    var Pkey = "";
    var potable
	$("#btnkeyshow").on("click",function()
    {
        var $valid = $('#product_form').valid();
        if (!$valid) {
            $validatorform.focusInvalid();
            return false;
        } else {
            Pkey = "";
            varkipvalue = document.getElementById("drpkeyIP").value;
            // debugger;
            var url = '@Url.Content("~/csat_report/get_productkey_key_data?ouid=")' + varsouidvalue + '&ip=' + varkipvalue + '&system=' + varksystemvalue;
            $.ajax({
                type: "POST",
                url: url,
                success: function (data) {
                    var software_divclear = document.getElementById('div_pkeywise_div');
                    software_divclear.innerHTML = '&nbsp;';
                    $('#div_pkeywise_div').append("<table id='div_pkeywise' class='table table-striped table-bordered' width='100%'></table><div class='pull-left col-xs-1' style='margin-top:-14px;'><input type='button' class='btn btn-primary' value='Details Report' data-toggle='modal' id='btnkeyGenerate' onclick='btnproductkeyge()' style='display:none'></div>");
                    potable = document.getElementById('div_pkeywise');
                    var data1 = [];
                    for (var i = 0; i < data.pkeydata.length; i++) {
                        var productkey2 = "<a href='' data-toggle='modal' onclick=keycountpopup('" + data.pkeydata[i].data1 + "'," + data.pkeydata[i].cnt + ")>" + data.pkeydata[i].cnt + "</a>";
                        data1.push([data.pkeydata[i].data1, data.pkeydata[i].data1, productkey2]);
                    }
                    potable = $("#div_pkeywise").DataTable({
                        data: data1, scrollX: !0, searching: !1,
                        'columnDefs': [{ 'targets': 0, 'checkboxes': { 'selectRow': true } }, { orderable: false, targets: 1 }], 'select': { 'style': 'multi' },
                        columns: [{ title: "", width: '10px' }, { title: "Product key", width: '90px' }, { title: "Total Count", width: '90px' }]
                    });
                    $(".table").css({ "width": "100%" });
                    $(".dataTables_scrollHeadInner ").css({ "width": "100%" });
                    $("#btnkeyGenerate").show();
                }
            });
        }
    });
    //$('#btnkeyGenerate').on('click', function (e) {

    //});
    function btnproductkeyge() {
        debugger;
        var form = this;
        Pkey = "";
        var rows_selected = potable.column(0).checkboxes.selected();
        $.each(rows_selected, function (index) {
            //debugger;
            for (var i = 0; i < rows_selected.length; i++) {
                Pkey += "," + rows_selected[i];
            }
            keycount();
            return false;
        });
    }
    function keycount() {
        //debugger;
        if (Pkey == "") {
            alert('You must choose any product key.');
        }
        else {
            bindoudata("drpgebnerateou");
            generate_report("Key", Pkey);
            $('#product_generate_report').modal('show');
        }
    }
	$("#drpgebnerateou").change(function () {
	 //  debugger;
        ouidvalue = this.value;
        var url = '@Url.Content("~/csat_report/Get_syatemname_ip?ouid=")' + this.value;
        $.ajax({
        type: "POST",
        url: url,
        success: function (data) {
        // debugger;
        var SetDatadevice = $('#drpgeneratesystem');
        //var SetDataip = $('#drpgenerateip');

        jQuery('#drpgeneratesystem').html('');
        //jQuery('#drpgenerateip').html('');

        var devicedata = "<option value='-1'>Select System Name</option>";
        //var ipdata = "<option value='-1' >Select IP Address</option>";

        for (var i = 0; i < data.systemip.length; i++) {
           devicedata+="<option value='"+ data.systemip[i].device_name +"'>"+ data.systemip[i].device_name +"</option>";
           //ipdata+="<option value='"+ data.systemip[i].ip +"'>"+ data.systemip[i].ip +"</option>";
            }

            SetDatadevice.append(devicedata);
            //SetDataip.append(ipdata);

        }

        });

    });

	var vargouidvalue="";
    var vargsystemvalue="";
    $("#drpgebnerateou").change(function () {
        vargouidvalue = this.value;
    });

    $("#drpgeneratesystem").change(function () {
        vargsystemvalue = this.value;

    });
    //$("#drpgenerateip").change(function () {
    //    vargipvalue = this.value;

    //});
	$("#btngenerateshow").on("click",function(){
	//debugger;
        var $valid = $('#product_generate_form').valid();
        if (!$valid) {
            $validatorform.focusInvalid();
            return false;
        } else {
            if (productname != "")
                generate_report("Product", productname);
            else if (system != "")
                generate_report("System", system);
            else if (Pkey != "")
                generate_report("Key", Pkey);
        }
	});
	//$("#btngenerateserach").on("click",function(){
	// // generate_report("Product",productname);
	//    if(productname !="" )
	//      generate_report("Product",productname);
	//  else if(system !="" )
	//     generate_report("System",system);
	//  else if(Pkey !="" )
	//     generate_report("Key",Pkey);
	//});
	function generate_report(Type,value)
    {
       // debugger;
        var vargipvalue = document.getElementById('drpgenerateip').value;
		 var searchtype=document.getElementById('generatesearachserchtype').value;
	     var searchvalue=document.getElementById('txtgeneratesearach').value;
	  var url = '@Url.Content("~/csat_report/get_productkey_Generate_data?ouid=")'+vargouidvalue+'&stype='+searchtype+'&searching='+searchvalue+'&generatetype='+Type+'&pname='+value+'&ip='+vargipvalue+'&system='+vargsystemvalue;
        $.ajax({
        type: "POST",
        url: url,
            success: function (data) {
                var dataclear = document.getElementById('div_generate_report_div');
                dataclear.innerHTML = '&nbsp;';
                $('#div_generate_report_div').append("<table id='div_generate_report' class='table table-striped table-bordered' width='100%'></table>");
                otable = document.getElementById('div_generate_report');
                var data1 = [];
                for (var i = 0; i < data.productkeygenerate.length; i++) {
                    data1.push([data.productkeygenerate[i].ou_longname, data.productkeygenerate[i].device_name, data.productkeygenerate[i].ip, data.productkeygenerate[i].data1, data.productkeygenerate[i].productkey]);
                }
                var otable = $("#div_generate_report").DataTable({
                    data: data1, scrollX: !0, searching: !1, dom: "<'top'lB>rt<'bottom'ip><'clear'>", buttons: ["colvis", { text: "PDF", extend: "pdfHtml5", download: "open", filename: "Product Key Information_" + today, orientation: "portrait", pageSize: "A4", exportOptions: { columns: ":visible", search: "applied", order: "applied" }, customize: function (t) { t.content.splice(0, 1); var e = new Date, n = e.getDate() + "-" + (e.getMonth() + 1) + "-" + e.getFullYear(); t.pageMargins = [20, 60, 20, 30], t.defaultStyle.fontSize = 7, t.styles.tableHeader.fontSize = 7, t.header = function () { return { columns: [{ margin: [0, -5, 30, 15], alignment: "left", width: 100, image: "data:image/png;base64," + pdflogo }, { margin: [-10, 10, 10, 0], alignment: "center", width: 410, text: "Product Key Information Report", fontSize: 12 }, { alignment: "right", fontSize: 14, text: "" }], margin: 20 } }, t.footer = function (t, e) { return { columns: [{ alignment: "left", text: ["Created on: ", { text: n.toString() }] }, { alignment: "right", text: ["page ", { text: t.toString() }, " of ", { text: e.toString() }] }], margin: 20 } }; var a = { hLineWidth: function (t) { return .5 }, vLineWidth: function (t) { return .5 }, hLineColor: function (t) { return "#aaa" }, vLineColor: function (t) { return "#aaa" }, paddingLeft: function (t) { return 4 }, paddingRight: function (t) { return 4 } }; t.content[0].layout = a } }, 'excel'],
                    columns: [{ title: "Branch/ Unit" }, { title: "System Name" }, { title: "IP Address" }, { title: "OS name" }, { title: "Product Key" }]
                });
                $(".table").css({ "width": "100%" });
                $(".dataTables_scrollHeadInner ").css({ "width": "100%" });
		}
		});

	}
	var varpname="";
	var varcnt="";
	function bindproductcount(product,cnt)
	{
	   document.getElementById('Drpouproductcount').value='-1';
	   document.getElementById('drpsystemcnt').value='-1';
	   document.getElementById('drpipcnt').value='';

	   	varouidvalue="";
        varsystemvalue="";
        varipvalue = "";


	    varpname=decodeURI(product);
	    varcnt=cnt;
		bindoudata("Drpouproductcount");
		bindproductcountData(decodeURI(product),cnt);
	     $('#product_count').modal('show');
	}

	function bindoudata(id) {
	//debugger;
		var url = '@Url.Content("~/csat_report/GetOU/")';
        $.ajax({
        type: "POST",
        url: url,
        success: function (data) {
        // debugger;
		 var varid= '#'+id;
         var SetData = $(varid);
        jQuery(varid).html('');

        var oudata = "<option value='-1'>Select Branch/ Unit</option>";
        for (var i = 0; i < data.ou.length; i++) {
            oudata += "<option value='" + data.ou[i].ouid + "'>" + data.ou[i].ouname + "</option>";
        }
        SetData.append(oudata);

        }

        });


    }

	$("#Drpouproductcount").change(function () {

        ouidvalue = this.value;
        var url = '@Url.Content("~/csat_report/Get_syatemname_ip?ouid=")' + this.value;
        $.ajax({
        type: "POST",
        url: url,
        success: function (data) {
        // debugger;
        var SetDatadevice = $('#drpsystemcnt');
        //var SetDataip = $('#drpipcnt');

        jQuery('#drpsystemcnt').html('');
        //jQuery('#drpipcnt').html('');

        var devicedata = "<option value='-1'>Select System Name</option>";
        //var ipdata = "<option value='-1' >Select IP Address</option>";

        for (var i = 0; i < data.systemip.length; i++) {
           devicedata+="<option value='"+ data.systemip[i].device_name +"'>"+ data.systemip[i].device_name +"</option>";
           //ipdata+="<option value='"+ data.systemip[i].ip +"'>"+ data.systemip[i].ip +"</option>";
            }

            SetDatadevice.append(devicedata);
            //SetDataip.append(ipdata);

        }

        });

    });

	var varouidvalue="";
    var varsystemvalue="";
    var varipvalue = "";
    $("#Drpouproductcount").change(function () {
        varouidvalue = this.value;
    });

    $("#drpsystemcnt").change(function () {
        varsystemvalue = this.value;

    });
    //$("#drpipcnt").change(function () {
    //    varipvalue = this.value;

    //});
	function bindproductcountData(product,cnt)
    {
        var varipvalue = document.getElementById('drpipcnt').value;
		 var searchtype=document.getElementById('PSearchtype').value;
		  if('-1'==searchtype)
		      searchtype="";
	     var searchvalue=document.getElementById('txtserchvalue').value;
	  var url = '@Url.Content("~/csat_report/get_productkey_cnt_data?ouid=")'+varouidvalue+'&stype='+searchtype+'&searching='+searchvalue+'&pname='+product+'&ip='+varipvalue+'&system='+varsystemvalue;
        $.ajax({
        type: "POST",
        url: url,
            success: function (data) {
                document.getElementById('txtserchvalue').value = '';
                var dataclear = document.getElementById('div_productkeycnt_div');
                dataclear.innerHTML = '&nbsp;';
                $('#div_productkeycnt_div').append("<table id='div_productkeycnt' class='table table-striped table-bordered' width='100%'></table>");
                otable = document.getElementById('div_productkeycnt');
                var data1 = [];
                for (var i = 0; i < data.productkeywise.length; i++) {
                    data1.push([data.productkeywise[i].ou_longname, data.productkeywise[i].device_name, data.productkeywise[i].ip, data.productkeywise[i].productkey]);
                }
                var otable = $("#div_productkeycnt").DataTable({
                    data: data1, scrollX: !0, searching: !1, dom: "<'top'lB>rt<'bottom'ip><'clear'>", buttons: ["colvis", { text: "PDF", extend: "pdfHtml5", download: "open", filename: "Product Information_" + today, orientation: "portrait", pageSize: "A4", exportOptions: { columns: ":visible", search: "applied", order: "applied" }, customize: function (t) { t.content.splice(0, 1); var e = new Date, n = e.getDate() + "-" + (e.getMonth() + 1) + "-" + e.getFullYear(); t.pageMargins = [20, 60, 20, 30], t.defaultStyle.fontSize = 7, t.styles.tableHeader.fontSize = 7, t.header = function () { return { columns: [{ margin: [0, -5, 30, 15], alignment: "left", width: 100, image: "data:image/png;base64," + pdflogo }, { margin: [-10, 10, 10, 0], alignment: "center", width: 410, text: "Product Information Report", fontSize: 12 }, { alignment: "right", fontSize: 14, text: "" }], margin: 20 } }, t.footer = function (t, e) { return { columns: [{ alignment: "left", text: ["Created on: ", { text: n.toString() }] }, { alignment: "right", text: ["page ", { text: t.toString() }, " of ", { text: e.toString() }] }], margin: 20 } }; var a = { hLineWidth: function (t) { return .5 }, vLineWidth: function (t) { return .5 }, hLineColor: function (t) { return "#aaa" }, vLineColor: function (t) { return "#aaa" }, paddingLeft: function (t) { return 4 }, paddingRight: function (t) { return 4 } }; t.content[0].layout = a } }, 'excel'],
                    columns: [{ title: "Branch/ Unit" }, { title: "System Name" }, { title: "IP Address" }, { title: "Product Key" }]
                });
                $(".table").css({ "width": "100%" });
                $(".dataTables_scrollHeadInner ").css({ "width": "100%" });
                var SetData = $('#div_productkey_header_div');
                jQuery('#div_productkey_header_div').html('');
                var rawdata="";
                var headdata = "<table class='table table-striped table-bordered' id='div_productkey_header' style='width:100%;margin-bottom: -15px;'><caption style='padding:5px;'><div style='float:left;font-weight:bold;color:#3a72a2;' id='product_name'>Operating System : "+ product +" </div>"+
		               "<div class='pull-right' id='product_count1'><b> Total : </b>"+ cnt+"</div></caption>";
                   SetData.append(headdata+"</table>");
		}
		});

	}

	$("#btnpcntshow").on("click",function()	{

        var $valid = $('#product_count_form').valid();
        if (!$valid) {
            $validatorform.focusInvalid();
            return false;
        } else {
            bindproductcountData(varpname, varcnt);
        }
	});

	//$("#btnpcntserch").on("click",function()
	//{
	//   bindproductcountData(varpname,varcnt);
	//});

	@* System wise code start *@

	$("#Drpouproduct1").change(function () {

        ouidvalue = this.value;
        var url = '@Url.Content("~/csat_report/Get_syatemname_ip?ouid=")' + this.value;
        $.ajax({
        type: "POST",
        url: url,
        success: function (data) {
       // debugger;
        var SetDatadevice = $('#drpPsystemname');
        //var SetDataip = $('#drpsystemIP');

        jQuery('#drpPsystemname').html('');
        //jQuery('#drpsystemIP').html('');

	     var SetDatadevice1 = $('#drpkeysystemname');
        //var SetDataip1 = $('#drpkeyIP');

        jQuery('#drpkeysystemname').html('');
        //jQuery('#drpkeyIP').html('');

        var devicedata = "<option value='-1'>Select System Name</option>";
        //var ipdata = "<option value='-1' >Select IP Address</option>";

		  var devicedata1 = "<option value='-1'>Select System Name</option>";
        //var ipdata1 = "<option value='-1' >Select IP Address</option>";

        for (var i = 0; i < data.systemip.length; i++) {
           devicedata+="<option value='"+ data.systemip[i].device_name +"'>"+ data.systemip[i].device_name +"</option>";
           //ipdata+="<option value='"+ data.systemip[i].ip +"'>"+ data.systemip[i].ip +"</option>";

		     devicedata1+="<option value='"+ data.systemip[i].device_name +"'>"+ data.systemip[i].device_name +"</option>";
           //ipdata1+="<option value='"+ data.systemip[i].ip +"'>"+ data.systemip[i].ip +"</option>";
            }
            SetDatadevice.append(devicedata);
            //SetDataip.append(ipdata);
            SetDatadevice1.append(devicedata1);
            //SetDataip1.append(ipdata1);
        }
        });

    });

	var varsouidvalue="";
    var varssystemvalue="";
    var varsipvalue = "";
    $("#Drpouproduct1").change(function () {
        varsouidvalue = this.value;
    });

    $("#drpPsystemname").change(function () {
        varssystemvalue = this.value;

    });
    //$("#drpsystemIP").change(function () {
    //    varsipvalue = this.value;

    //});


	var vardeviceid="";
	//$("#btnsdsubmit").on("click",function(){
	//   systemcountpopupdetails(vardeviceid);
	//     $('#product_system_count').modal('show');
	//});
    $("#btnsdshow").on("click", function () {
        var $valid = $('#product_system_count_form').valid();
        if (!$valid) {
            $validatorform.focusInvalid();
            return false;
        } else {
            systemcountpopupdetails(vardeviceid);
            $('#product_system_count').modal('show');
        }
	});
	//function systemcountpopup(ou,device,ip,deviceid)
    function systemcountpopup(device, ip, deviceid)
    {
        //debugger;
        var deviceid = deviceid;
        var url = '@Url.Content("~/csat_report/getou_device?deviceid=")' + deviceid;
        $.ajax({
            type: "POST",
            url: url,
            success: function (data) {
                //debugger;
                //ou = data.ouid;
	   var SetData = $('#divsystemdetails123');
        jQuery('#divsystemdetails123').html('');
                var headdata = "<table class='table table-striped table-bordered tbldemo'  style='width:100%'><thead><tr><th class='col-sm-4'  data-orderable='false'>Branch/ Unit</th>"+
            "<th class='col-sm-4'  data-orderable='false'>System Name</th><th class='col-sm-4'  data-orderable='false'>IP Address</th></tr></thead>" +
            "<tbody><tr><td class='col-sm-4' id='branch_name'>" + data.ouid + "</td><td class='col-sm-4' id='system_name'>" + device + "</td><td class='col-sm-4' id='ip_name'>" + ip + "</td></tr></tbody></table>";
                SetData.append(headdata);
                datatable_simple();

    }
        })
		systemcountpopupdetails(deviceid);
	  $('#product_system_count').modal('show');

	}
	function systemcountpopupdetails(deviceid)
	{
	//debugger;

	   var stype= document.getElementById("sdtype").value;
	   var svalue=  document.getElementById("sdvalue").value;
	    var url = '@Url.Content("~/csat_report/get_productkey_system_count_details?device_id=")'+deviceid+'&serchtype='+stype+'&value='+svalue;
        $.ajax({
        type: "POST",
        url: url,
            success: function (data) {
                document.getElementById("sdvalue").value = '';
                var dataclear = document.getElementById('divstystemdetails2_div');
                dataclear.innerHTML = '&nbsp;';
                $('#divstystemdetails2_div').append("<table id='divstystemdetails2' class='table table-striped table-bordered' width='100%'></table>");
                otable = document.getElementById('divstystemdetails2');
                var data1 = [];
                for (var i = 0; i < data.productkeysystemdetails.length; i++) {
                    data1.push([data.productkeysystemdetails[i].ou_longname, data.productkeysystemdetails[i].product, data.productkeysystemdetails[i].cd_key, data.productkeysystemdetails[i].product_id]);
                }
                var otable = $("#divstystemdetails2").DataTable({
                    data: data1, scrollX: !0, searching: !1, dom: "<'top'lB>rt<'bottom'ip><'clear'>", buttons: ["colvis", { text: "PDF", extend: "pdfHtml5", download: "open", filename: "Product Information_" + today, orientation: "portrait", pageSize: "A4", exportOptions: { columns: ":visible", search: "applied", order: "applied" }, customize: function (t) { t.content.splice(0, 1); var e = new Date, n = e.getDate() + "-" + (e.getMonth() + 1) + "-" + e.getFullYear(); t.pageMargins = [20, 60, 20, 30], t.defaultStyle.fontSize = 7, t.styles.tableHeader.fontSize = 7, t.header = function () { return { columns: [{ margin: [0, -5, 30, 15], alignment: "left", width: 100, image: "data:image/png;base64," + pdflogo }, { margin: [-10, 10, 10, 0], alignment: "center", width: 410, text: "Product Information Report", fontSize: 12 }, { alignment: "right", fontSize: 14, text: "" }], margin: 20 } }, t.footer = function (t, e) { return { columns: [{ alignment: "left", text: ["Created on: ", { text: n.toString() }] }, { alignment: "right", text: ["page ", { text: t.toString() }, " of ", { text: e.toString() }] }], margin: 20 } }; var a = { hLineWidth: function (t) { return .5 }, vLineWidth: function (t) { return .5 }, hLineColor: function (t) { return "#aaa" }, vLineColor: function (t) { return "#aaa" }, paddingLeft: function (t) { return 4 }, paddingRight: function (t) { return 4 } }; t.content[0].layout = a } }, 'excel'],
                    columns: [{ title: "Branch/ Unit" }, { title: "Product name" }, { title: "Product Key" }, { title: "Product ID" }]
                });
                $(".table").css({ "width": "100%" });
                $(".dataTables_scrollHeadInner ").css({ "width": "100%" });
	 }
	   });
	}

    var varksystemvalue="";
    var varkipvalue = "";

    $("#drpkeysystemname").change(function () {
        varksystemvalue = this.value;

    });
    //$("#drpkeyIP").change(function () {
    //    varkipvalue = this.value;

    //});

    var varkey="";
    var varcount = "";
  function keycountpopup(keyvalue,cnt)
  {
 // debugger;
      var varkip = document.getElementById("drpkip").value;
      varkey = keyvalue;
      varcount = cnt;
      bindoudata("drpkou");
	   var url = '@Url.Content("~/csat_report/get_productkey_key_count?keyid=")'+keyvalue+'&ouid='+kouidvalue+'&ip='+varkip+'&system='+varksystem;;
        $.ajax({
        type: "POST",
        url: url,
            success: function (data) {
                var dataclear = document.getElementById('divkeyinfo_div');
                dataclear.innerHTML = '&nbsp;';
                $('#divkeyinfo_div').append("<table id='divkeyinfo' class='table table-striped table-bordered' width='100%'></table>");
                otable = document.getElementById('divkeyinfo');
                var data1 = [];
                for (var i = 0; i < data.keyiddata.length; i++) {
                    data1.push([data.keyiddata[i].ou_longname, data.keyiddata[i].device_name, data.keyiddata[i].ip, data.keyiddata[i].data1]);
                }
                var otable = $("#divkeyinfo").DataTable({
                    data: data1, scrollX: !0, searching: !1, dom: "<'top'lB>rt<'bottom'ip><'clear'>", buttons: ["colvis", { text: "PDF", extend: "pdfHtml5", download: "open", filename: "Product Information_" + today, orientation: "portrait", pageSize: "A4", exportOptions: { columns: ":visible", search: "applied", order: "applied" }, customize: function (t) { t.content.splice(0, 1); var e = new Date, n = e.getDate() + "-" + (e.getMonth() + 1) + "-" + e.getFullYear(); t.pageMargins = [20, 60, 20, 30], t.defaultStyle.fontSize = 7, t.styles.tableHeader.fontSize = 7, t.header = function () { return { columns: [{ margin: [0, -5, 30, 15], alignment: "left", width: 100, image: "data:image/png;base64," + pdflogo }, { margin: [-10, 10, 10, 0], alignment: "center", width: 410, text: "Product Information Report", fontSize: 12 }, { alignment: "right", fontSize: 14, text: "" }], margin: 20 } }, t.footer = function (t, e) { return { columns: [{ alignment: "left", text: ["Created on: ", { text: n.toString() }] }, { alignment: "right", text: ["page ", { text: t.toString() }, " of ", { text: e.toString() }] }], margin: 20 } }; var a = { hLineWidth: function (t) { return .5 }, vLineWidth: function (t) { return .5 }, hLineColor: function (t) { return "#aaa" }, vLineColor: function (t) { return "#aaa" }, paddingLeft: function (t) { return 4 }, paddingRight: function (t) { return 4 } }; t.content[0].layout = a } }, 'excel'],
                    columns: [{ title: "Branch/ Unit" }, { title: "System Name" }, { title: "IP Address" }, { title: "Operation System" }]
                });
                $(".table").css({ "width": "100%" });
                $(".dataTables_scrollHeadInner ").css({ "width": "100%" });
                var SetData = $('#divkeyinfo_header_div');
                jQuery('#divkeyinfo_header_div').html('');
                var rawdata = "";
                var headdata = "<table class='table table-striped table-bordered' id='divkeyinfo_header' style='width:100%;margin-bottom: -15px;'><caption style='padding:5px;'><div style='float:left;font-weight:bold;color:#3a72a2;' id='product_name'>Product Key : " + keyvalue + " </div>" +
                    "<div class='pull-right' id='product_count1'><b> Total : </b>" + cnt + "</div></caption>";
                SetData.append(headdata + "</table>");
		}
    });
	//keywisedetail(keyvalue,varcount);
	 $('#product_key_count').modal('show');
  }
  var kouidvalue="";
  $("#drpkou").change(function () {

        kouidvalue = this.value;
        var url = '@Url.Content("~/csat_report/Get_syatemname_ip?ouid=")' + this.value;
        $.ajax({
        type: "POST",
        url: url,
        success: function (data) {
       // debugger;
        var SetDatadevice = $('#drpksystem');
        //var SetDataip = $('#drpkip');
        jQuery('#drpksystem').html('');
        //jQuery('#drpkip').html('');
        var devicedata = "<option value='-1'>Select System Name</option>";
        //var ipdata = "<option value='-1' >Select IP Address</option>";
	    for (var i = 0; i < data.systemip.length; i++) {
           devicedata+="<option value='"+ data.systemip[i].device_name +"'>"+ data.systemip[i].device_name +"</option>";
           //ipdata+="<option value='"+ data.systemip[i].ip +"'>"+ data.systemip[i].ip +"</option>";
	        }
            SetDatadevice.append(devicedata);
            //SetDataip.append(ipdata);
        }
        });

    });

	 var varksystem="";
    var varkip = "";

    $("#drpksystem").change(function () {
        varksystem = this.value;

    });
    //$("#drpkip").change(function () {
    //    varkip = this.value;

    //});
    $("#btnkshowreport").on("click", function () {
        var $valid = $('#product_key_count_form').valid();
        if (!$valid) {
            $validatorform.focusInvalid();
            return false;
        } else {
            keycountpopup(varkey, varcount);
        }
	});

    function clearvalue1() {
        $('#div_product_detail').html('');
        $('#div_system_detail').html('');
        $('#div_pkeywise').html('');
        document.getElementById('product_wise').checked = true;

        document.getElementById('product_detail').style.display = 'block';
        document.getElementById('system_detail').style.display = 'none';
        document.getElementById('product_key_detail').style.display = 'none';

        document.getElementById('product_show').style.display = 'block';
        document.getElementById('system_show').style.display = 'none';
        document.getElementById('product_key_show').style.display = 'none';

        $('#btnproductGenerate').hide();
        $('#btnsystemGenerate').hide();
        $('#btnkeyGenerate').hide();


        document.getElementById("system_wise").checked = false;
        document.getElementById("product_key_wise").checked = false;
        document.getElementById("txtproductserch").value = '';
        document.getElementById("Drpouproduct1").value = '-1';

        document.getElementById("drpPsystemname").value = '-1';
        document.getElementById("drpsystemIP").value = '';
        var SetDatadevice = $('#drpPsystemname');
        //var SetDataip = $('#drpsystemIP');
        jQuery('#drpPsystemname').html('');
        //jQuery('#drpsystemIP').html('');
        var devicedata = "<option value='-1'>Select System Name</option>";
        //var ipdata = "<option value='-1'>Select IP Address</option>";
        SetDatadevice.append(devicedata);
        //SetDataip.append(ipdata);

        document.getElementById("drpkeysystemname").value = '-1';
        //document.getElementById("drpkeyIP").value = '';
        var SetDatadevice1 = $('#drpkeysystemname');
        //var SetDataip1 = $('#drpkeyIP');
        jQuery('#drpkeysystemname').html('');
        //jQuery('#drpkeyIP').html('');
        var devicedata1 = "<option value='-1'>Select System Name</option>";
        //var ipdata1 = "<option value='-1'>Select IP Address</option>";
        SetDatadevice1.append(devicedata1);
        //SetDataip1.append(ipdata1);
    }
	function clearvalue()
    {
        document.getElementById('drpgenerateip').value = '';
        document.getElementById('drpgeneratesystem').value = '-1';
        document.getElementById('drpkip').value = '';
        document.getElementById('drpksystem').value = '-1';
        document.getElementById("generatesearachserchtype").value = '-1';
        document.getElementById("txtgeneratesearach").value = '';
        document.getElementById("sdtype").value = '-1';
        document.getElementById("sdvalue").value = '';
	    productname="";
        system="";
        Pkey = "";
        vargipvalue = "";
        vargsystemvalue = "";
        varkip = "";
        varksystem = "";
        kouidvalue  ="";
	}
	@* Key wise script end *@
</script>
<script>

    $.get('@Url.Content("~/csat_report/GetOU/")', null, DataBind)
    function DataBind(data) {
        $("#overlay").show();
        $("#overlay").fadeIn(300);
	 //debugger;
        var url = '@Url.Content("~/csat_report/GetOU/")';
        $.ajax({
            type: "POST",
            url: url,
            success: function (data) {
                var SetData = $('#DrpOU');
                jQuery('#DrpOU').html('');
                var SetData1 = $('#DrpOU1');
                jQuery('#DrpOU1').html('');
                var SetData2 = $('#DrpOU2');
                jQuery('#DrpOU2').html('');
                var SetData3 = $('#DrpOU3');
                jQuery('#DrpOU3').html('');
                var SetData4 = $('#DrpOU4');
                jQuery('#DrpOU4').html('');
                var oudata = "<option value='-1'>Select Branch/ Unit</option>";
                for (var i = 0; i < data.ou.length; i++) {
                    oudata += "<option value='" + data.ou[i].ouid + "'>" + data.ou[i].ouname + "</option>";
                }
                SetData.append(oudata);
                SetData1.append(oudata);
                SetData2.append(oudata);
                SetData3.append(oudata);
                SetData4.append(oudata);
            }
        }).done(function () {
            setTimeout(function () {
                $("#overlay").fadeOut(300);
            }, 500);
        });
	}
</script>
<script>
    var ouidvalue = "";
    var softwarevalue = "";
    var systemvalue = "";
    var ipvalue = "";
    $("#DrpOU").change(function () {

        ouidvalue = this.value;
        var url = '@Url.Content("~/csat_report/Get_syatemname_ip?ouid=")' + this.value;
        $.ajax({
        type: "POST",
        url: url,
        success: function (data) {
        // debugger;
        var SetDatadevice = $('#Device');
        //var SetDataip = $('#IP');

            jQuery('#Device').html('');
            //jQuery('#IP').html('');

        var devicedata = "<option value='-1'>Select System Name</option>";
        //var ipdata = "<option value='-1'>Select IP Address</option>";

        for (var i = 0; i < data.systemip.length; i++) {
           devicedata+="<option value='"+ data.systemip[i].device_name +"'>"+ data.systemip[i].device_name +"</option>";
           //ipdata+="<option value='"+ data.systemip[i].ip +"'>"+ data.systemip[i].ip +"</option>";
            }
            SetDatadevice.append(devicedata);
            //SetDataip.append(ipdata);
        }

        });

    });

    $("#Device").change(function () {
        systemvalue = this.value;

    });
    //$("#IP").change(function () {
    //    ipvalue = this.value;

    //});
    var softinstuninstvalue = "";
    $('input[type=radio]').change(function () {
        softinstuninstvalue = this.value;
    });
    var softwareinstallcheck = "";
    var softwareuninstallcheck = "";
    function softinstalledcount() {
        var $valid = $('#frm_softinform_report').valid();
        if (!$valid) {
            $validatorform.focusInvalid();
            return false;
        } else {
            $("#overlay").show();
            $("#overlay").fadeIn(300);
            //debugger;
            if (softinstuninstvalue == '')
                softinstuninstvalue = 'Install';
            var e = document.getElementById("txtsearchsoft");
            softserach = e.value;
            var authstatus = $('input[name=viewbyauth]:checked').val();
            var url = '@Url.Content("~/csat_report/Getsoftinsatlledcount?ouid=")' + ouidvalue + '&softsearch=' + softserach + '&authsearch=' + authstatus;
            $.ajax({
                type: "POST",
                url: url,
                success: function (data) {
                    //debugger;
                    var software_divclear = document.getElementById('tblsoftinstcount_div');
                    software_divclear.innerHTML = '&nbsp;';
                    $('#tblsoftinstcount_div').append("<table id='tblsoftinstcount' class='table table-striped table-bordered' width='100%'></table>");
                    otable = document.getElementById('tblsoftinstcount');
                    var data1 = [];
                    var softcount = "";
                    for (var i = 0; i < data.getsoftinsatlledcountdata.length; i++) {
                        if (softinstuninstvalue == 'Install') {
                            softcount = "<a href='' data-toggle='modal' data-target='#software_count' onclick=Installedsoftdetail('" + softinstuninstvalue + "','" + encodeURIComponent(data.getsoftinsatlledcountdata[i].software) + "','" + data.getsoftinsatlledcountdata[i].installed + "') >" + data.getsoftinsatlledcountdata[i].installed + "</a>";
                        }
                        else {
                            softcount = "<a href='' data-toggle='modal' data-target='#software_count' onclick=UNInstalledsoftdetail('" + encodeURIComponent(softinstuninstvalue) + "','" + encodeURIComponent(data.getsoftinsatlledcountdata[i].software) + "','" + data.getsoftinsatlledcountdata[i].uninstalled + "')>" + data.getsoftinsatlledcountdata[i].uninstalled + "</a>";
                        }
                        data1.push([data.getsoftinsatlledcountdata[i].software, data.getsoftinsatlledcountdata[i].software, softcount]);
                    }
                    var otable = $("#tblsoftinstcount").DataTable({
                        data: data1, scrollX: !0, searching: !1,
                        'columnDefs': [{ 'targets': 0, 'checkboxes': { 'selectRow': true } }, { orderable: false, targets: 1 }], 'select': { 'style': 'multi' },
                        columns: [{ title: "", width: '10px' }, { title: "Software Name", width: '90px' }, { title: "Total Count", width: '90px' }]
                    });
                    $(".table").css({ "width": "100%" });
                    $(".dataTables_scrollHeadInner ").css({ "width": "100%" });
                    $("#btnsoftgeneraterpt").show();
                    $("#btnsoftgeneraterpt1").show();

                    $('#btnsoftgeneraterpt').on('click', function (e) {
                        var form = this;
                        softwareinstallcheck = "";
                        var rows_selected = otable.column(0).checkboxes.selected();
                        $.each(rows_selected, function (index) {
                            //debugger;
                            for (var i = 0; i < rows_selected.length; i++) {
                                softwareinstallcheck += "," + rows_selected[i];
                            }
                            softgeneratereport();
                            return false;
                        });
                    });

                    $('#btnsoftgeneraterpt1').on('click', function (e) {
                        var form = this;
                        softwareuninstallcheck = "";
                        var rows_selected = otable.column(0).checkboxes.selected();
                        $.each(rows_selected, function (index) {
                            // debugger;
                            for (var i = 0; i < rows_selected.length; i++) {
                                softwareuninstallcheck += "," + rows_selected[i];
                            }
                            notinstalledsoftgeneratereport();
                            return false;
                        });
                    });
                }
            }).done(function () {
                setTimeout(function () {
                    $("#overlay").fadeOut(300);
                }, 500);
            });
        }
    }
    var syscheck = "";
    function softinstalledcountsyswise() {
        var $valid = $('#frm_softinform_report').valid();
        if (!$valid) {
            $validatorform.focusInvalid();
            return false;
        } else {
            $("#overlay").show();
            $("#overlay").fadeIn(300);
            var ipvalue = document.getElementById("IP").value;
            //var systemvalue = document.getElementById("Device").value;
            var systemvalue = document.getElementById('add_systemname').value;
            if (systemvalue == "") {
                systemvalue = document.getElementById("Device").value;
            }

            var url = '@Url.Content("~/csat_report/Getsoftinsatlledcountsyswise?IP=")' + ipvalue + '&Device=' + systemvalue + '&ouid=' + ouidvalue;
            $.ajax({
                type: "POST",
                url: url,
                success: function (data) {
                    //debugger;
                    var software_divclear = document.getElementById('tblsoftinstcountsyswise_div');
                    software_divclear.innerHTML = '&nbsp;';
                    $('#tblsoftinstcountsyswise_div').append("<table id='tblsoftinstcountsyswise' class='table table-striped table-bordered' width='100%'></table><div class='pull-left col-xs-1' style='margin-top:-14px;'><input type='button' class='btn btn-primary' value='Details Report' data-toggle='modal' id='btnsysgeneraterpt' style='display:none'></div>");
                    otable = document.getElementById('tblsoftinstcountsyswise');
                    var data1 = [];
                    for (var i = 0; i < data.getsoftinsatlledcountsyswisedata.length; i++) {
                        var softmodel = "<a href='' data-toggle='modal' data-target='#system_count' onclick=Installedsoftdetailsyswise('" + data.getsoftinsatlledcountsyswisedata[i].device_id + "','" + data.getsoftinsatlledcountsyswisedata[i].device_name + "','" + data.getsoftinsatlledcountsyswisedata[i].ip + "','" + encodeURIComponent(data.getsoftinsatlledcountsyswisedata[i].ou_longname) + "')>" + data.getsoftinsatlledcountsyswisedata[i].installed + "</a>";
                        data1.push([data.getsoftinsatlledcountsyswisedata[i].device_id, data.getsoftinsatlledcountsyswisedata[i].device_name, data.getsoftinsatlledcountsyswisedata[i].ip, softmodel]);
                    }
                    var otable = $("#tblsoftinstcountsyswise").DataTable({
                        data: data1, scrollX: !0, searching: !1,
                        'columnDefs': [{ 'targets': 0, 'checkboxes': { 'selectRow': true } }, { orderable: false, targets: 1 }], 'select': { 'style': 'multi' },
                        columns: [{ title: "", width: '10px' }, { title: "System Name", width: '90px' }, { title: "IP Address", width: '90px' }, { title: "Total Count", width: '90px' }]
                    });
                    $(".table").css({ "width": "100%" });
                    $(".dataTables_scrollHeadInner ").css({ "width": "100%" });
                    $("#btnsysgeneraterpt").show();
                    $('#btnsysgeneraterpt').on('click', function (e) {
                        var form = this;
                        syscheck = "";
                        var rows_selected = otable.column(0).checkboxes.selected();
                        $.each(rows_selected, function (index) {
                            // debugger;
                            for (var i = 0; i < rows_selected.length; i++) {
                                syscheck += "," + rows_selected[i];
                            }
                            check_system();
                            return false;
                        });
                    });

                }
            }).done(function () {
                setTimeout(function () {
                    $("#overlay").fadeOut(300);
                }, 500);
            });
        }
    }
    // Get Installed Soft Details
    var ouidvalue = "";
    var softwarevalue = "";
    var systemvalue = "";
    var ipvalue = "";
     $("#DrpOU1").change(function () {

        ouidvalue = this.value;
        var url = '@Url.Content("~/csat_report/Get_syatemname_ip?ouid=")' + this.value;
        $.ajax({
        type: "POST",
        url: url,
        success: function (data) {
        // debugger;
            var SetDatadevice = $('#System1');
            var SetDataip = $('#IP1');

            jQuery('#System1').html('');
            jQuery('#IP1').html('');

        var devicedata = "<option value='-1'>Select System Name</option>";
        var ipdata = "<option value='-1'>Select IP Address</option>";

        for (var i = 0; i < data.systemip.length; i++) {
           devicedata+="<option value='"+ data.systemip[i].device_name +"'>"+ data.systemip[i].device_name +"</option>";
           ipdata+="<option value='"+ data.systemip[i].ip +"'>"+ data.systemip[i].ip +"</option>";
            }

            SetDatadevice.append(devicedata);
            SetDataip.append(ipdata);
        }
        });
    });
    $("#System1").change(function () {
        systemvalue = this.value;

    });
    $("#IP1").change(function () {
        ipvalue = this.value;

    });
    var softcopy="";
    var installedcount="";
    var softtype = "";
    $('#btnshowsoftdetails').on('click', function () {
        var $valid = $('#software_form').valid();
        if (!$valid) {
            $validatorform.focusInvalid();
            return false;
        } else {
            //debugger;
            if (softtype == '')
                softtype = 'Install';
            if (softtype == 'Install')
                Installedsoftdetail('', softcopy, installedcount);
            else
                ShowUNInstalledsoftdetail('', softcopy1, uninstalledcount);
        }
    });


    function Installedsoftdetail(softinstuninstvalue, software, installed) {
    //debugger;
        //IP = "";
        //Device = "";
        var ipvalue = document.getElementById('IP1').value;
        //var systemvalue = document.getElementById('System1').value;
        softtype = softinstuninstvalue ;
        softcopy = software;
        installedcount = installed;
        var systemvalue = document.getElementById('add_systemname3').value;
        if (systemvalue == "") {
            systemvalue = document.getElementById("System1").value;
        }
        var url = '@Url.Content("~/csat_report/Getsoftinsatlleddetails?softinstuninstvalue=")' + softinstuninstvalue + '&software=' + software  + '&IP=' + ipvalue + '&Device=' + systemvalue + '&ouid=' + ouidvalue;
        $.ajax({
            type: "POST",
            url: url,
            success: function (data) {
                var dataclear = document.getElementById('tblsoftinstdetails_div');
                dataclear.innerHTML = '&nbsp;';
                $('#tblsoftinstdetails_div').append("<table id='tblsoftinstdetails' class='table table-striped table-bordered' width='100%'></table>");
                otable = document.getElementById('tblsoftinstdetails');
                var data1 = [];
                for (var i = 0; i < data.getsoftinsatlleddetailsdata.length; i++) {
                    data1.push([data.getsoftinsatlleddetailsdata[i].ou_longname, data.getsoftinsatlleddetailsdata[i].device_name, data.getsoftinsatlleddetailsdata[i].ip]);
                }
                var otable = $("#tblsoftinstdetails").DataTable({
                    data: data1, scrollX: !0, searching: !1, dom: "<'top'lB>rt<'bottom'ip><'clear'>", buttons: ["colvis", { text: "PDF", extend: "pdfHtml5", download: "open", filename: "Software Information_" + today, orientation: "portrait", pageSize: "A4", exportOptions: { columns: ":visible", search: "applied", order: "applied" }, customize: function (t) { t.content.splice(0, 1); var e = new Date, n = e.getDate() + "-" + (e.getMonth() + 1) + "-" + e.getFullYear(); t.pageMargins = [20, 60, 20, 30], t.defaultStyle.fontSize = 7, t.styles.tableHeader.fontSize = 7, t.header = function () { return { columns: [{ margin: [0, -5, 30, 15], alignment: "left", width: 100, image: "data:image/png;base64," + pdflogo }, { margin: [-10, 10, 10, 0], alignment: "center", width: 410, text: "Software Information Report", fontSize: 12 }, { alignment: "right", fontSize: 14, text: "" }], margin: 20 } }, t.footer = function (t, e) { return { columns: [{ alignment: "left", text: ["Created on: ", { text: n.toString() }] }, { alignment: "right", text: ["page ", { text: t.toString() }, " of ", { text: e.toString() }] }], margin: 20 } }; var a = { hLineWidth: function (t) { return .5 }, vLineWidth: function (t) { return .5 }, hLineColor: function (t) { return "#aaa" }, vLineColor: function (t) { return "#aaa" }, paddingLeft: function (t) { return 4 }, paddingRight: function (t) { return 4 } }; t.content[0].layout = a } }, 'excel'],
                    columns: [{ title: "Branch/ Unit" }, { title: "System Name" }, { title: "IP Address" }]
                });
                $(".table").css({ "width": "100%" });
                $(".dataTables_scrollHeadInner ").css({ "width": "100%" });
            }
        });


    }
    var softcopy1 = "";
    var uninstalledcount = "";
    function UNInstalledsoftdetail(softinstuninstvalue, software, uninstalled) {
     //   debugger;
       // alert('in');
        softtype = softinstuninstvalue;
        softcopy1 = software;
        uninstalledcount = uninstalled;
        @*var url = '@Url.Content("~/csat_report/Getsoftuninsatlleddetails?softinstuninstvalue=")' + softinstuninstvalue + '&software=' + software + '&IP=' + ipvalue + '&Device=' + systemvalue + '&ouid=' + ouidvalue;*@
        var url = '@Url.Content("~/csat_report/Getsoftuninsatlleddetails?softinstuninstvalue=")' + softinstuninstvalue + '&software=' + software ;
        $.ajax({
            type: "POST",
            url: url,
            success: function (data) {
                var dataclear = document.getElementById('tblsoftinstdetails_div');
                dataclear.innerHTML = '&nbsp;';
                $('#tblsoftinstdetails_div').append("<table id='tblsoftinstdetails' class='table table-striped table-bordered' width='100%'></table>");
                otable = document.getElementById('tblsoftinstdetails');
                var data1 = [];
                for (var i = 0; i < data.getsoftuninsatlleddetailsdata.length; i++) {
                    data1.push([data.getsoftuninsatlleddetailsdata[i].ou_longname, data.getsoftuninsatlleddetailsdata[i].device_name, data.getsoftuninsatlleddetailsdata[i].ip]);
                }
                var otable = $("#tblsoftinstdetails").DataTable({
                    data: data1, scrollX: !0, searching: !1, dom: "<'top'lB>rt<'bottom'ip><'clear'>", buttons: ["colvis", { text: "PDF", extend: "pdfHtml5", download: "open", filename: "Software Uninstall" + today, orientation: "portrait", pageSize: "A4", exportOptions: { columns: ":visible", search: "applied", order: "applied" }, customize: function (t) { t.content.splice(0, 1); var e = new Date, n = e.getDate() + "-" + (e.getMonth() + 1) + "-" + e.getFullYear(); t.pageMargins = [20, 60, 20, 30], t.defaultStyle.fontSize = 7, t.styles.tableHeader.fontSize = 7, t.header = function () { return { columns: [{ margin: [0, -5, 30, 15], alignment: "left", width: 100, image: "data:image/png;base64," + pdflogo }, { margin: [-10, 10, 10, 0], alignment: "center", width: 410, text: "Software Uninstall Report", fontSize: 12 }, { alignment: "right", fontSize: 14, text: "" }], margin: 20 } }, t.footer = function (t, e) { return { columns: [{ alignment: "left", text: ["Created on: ", { text: n.toString() }] }, { alignment: "right", text: ["page ", { text: t.toString() }, " of ", { text: e.toString() }] }], margin: 20 } }; var a = { hLineWidth: function (t) { return .5 }, vLineWidth: function (t) { return .5 }, hLineColor: function (t) { return "#aaa" }, vLineColor: function (t) { return "#aaa" }, paddingLeft: function (t) { return 4 }, paddingRight: function (t) { return 4 } }; t.content[0].layout = a } }, 'excel'],
                    columns: [{ title: "Branch/ Unit" }, { title: "System Name" }, { title: "IP Address" }]
                });
                $(".table").css({ "width": "100%" });
                $(".dataTables_scrollHeadInner ").css({ "width": "100%" });
            }
        });
    }
    function ShowUNInstalledsoftdetail(softinstuninstvalue, software, uninstalled) {
        //debugger;
        var ipvalue = document.getElementById('IP1').value;
        var systemvalue = document.getElementById('System1').value;
        var url = '@Url.Content("~/csat_report/Showsoftuninsatlleddetails?IP=")' + ipvalue + '&Device=' + systemvalue + '&ouid=' + ouidvalue;
        $.ajax({
            type: "POST",
            url: url,
            success: function (data) {
                 //  debugger;
                var dataclear = document.getElementById('tblsoftinstdetails_div');
                dataclear.innerHTML = '&nbsp;';
                $('#tblsoftinstdetails_div').append("<table id='tblsoftinstdetails' class='table table-striped table-bordered' width='100%'></table>");
                otable = document.getElementById('tblsoftinstdetails');
                var data1 = [];
                for (var i = 0; i < data.showsoftuninsatlleddetailsdata.length; i++) {
                    data1.push([data.showsoftuninsatlleddetailsdata[i].ou_longname, data.showsoftuninsatlleddetailsdata[i].device_name, data.showsoftuninsatlleddetailsdata[i].ip]);
                }
                var otable = $("#tblsoftinstdetails").DataTable({
                    data: data1, scrollX: !0, searching: !1, dom: "<'top'lB>rt<'bottom'ip><'clear'>", buttons: ["colvis", { text: "PDF", extend: "pdfHtml5", download: "open", filename: "Software Uninstall" + today, orientation: "portrait", pageSize: "A4", exportOptions: { columns: ":visible", search: "applied", order: "applied" }, customize: function (t) { t.content.splice(0, 1); var e = new Date, n = e.getDate() + "-" + (e.getMonth() + 1) + "-" + e.getFullYear(); t.pageMargins = [20, 60, 20, 30], t.defaultStyle.fontSize = 7, t.styles.tableHeader.fontSize = 7, t.header = function () { return { columns: [{ margin: [0, -5, 30, 15], alignment: "left", width: 100, image: "data:image/png;base64," + pdflogo }, { margin: [-10, 10, 10, 0], alignment: "center", width: 410, text: "Software Uninstall Report", fontSize: 12 }, { alignment: "right", fontSize: 14, text: "" }], margin: 20 } }, t.footer = function (t, e) { return { columns: [{ alignment: "left", text: ["Created on: ", { text: n.toString() }] }, { alignment: "right", text: ["page ", { text: t.toString() }, " of ", { text: e.toString() }] }], margin: 20 } }; var a = { hLineWidth: function (t) { return .5 }, vLineWidth: function (t) { return .5 }, hLineColor: function (t) { return "#aaa" }, vLineColor: function (t) { return "#aaa" }, paddingLeft: function (t) { return 4 }, paddingRight: function (t) { return 4 } }; t.content[0].layout = a } }, 'excel'],
                    columns: [{ title: "Branch/ Unit" }, { title: "System Name" }, { title: "IP Address" }]
                });
                $(".table").css({ "width": "100%" });
                $(".dataTables_scrollHeadInner ").css({ "width": "100%" });
            }
        });
    }
    //System wise software popup detail
    var type = "";
    $("#type1").change(function () {

        // debugger;
        type = this.value;
    });

    var deviceid_search = '';
    var device_namesearch = '';
    var ipsearch = '';
    var ouserach = '';
    $('#btnshowinslledsys').on('click', function () {
     //   debugger;
        var $valid = $('#system_form').valid();
        if (!$valid) {
            $validatorform.focusInvalid();
            return false;
        } else {
        Installedsoftdetailsyswise(deviceid_search,device_namesearch, ipsearch, ouserach);
}
    });


   function Installedsoftdetailsyswise(device_id,device_name, ip, ou) {
       // debugger;
        var startdate = "";
        var enddate = "";
        var varkeynumber = "";
        var chekboxkeynumber = document.getElementById("key_check");
        if (chekboxkeynumber.checked) {
            //varkeynumber = document.getElementById("system_date").value;
            startdate = $('#system_date').data('daterangepicker').startDate.format('DD/MM/YYYY');
            enddate = $('#system_date').data('daterangepicker').endDate.format('DD/MM/YYYY');
        }
        else {
            varkeynumber = document.getElementById("txtkey").value;
        }
        deviceid_search = device_id;
        device_namesearch = device_name;
        ipsearch = ip;
        ouserach =  decodeURIComponent(ou);
        var e = document.getElementById("searchvalue");
        ValueSerach = e.value;

        var url = '@Url.Content("~/csat_report/Showinstalledsoftdetailsyswise?startdate=")' + startdate + '&enddate=' + enddate + '&FieldSerach=' + type + '&ValueSerach=' + ValueSerach + '&ouid=' + ouidvalue + '&devicename=' + device_name + '&device_id=' + device_id ;
        $.ajax({
            type: "POST",
            url: url,
            success: function (data) {
                var dataclear = document.getElementById('tblsoftinstsysdetailshead_div');
                dataclear.innerHTML = '&nbsp;';
                $('#tblsoftinstsysdetailshead_div').append("<table id='tblsoftinstsysdetailshead' class='table table-striped table-bordered' width='100%'></table>");
                otable = document.getElementById('tblsoftinstsysdetailshead');
                var data1 = [];
                for (var i = 0; i < data.showinstalledsoftdetailsyswisedata.length; i++) {
                    data1.push([data.showinstalledsoftdetailsyswisedata[i].software, data.showinstalledsoftdetailsyswisedata[i].version, data.showinstalledsoftdetailsyswisedata[i].publisher, data.showinstalledsoftdetailsyswisedata[i].installationdate, data.showinstalledsoftdetailsyswisedata[i].location]);
                }
                var otable = $("#tblsoftinstsysdetailshead").DataTable({
                    data: data1, scrollX: !0, searching: !1, dom: "<'top'lB>rt<'bottom'ip><'clear'>", buttons: ["colvis", { text: "PDF", extend: "pdfHtml5", download: "open", filename: "Software Information_" + today, orientation: "portrait", pageSize: "A4", exportOptions: { columns: ":visible", search: "applied", order: "applied" }, customize: function (t) { t.content.splice(0, 1); var e = new Date, n = e.getDate() + "-" + (e.getMonth() + 1) + "-" + e.getFullYear(); t.pageMargins = [20, 60, 20, 30], t.defaultStyle.fontSize = 7, t.styles.tableHeader.fontSize = 7, t.header = function () { return { columns: [{ margin: [0, -5, 30, 15], alignment: "left", width: 100, image: "data:image/png;base64," + pdflogo }, { margin: [-10, 10, 10, 0], alignment: "center", width: 410, text: "Software Information Report", fontSize: 12 }, { alignment: "right", fontSize: 14, text: "" }], margin: 20 } }, t.footer = function (t, e) { return { columns: [{ alignment: "left", text: ["Created on: ", { text: n.toString() }] }, { alignment: "right", text: ["page ", { text: t.toString() }, " of ", { text: e.toString() }] }], margin: 20 } }; var a = { hLineWidth: function (t) { return .5 }, vLineWidth: function (t) { return .5 }, hLineColor: function (t) { return "#aaa" }, vLineColor: function (t) { return "#aaa" }, paddingLeft: function (t) { return 4 }, paddingRight: function (t) { return 4 } }; t.content[0].layout = a } }, 'excel'],
                    columns: [{ title: "Software name" }, { title: "Version" }, { title: "Publisher" }, { title: "Installed On" }, { title: "Install Location" }]
                });
                $(".table").css({ "width": "100%" });
                $(".dataTables_scrollHeadInner ").css({ "width": "100%" });
              // debugger;
                var Setgriddata = $('#tblsoftinstsysdetailshead_header');
                jQuery('#tblsoftinstsysdetailshead_header').html('');
                var headdata = " <table class='table table-striped table-bordered tbldemo'  style='width:100%'>" +
                    "<thead> <tr><th class='col-sm-4' data-orderable='false'>Branch/ Unit</th><th class='col-sm-4' data-orderable='false'>System Name</th>" +
                    "  <th class='col-sm-4' data-orderable='false'>IP Address</th></tr></thead><tbody><tr>" +
                    "  <td class='col-sm-4' id='branch_name'>" + ouserach + "</td><td class='col-sm-4' id='system_name'>" + device_name + "</td>" +
                    "  <td class='col-sm-4' id='ip_name'>" + ip + "</td></tr></tbody></table>";
                Setgriddata.append(headdata);
                document.getElementById("type1").value = '-1';
                document.getElementById("searchvalue").value = '';
                datatable_simple();

            }
        });
    }

    // Generate report
    var ouidvalue = "";
    var softwarevalue = "";
    var systemvalue = "";
    var ipvalue = "";
     $("#DrpOU2").change(function () {

        ouidvalue = this.value;
        var url = '@Url.Content("~/csat_report/Get_syatemname_ip?ouid=")' + this.value;
        $.ajax({
        type: "POST",
        url: url,
        success: function (data) {
        // debugger;
            var SetDatadevice = $('#System2');
        //var SetDataip = $('#IP2');

            jQuery('#System2').html('');
            //jQuery('#IP2').html('');

        var devicedata = "<option value='-1'>Select System Name</option>";
        //var ipdata = "<option value='-1'>Select IP Address</option>";

        for (var i = 0; i < data.systemip.length; i++) {
           devicedata+="<option value='"+ data.systemip[i].device_name +"'>"+ data.systemip[i].device_name +"</option>";
           //ipdata+="<option value='"+ data.systemip[i].ip +"'>"+ data.systemip[i].ip +"</option>";
            }

            SetDatadevice.append(devicedata);
            //SetDataip.append(ipdata);

        }

        });

    });

    $("#System2").change(function () {
        systemvalue = this.value;

    });
    //$("#IP2").change(function () {
    //    ipvalue = this.value;

    //});
    var type = "";
    $("#type2").change(function () {
        type = this.value;
    });

    $('#btngeneratesoftshow').on('click', function () {
        var $valid = $('#system_form').valid();
        if (!$valid) {
            $validatorform.focusInvalid();
            return false;
        } else {
            softgeneratereport();
        }
    });

    $('#btngeneratenotinstallsoftshow').on('click', function () {
        var $valid = $('#system_form').valid();
        if (!$valid) {
            $validatorform.focusInvalid();
            return false;
        } else {
            notinstalledsoftgeneratereport();
        }
    });



     function softgeneratereport() {
         //   debugger;
         alert('test')
        var ipvalue = document.getElementById('IP2').value;
        //var systemvalue = document.getElementById('System2').value;
        var startdate = "";
        var enddate = "";
        var varkeynumber = "";
        var chekboxkeynumber = document.getElementById("soft_gen_check");
        if (chekboxkeynumber.checked) {
            startdate = $('#date').data('daterangepicker').startDate.format('DD/MM/YYYY');
            enddate = $('#date').data('daterangepicker').endDate.format('DD/MM/YYYY');
        }
        else {
            varkeynumber = document.getElementById("softgentext").value;
        }
         if (softwareinstallcheck == "")
            return alert("You must choose an option.");
        $('#software_generat_report').modal('show');
        var e = document.getElementById("serachvalue2");
         ValueSerach = e.value;
         var systemvalue = document.getElementById('add_systemname2').value;
         if (systemvalue == "") {
             systemvalue = document.getElementById("System2").value;
         }
         var url = '@Url.Content("~/csat_report/generateinstalledsoft?software=")' + softwareinstallcheck + '&ouid= ' + ouidvalue + '&startdate=' + startdate + '&enddate=' + enddate + '&FieldSerach=' + type + '&ValueSerach=' + ValueSerach +  '&ip=' + ipvalue + '&devicename=' + systemvalue ;
        $.ajax({
            type: "POST",
            url: url,
            success: function (data) {
                var dataclear = document.getElementById('tblsoftgenerate_div');
                dataclear.innerHTML = '&nbsp;';
                $('#tblsoftgenerate_div').append("<table id='tblsoftgenerate' class='table table-striped table-bordered' width='100%'></table>");
                otable = document.getElementById('tblsoftgenerate');
                var data1 = [];
                for (var i = 0; i < data.generatesoftinstalleddata.length; i++) {
                    data1.push([data.generatesoftinstalleddata[i].ou_longname, data.generatesoftinstalleddata[i].device_name, data.generatesoftinstalleddata[i].ip, data.generatesoftinstalleddata[i].software, data.generatesoftinstalleddata[i].version, data.generatesoftinstalleddata[i].publisher, data.generatesoftinstalleddata[i].installationdate, data.generatesoftinstalleddata[i].location]);
                }
                var otable = $("#tblsoftgenerate").DataTable({
                    data: data1, scrollX: !0, searching: !1, dom: "<'top'lB>rt<'bottom'ip><'clear'>", buttons: ["colvis", { text: "PDF", extend: "pdfHtml5", download: "open", filename: "Software Information_" + today, orientation: "portrait", pageSize: "A4", exportOptions: { columns: ":visible", search: "applied", order: "applied" }, customize: function (t) { t.content.splice(0, 1); var e = new Date, n = e.getDate() + "-" + (e.getMonth() + 1) + "-" + e.getFullYear(); t.pageMargins = [20, 60, 20, 30], t.defaultStyle.fontSize = 7, t.styles.tableHeader.fontSize = 7, t.header = function () { return { columns: [{ margin: [0, -5, 30, 15], alignment: "left", width: 100, image: "data:image/png;base64," + pdflogo }, { margin: [-10, 10, 10, 0], alignment: "center", width: 410, text: "Software Information Report", fontSize: 12 }, { alignment: "right", fontSize: 14, text: "" }], margin: 20 } }, t.footer = function (t, e) { return { columns: [{ alignment: "left", text: ["Created on: ", { text: n.toString() }] }, { alignment: "right", text: ["page ", { text: t.toString() }, " of ", { text: e.toString() }] }], margin: 20 } }; var a = { hLineWidth: function (t) { return .5 }, vLineWidth: function (t) { return .5 }, hLineColor: function (t) { return "#aaa" }, vLineColor: function (t) { return "#aaa" }, paddingLeft: function (t) { return 4 }, paddingRight: function (t) { return 4 } }; t.content[0].layout = a } }, 'excel'],
                    columns: [{ title: "Branch/ Unit" }, { title: "System Name" }, { title: "IP Address" }, { title: "Software name" }, { title: "Version" }, { title: "Publisher" }, { title: "Installed On" }, { title: "Install Location" }]
                });
                $(".table").css({ "width": "100%" });
                $(".dataTables_scrollHeadInner ").css({ "width": "100%" });
            }
        });
    }
    // Not install generate report
    var ouidvalue = "";
    var softwarevalue = "";
    var systemvalue = "";
    var ipvalue = "";
      $("#DrpOU3").change(function () {

        ouidvalue = this.value;
        var url = '@Url.Content("~/csat_report/Get_syatemname_ip?ouid=")' + this.value;
        $.ajax({
        type: "POST",
        url: url,
        success: function (data) {
        // debugger;
            var SetDatadevice = $('#System3');
        //var SetDataip = $('#IP3');

            jQuery('#System3').html('');
            //jQuery('#IP3').html('');

        var devicedata = "<option value='-1'>Select System Name</option>";
        //var ipdata = "<option value='-1'>Select IP Address</option>";

        for (var i = 0; i < data.systemip.length; i++) {
           devicedata+="<option value='"+ data.systemip[i].device_name +"'>"+ data.systemip[i].device_name +"</option>";
           //ipdata+="<option value='"+ data.systemip[i].ip +"'>"+ data.systemip[i].ip +"</option>";
            }

            SetDatadevice.append(devicedata);
            //SetDataip.append(ipdata);
        }

        });

    });

    $("#System3").change(function () {
        systemvalue = this.value;

    });
    //$("#IP3").change(function () {
    ////    debugger;
    //    ipvalue = this.value;

    //});

    function notinstalledsoftgeneratereport() {
        //  debugger;
        //alert("test")
        var ipvalue = document.getElementById('IP3').value;
        var systemvalue = document.getElementById('System3').value;
        if (softwareuninstallcheck == "")
            return alert("You must choose an option.");
        $('#software_generat_report1').modal('show');
        var e = document.getElementById("serachsoft");
        ValueSerach = e.value;
        var url = '@Url.Content("~/csat_report/generatenotinstalledsoft?software=")' + softwareuninstallcheck + '&ouid= ' + ouidvalue + '&softsearch=' + ValueSerach + '&ip=' + ipvalue + '&devicename=' + systemvalue;
        $.ajax({
            type: "POST",
            url: url,
            success: function (data) {
                var dataclear = document.getElementById('tblsoftnotinstallgenerate_div');
                dataclear.innerHTML = '&nbsp;';
                $('#tblsoftnotinstallgenerate_div').append("<table id='tblsoftnotinstallgenerate' class='table table-striped table-bordered' width='100%'></table>");
                otable = document.getElementById('tblsoftnotinstallgenerate');
                var data1 = [];
                for (var i = 0; i < data.generatesoftnotinstalleddata.length; i++) {
                    data1.push([data.generatesoftnotinstalleddata[i].ou_longname, data.generatesoftnotinstalleddata[i].device_name, data.generatesoftnotinstalleddata[i].ip, data.generatesoftnotinstalleddata[i].software]);
                }
                var otable = $("#tblsoftnotinstallgenerate").DataTable({
                    data: data1, scrollX: !0, searching: !1, dom: "<'top'lB>rt<'bottom'ip><'clear'>", buttons: ["colvis", { text: "PDF", extend: "pdfHtml5", download: "open", filename: "Software Information_" + today, orientation: "portrait", pageSize: "A4", exportOptions: { columns: ":visible", search: "applied", order: "applied" }, customize: function (t) { t.content.splice(0, 1); var e = new Date, n = e.getDate() + "-" + (e.getMonth() + 1) + "-" + e.getFullYear(); t.pageMargins = [20, 60, 20, 30], t.defaultStyle.fontSize = 7, t.styles.tableHeader.fontSize = 7, t.header = function () { return { columns: [{ margin: [0, -5, 30, 15], alignment: "left", width: 100, image: "data:image/png;base64," + pdflogo }, { margin: [-10, 10, 10, 0], alignment: "center", width: 410, text: "Software Information Report", fontSize: 12 }, { alignment: "right", fontSize: 14, text: "" }], margin: 20 } }, t.footer = function (t, e) { return { columns: [{ alignment: "left", text: ["Created on: ", { text: n.toString() }] }, { alignment: "right", text: ["page ", { text: t.toString() }, " of ", { text: e.toString() }] }], margin: 20 } }; var a = { hLineWidth: function (t) { return .5 }, vLineWidth: function (t) { return .5 }, hLineColor: function (t) { return "#aaa" }, vLineColor: function (t) { return "#aaa" }, paddingLeft: function (t) { return 4 }, paddingRight: function (t) { return 4 } }; t.content[0].layout = a } }, 'excel'],
                    columns: [{ title: "Branch/ Unit" }, { title: "System Name" }, { title: "IP Address" }, { title: "Software name" }]
                });
                $(".table").css({ "width": "100%" });
                $(".dataTables_scrollHeadInner ").css({ "width": "100%" });
            }
        });

    }


    // System generate report
    var ouidvalue = "";
    var softwarevalue = "";
    var systemvalue = "";
    var ipvalue = "";

      $("#DrpOU4").change(function () {

        ouidvalue = this.value;
        var url = '@Url.Content("~/csat_report/Get_syatemname_ip?ouid=")' + this.value;
        $.ajax({
        type: "POST",
        url: url,
        success: function (data) {
        // debugger;
            var SetDatadevice = $('#System4');
        //var SetDataip = $('#IP4');

            jQuery('#System4').html('');
            //jQuery('#IP4').html('');

        var devicedata = "<option value='-1'>Select System Name</option>";
        //var ipdata = "<option value='-1'>Select IP Address</option>";

        for (var i = 0; i < data.systemip.length; i++) {
           devicedata+="<option value='"+ data.systemip[i].device_name +"'>"+ data.systemip[i].device_name +"</option>";
           //ipdata+="<option value='"+ data.systemip[i].ip +"'>"+ data.systemip[i].ip +"</option>";
            }

            SetDatadevice.append(devicedata);
            //SetDataip.append(ipdata);

        }

        });

    });

    $("#System4").change(function () {
        systemvalue = this.value;

    });
    //$("#IP4").change(function () {
    ////    debugger;
    //    ipvalue = this.value;

    //});
    var type = "";
    $("#type4").change(function () {

        // debugger;
        type = this.value;
    });

    function check_system() {
        if (syscheck == "") {
            return alert("You must choose an option.");
        }
        else {
            $('#system_generat_report').modal('show');
            Installedsoftdetailsyswisegeneraterpt();
        }
    }


    $('#sysgenrptshow').on('click', function () {
        var $valid = $('#system_form').valid();
        if (!$valid) {
            $validatorform.focusInvalid();
            return false;
        } else {
            Installedsoftdetailsyswisegeneraterpt();
        }
    });


    function Installedsoftdetailsyswisegeneraterpt() {
        // debugger;
        
        var systemvalue = document.getElementById("System4").value;
        var ipvalue = document.getElementById("IP4").value;
        var startdate = "";
        var enddate = "";
        var varkeynumber = "";
        var chekboxkeynumber = document.getElementById("system_gen_check");
        if (chekboxkeynumber.checked) {
            startdate = $('#gen_system_date').data('daterangepicker').startDate.format('DD/MM/YYYY');
            enddate = $('#gen_system_date').data('daterangepicker').endDate.format('DD/MM/YYYY');
        }
        else {
            varkeynumber = document.getElementById("systemgentext").value;
        }
        var e = document.getElementById("searchsysgenrpt");
        ValueSerach = e.value;

        var url = '@Url.Content("~/csat_report/Showinstalledsoftdetailsyswise?startdate=")' + startdate + '&enddate=' + enddate + '&FieldSerach=' + type + '&ValueSerach=' + ValueSerach + '&ouid=' + ouidvalue + '&devicename=' + systemvalue + '&ip=' + ipvalue + '&devicecheck=' + syscheck;
        $.ajax({
            type: "POST",
            url: url,
            success: function (data) {
                var dataclear = document.getElementById('tblsysgenrpt_div');
                dataclear.innerHTML = '&nbsp;';
                $('#tblsysgenrpt_div').append("<table id='tblsysgenrpt' class='table table-striped table-bordered' width='100%'></table>");
                otable = document.getElementById('tblsysgenrpt');
                var data1 = [];
                for (var i = 0; i < data.showinstalledsoftdetailsyswisedata.length; i++) {
                    data1.push([data.showinstalledsoftdetailsyswisedata[i].ou_longname, data.showinstalledsoftdetailsyswisedata[i].device_name, data.showinstalledsoftdetailsyswisedata[i].ip, data.showinstalledsoftdetailsyswisedata[i].software, data.showinstalledsoftdetailsyswisedata[i].version, data.showinstalledsoftdetailsyswisedata[i].publisher, data.showinstalledsoftdetailsyswisedata[i].installationdate, data.showinstalledsoftdetailsyswisedata[i].location]);
                }
                var otable = $("#tblsysgenrpt").DataTable({
                    data: data1, scrollX: !0, searching: !1, dom: "<'top'lB>rt<'bottom'ip><'clear'>", buttons: ["colvis", { text: "PDF", extend: "pdfHtml5", download: "open", filename: "Software Information_" + today, orientation: "portrait", pageSize: "A4", exportOptions: { columns: ":visible", search: "applied", order: "applied" }, customize: function (t) { t.content.splice(0, 1); var e = new Date, n = e.getDate() + "-" + (e.getMonth() + 1) + "-" + e.getFullYear(); t.pageMargins = [20, 60, 20, 30], t.defaultStyle.fontSize = 7, t.styles.tableHeader.fontSize = 7, t.header = function () { return { columns: [{ margin: [0, -5, 30, 15], alignment: "left", width: 100, image: "data:image/png;base64," + pdflogo }, { margin: [-10, 10, 10, 0], alignment: "center", width: 410, text: "Software Information Report", fontSize: 12 }, { alignment: "right", fontSize: 14, text: "" }], margin: 20 } }, t.footer = function (t, e) { return { columns: [{ alignment: "left", text: ["Created on: ", { text: n.toString() }] }, { alignment: "right", text: ["page ", { text: t.toString() }, " of ", { text: e.toString() }] }], margin: 20 } }; var a = { hLineWidth: function (t) { return .5 }, vLineWidth: function (t) { return .5 }, hLineColor: function (t) { return "#aaa" }, vLineColor: function (t) { return "#aaa" }, paddingLeft: function (t) { return 4 }, paddingRight: function (t) { return 4 } }; t.content[0].layout = a } }, 'excel'],
                    columns: [{ title: "Branch/ Unit" }, { title: "System Name" }, { title: "IP Address" }, { title: "Software name" }, { title: "Version" }, { title: "Publisher" }, { title: "Installed On" }, { title: "Install Location" }]
                });
                $(".table").css({ "width": "100%" });
                $(".dataTables_scrollHeadInner ").css({ "width": "100%" });
            }
        });
    }


	function cleardata() {
        syscheck = "";
        document.getElementById("key_check").checked = false;
        document.getElementById("system_gen_check").checked = false;
        document.getElementById("soft_gen_check").checked = false;
        document.getElementById("system_date").value = '';
        document.getElementById("gen_system_date").value = '';
        document.getElementById("date").value = '';

        document.getElementById("add_systemname1").value = '';
        document.getElementById("add_system_chk1").checked = false;
        $('#selectsys').show();
        $('#inputsystemname').hide();

        document.getElementById("add_systemname2").value = '';
        document.getElementById("add_system_chk2").checked = false;
        $('#selectsys2').show();
        $('#inputsystemname2').hide();

        document.getElementById("add_systemname3").value = '';
        document.getElementById("add_system_chk3").checked = false;
        $('#selectsys3').show();
        $('#inputsystemname3').hide();

        var SetDatadevice = $('#System1');
        //var SetDataip = $('#IP1');
        jQuery('#System1').html('');
        //jQuery('#IP1').html('');
        var devicedata = "<option value='-1'>Select System Name</option>";
        //var ipdata = "<option value='-1'>Select IP Address</option>";
        SetDatadevice.append(devicedata);
        //SetDataip.append(ipdata);
        document.getElementById("System1").value = '-1';
        document.getElementById("IP1").value = '';
        document.getElementById("DrpOU1").value = '-1';
        var SetDatadevice = $('#System2');
        //var SetDataip = $('#IP2');
        jQuery('#System2').html('');
        //jQuery('#IP2').html('');
        var devicedata = "<option value='-1'>Select System Name</option>";
        //var ipdata = "<option value='-1'>Select IP Address</option>";
        SetDatadevice.append(devicedata);
        //SetDataip.append(ipdata);
        document.getElementById("type2").value = '-1';
        document.getElementById("IP2").value = '';
        document.getElementById("System2").value = '-1';
        document.getElementById("DrpOU2").value = '-1';
        document.getElementById("serachvalue2").value = '';
        software = "";
        var SetDatadevice = $('#System3');
        //var SetDataip = $('#IP3');
        jQuery('#System3').html('');
        //jQuery('#IP3').html('');
        var devicedata = "<option value='-1'>Select System Name</option>";
        //var ipdata = "<option value='-1'>Select IP Address</option>";
        SetDatadevice.append(devicedata);
        //SetDataip.append(ipdata);
        document.getElementById("IP3").value = '';
        document.getElementById("System3").value = '-1';
        document.getElementById("serachsoft").value = '';
        document.getElementById("DrpOU3").value = '-1';
        var SetDatadevice = $('#System4');
        //var SetDataip = $('#IP4');
        jQuery('#System4').html('');
        //jQuery('#IP4').html('');
        var devicedata = "<option value='-1'>Select System Name</option>";
        //var ipdata = "<option value='-1'>Select IP Address</option>";
        SetDatadevice.append(devicedata);
        //SetDataip.append(ipdata);
        document.getElementById("type4").value = '-1';
        document.getElementById("IP4").value = '';
        document.getElementById("System4").value = '-1';
        document.getElementById("DrpOU4").value = '-1';
        document.getElementById("searchsysgenrpt").value = '';
        var devicedata = "<option value='-1'>Select System Name</option>";
        //var ipdata = "<option value='-1'>Select IP Address</option>";
        SetDatadevice.append(devicedata);
        //SetDataip.append(ipdata);
    }
    $('#key_text').hide();
    $('#key_check').on('click', function () {
        if ($(this).is(':checked')) {
            $('#key_select').hide();
            $('#key_text').show();
            dateselect();
        }
        else {
            $('#key_select').show();
            $('#key_text').hide();
        }
    });

    $('#system_gen_date').hide();
    $('#system_gen_check').on('click', function () {
        if ($(this).is(':checked')) {
            $('#system_gen_text').hide();
            $('#system_gen_date').show();
            dateselect();
        }
        else {
            $('#system_gen_text').show();
            $('#system_gen_date').hide();
        }
    });

    $('#soft_gen_date').hide();
    $('#soft_gen_check').on('click', function () {
        if ($(this).is(':checked')) {
            $('#soft_gen_text').hide();
            $('#soft_gen_date').show();
            dateselect();
        }
        else {
            $('#soft_gen_text').show();
            $('#soft_gen_date').hide();
        }
    });
</script>

<script>
    //checkbox input hide & show
    $('#inputsystemname').hide();
    $('#add_system_chk').on('click', function () {
        if ($(this).is(':checked')) {
            $('#selectsys').hide();
            $('#inputsystemname').show();
        }
        else {
            $('#selectsys').show();
            $('#inputsystemname').hide();
            document.getElementById('add_systemname').value = "";
        }
    });
</script>
<script>
    //checkbox input hide & show
    $('#inputsystemname2').hide();
    $('#add_system_chk2').on('click', function () {
        if ($(this).is(':checked')) {
            $('#selectsys2').hide();
            $('#inputsystemname2').show();
        }
        else {
            $('#selectsys2').show();
            $('#inputsystemname2').hide();
            document.getElementById('add_systemname2').value = "";
        }
    });
</script>
<script>
    //checkbox input hide & show
    $('#inputsystemname3').hide();
    $('#add_system_chk3').on('click', function () {
        if ($(this).is(':checked')) {
            $('#selectsys3').hide();
            $('#inputsystemname3').show();
        }
        else {
            $('#selectsys3').show();
            $('#inputsystemname3').hide();
            document.getElementById('add_systemname3').value = "";
        }
    });
</script>