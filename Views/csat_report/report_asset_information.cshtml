
@{
    ViewData["Title"] = "report_asset_information";
    Layout = "~/Views/Shared/ownyit_main_page.cshtml";
}

<script type="text/javascript">

    $(document).ready(function () {
        $('#search_type').on('change', function () {
            if (this.value == '1') {
                $("#system_info").show();
            }
            else {
                $("#system_info").hide();
            }
            if (this.value == '2') {
                $("#hardware_info").show();
            }
            else {
                $("#hardware_info").hide();
            }
            if (this.value == '3') {
                $("#purchase_info").show();
            }
            else {
                $("#purchase_info").hide();
            }
            if (this.value == '4') {
                $("#insurance_info").show();
            }
            else {
                $("#insurance_info").hide();
            }
        });
    });

    var now = new Date();
    var day = ("0" + now.getDate()).slice(-2);
    var month = ("0" + (now.getMonth() + 1)).slice(-2);
    var today = now.getFullYear() + "-" + (month) + "-" + (day);
</script>
<!--date-time picker-->
<script type="text/javascript">
    var startdate = '';
    var enddate = '';
    $(function () {
        $('input[name="datefilter"]').daterangepicker({
            // opens: 'left',
            autoUpdateInput: false,
            startDate: moment().startOf('hour').add(-24, 'hour'),
            endDate: moment().startOf('hour'),
            locale: {
                format: 'DD/MM/YYYY',
                cancelLabel: 'Clear',

            }
        });

        $('input[name="datefilter"]').on('apply.daterangepicker', function (ev, picker) {
            // debugger;
            $(this).val(picker.startDate.format('DD/MM/YYYY') + ' - ' + picker.endDate.format('DD/MM/YYYY '));
            startdate = picker.startDate.format('DD/MM/YYYY');
            enddate = picker.endDate.format('DD/MM/YYYY');
        });

        $('input[name="datefilter"]').on('cancel.daterangepicker', function (ev, picker) {
            $(this).val('');
        });

        $(window).bind('scroll', function () {
            $(".daterangepicker").hide();
        });
    });


</script>

<div class="row">

    <div class="ibox float-e-margins ">
        <div class="ibox-content" style="padding:4px;">
            <ul class="breadcrumb" style="margin-bottom:0px;">
                <li>
                    @Html.ActionLink("Reports", "report_agent_information", "csat_report")
                    <i class="icon-angle-right"></i>
                </li>
                <li> Asset Information  </li>
            </ul>
        </div>
    </div>


    <!--side menu-->
    <div class="col-sm-2 col-md-2 col-lg-2 no_padding">
        <div class="ibox float-e-margins ">
            <div class="ibox-content sidemenu">
                @{
                    @Html.Partial("csat_report_menu");
                }
            </div>
        </div>
    </div>
    <!--side menu end-->
    <div class="col-sm-10 col-md-10 col-lg-10">
        <div class="ibox float-e-margins" style="margin-bottom: 10px;">
            <div class="ibox-content">
                <div class="row">
                    <div class="col-sm-12 col-md-12 col-lg-12">

                        <div class="row">
                            <div class="col-xs-12">
                                <form class="form-horizontal" method="post">
                                    <div class="form-group">
                                        <label for="nameField" style="margin-top: -5px;background-color: #fff;text-align: center;color: #3D93C8;width: 120px;" class="col-xs-2 form_label">&nbsp;&nbsp;Advance Search&nbsp;&nbsp;</label>
                                        <div class="col-xs-10">
                                        </div>
                                    </div>

                                </form>
                            </div>
                        </div>
                    </div>

                </div>

                <div class="col-sm-12 col-md-12 col-lg-12">
                    <div class="row">
                        <div class="col-xs-12">
                            <form class="form-horizontal" method="post" name="frm_assetinform_report" id="frm_assetinform_report">
                                <div class="form-group">
                                    <label for="nameField" class="col-xs-1  form_label">Branch/ Unit</label>
                                    <div class="col-xs-4">
                                        <select class="form-control col-sm-3 col-lg-3 col-md-3" name="Branch/Unit" id="drpou">
                                            <option value='-1'>Select Branch/ Unit</option>
                                        </select>
                                    </div>
                                    <label for="nameField" class="col-xs-1 form_label">System Name</label>
                                    <div class="col-xs-2" id="selectsys">
                                        <select class="form-control col-sm-3 col-lg-3 col-md-3" name="Device" id="drpdevice">
                                            <option value='-1'>Select System Name</option>
                                        </select>
                                    </div>
                                    <div class="col-xs-2" id="inputsystemname">
                                        <input type="text" class="form-control col-sm-3 col-lg-3 col-md-3" name="add_systemname" id="add_systemname">
                                    </div>
                                    <div class="col-xs-1">
                                        <input type="checkbox" class="form-check-input" id="add_system_chk" name="add_system_chk" style="width:20px;height:25px;">
                                    </div>
                                    <label for="nameField" class="col-xs-1 form_label" style="margin-left:-48px;">IP Address</label>
                                    <div class="col-xs-2">
                                        <input type="text" class="form-control col-sm-3 col-lg-3 col-md-3" placeholder="" name="drpip" id="drpip">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="nameField" class="col-xs-1">Period Type</label>
                                    <div class="col-xs-2">
                                        <select class="form-control col-sm-2 col-lg-2 col-md-2" name="Period type" id="Periodtype">
                                            <option value="-1">Select Period Type</option>
                                            <option value="warranty_from_date">Warranty Period</option>
                                            <option value="amc_from_date">AMC  Period</option>
                                            <option value="insurance_from_date">Insurance Period</option>
                                        </select>
                                    </div>
                                    <div class="col-xs-3">
                                        <input type="text" name="datefilter" class="form-control" placeholder="DD/MM/YYYY -  DD/MM/YYYY " id="date" readonly>
                                    </div>
                                </div>
                                <div class="form-group">

                                    <label for="nameField" class="col-xs-1">Search</label>
                                    <div class="col-xs-2">
                                        <select class="form-control col-sm-2 col-lg-2 col-md-2" name=" Info type" id='search_type'>
                                            <option value="1">System Info</option>
                                            <option value="2">Hardware Info</option>
                                            <option value="3">Purchase Info</option>
                                            <option value="4">Insurance Info</option>
                                        </select>
                                    </div>
                                    <div class="col-xs-2">
                                        <div id="system_info">
                                            <select class="form-control col-sm-2 col-lg-2 col-md-2" name="type" id="type1">
                                                <option value="-1">-- Select --</option>
                                                <option value="mac">MAC</option>
                                                <option value="login_user">User Name</option>
                                                <option value="departmentname">Department Name</option>
                                                <option value="device_type">System Type</option>
                                                <option value="emailid">Email Address</option>
                                            </select>
                                        </div>
                                        <div id="hardware_info" style="display:none;">
                                            <select class="form-control col-sm-2 col-lg-2 col-md-2" name="type" id="type2">
                                                <option value="-1">-- Select --</option>
                                                <option value="Motherboard">Motherboard</option>
                                                <option value="Processor">Processor</option>
                                                <option value="Manufacture">Manufacturer</option>
                                                <option value="Model">Model</option>
                                                <option value="os">OS Name</option>
                                                <option value="osdate">OS Installation Date</option>
                                                <option value="hdd">HDD List</option>
                                                <option value="hddsize">HDD Size</option>
                                                <option value="slotcount">RAM Slots</option>
                                                <option value="ram">RAM Type</option>
                                                <option value="ramsize">RAM Size</option>
                                                <option value="Keyboard">Key Board</option>
                                                <option value="Mouse">Mouse</option>
                                                <option value="Floppy">Floppy Drive</option>
                                                <option value="CDROM">CD ROM</option>
                                                <option value="Monitor">Monitor</option>
                                            </select>
                                        </div>
                                        <div id="purchase_info" style="display:none;">
                                            <select class="form-control col-sm-2 col-lg-2 col-md-2" name="type" id="type3">
                                                <option value="-1">-- Select --</option>
                                                <option value="cost">Purchase Cost</option>
                                                <option value="order_no">Purchase Order No</option>
                                                <option value="invoice_no">Invoice No</option>
                                                <option value="attachment">Attachment</option>
                                                <option value="remark">Remark</option>
                                            </select>
                                        </div>
                                        <div id="insurance_info" style="display:none;">
                                            <select class="form-control col-sm-2 col-lg-2 col-md-2" name="type" id="type4">
                                                <option value="-1">-- Select --</option>
                                                <option value="amc_vendor_name"> AMC Vendor Name</option>
                                                <option value="amc_cost">AMC Cost</option>
                                                <option value="vendor_location">Vendor Location</option>
                                                <option value="insurance_party">Insurance Party</option>
                                                <option value="insurance_party_name">Insurance Party Name</option>
                                                <option value="insurance_amount">Insurance Amount</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-xs-3">
                                        <div class="input-group">
                                            <input type="search" class="form-control" placeholder="Search" id="txtsearch" name="txtsearch" autocomplete="off">
                                            <div class="input-group-btn">
                                                <button class="btn btn-default" type="button" onclick="GetAssetData()">
                                                    <i class="glyphicon glyphicon-search"></i>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="pull-left col-xs-1">
                                        <input type="button" class="btn btn-primary" value="Show" onclick="GetAssetData()">
                                    </div>
                                </div>

                            </form>

                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!--form  content end-->
        <!--agent report form end-->
        <!--agent report Datatable start-->
        <div class="row ibox2">
            <div class="col-sm-12 col-md-12 col-lg-12 ibox2-content" id="divasset_div">
                <table id="divasset" class="table table-striped table-bordered display nowrap" width="100%"></table>
            </div>
        </div>

    </div>
    <div class="space_bottom">&nbsp;</div>
</div>
<script>

    $(document).ready(function () {
        validateSingleForm("#frm_assetinform_report");
    });
</script>
<script>
 $.get('@Url.Content("~/csat_report/GetOU/")', null, DataBind)
    function DataBind(data) {
        $("#overlay").show();
        $("#overlay").fadeIn(300);
       // debugger;
        var url = '@Url.Content("~/csat_report/GetOU/")';
        $.ajax({
            type: "POST",
            url: url,
            success: function (data) {
        var SetData = $('#drpou');
        jQuery('#drpou').html('');
        var oudata = "<option value='-1'>Select Branch/ Unit</option>";
        for (var i = 0; i < data.ou.length; i++) {
            oudata += "<option value='" + data.ou[i].ouid + "'>" + data.ou[i].ouname + "</option>";
        }
        SetData.append(oudata);
            }
        }).done(function () {
            setTimeout(function () {
                $("#overlay").fadeOut(300);
            }, 500);
        });
    }
    var ouidvalue = '';
$("#drpou").change(function () {
        ouidvalue = this.value;
        var url = '@Url.Content("~/csat_report/Get_syatemname_ip?ouid=")' + this.value;
        $.ajax({
        type: "POST",
        url: url,
        success: function (data) {
        // debugger;
        var SetDatadevice = $('#drpdevice');
        //var SetDataip = $('#drpip');
        jQuery('#drpdevice').html('');
        //jQuery('#drpip').html('');

        var devicedata = "<option value='-1'>Select System Name</option>";
        //var ipdata = "<option value='-1'>Select IP Address</option>";

        for (var i = 0; i < data.systemip.length; i++) {
           devicedata+="<option value='"+ data.systemip[i].device_name +"'>"+ data.systemip[i].device_name +"</option>";
           //ipdata+="<option value='"+ data.systemip[i].ip +"'>"+ data.systemip[i].ip +"</option>";
            }
            SetDatadevice.append(devicedata);
            //SetDataip.append(ipdata);
        }

        });

    });

    $("#Periodtype").change(function () {
        document.getElementById("date").value = '';
    })

    function GetAssetData()
    {
        var $valid = $('#frm_assetinform_report').valid();
        if (!$valid) {
            $validatorform.focusInvalid();
            return false;
        } else {
            $("#overlay").show();
            $("#overlay").fadeIn(300);
            startdate = $('#date').data('daterangepicker').startDate.format('DD/MM/YYYY');
            enddate = $('#date').data('daterangepicker').endDate.format('DD/MM/YYYY');
            var fieldsearch = "";
            var fieldsearchval = "";
            var ip = document.getElementById('drpip').value;
            //var device = document.getElementById('drpdevice').value;
            var device = document.getElementById('add_systemname').value;
            if (device== "") {
                device = document.getElementById("drpdevice").value;
            }
            var periodduration = document.getElementById('Periodtype').value;
            var fieldtype = document.getElementById('search_type').value;
            if (fieldtype == "1")
                fieldsearch = document.getElementById('type1').value;
            if (fieldtype == "2")
                fieldsearch = document.getElementById('type2').value;
            if (fieldtype == "3")
                fieldsearch = document.getElementById('type3').value;
            if (fieldtype == "4")
                fieldsearch = document.getElementById('type4').value;
            fieldsearchval = document.getElementById('txtsearch').value;
            var url = '@Url.Content("~/csat_report/GetAssetInfoData?ouid=")' + ouidvalue + '&device=' + device + '&ip=' + ip + '&startdate=' + startdate + '&enddate=' + enddate + '&periodduration=' + periodduration + '&fieldserach=' + fieldsearch + '&valuesearch=' + fieldsearchval;
            $.ajax({
                type: "POST",
                url: url,
                success: function (data) {
                    var dataclear = document.getElementById('divasset_div');
                    dataclear.innerHTML = '&nbsp;';
                    $('#divasset_div').append("<table id='divasset' class='table table-striped table-bordered' width='100%'></table>");
                    otable = document.getElementById('divasset');
                    var data1 = [];
                    for (var i = 0; i < data.getsysinfo.length; i++) {
                        data1.push([data.getsysinfo[i].ou_longname, data.getsysinfo[i].device_name, data.getsysinfo[i].virtual_name, data.getsysinfo[i].ip, data.getsysinfo[i].mac, data.getsysinfo[i].login_user, data.getsysinfo[i].departmentname, data.getsysinfo[i].device_type, data.getsysinfo[i].bios_date, data.getsysinfo[i].emailid, data.getsysinfo[i].motherboard, data.getsysinfo[i].processor, data.getsysinfo[i].manufacture, data.getsysinfo[i].model, data.getsysinfo[i].service_tag, data.getsysinfo[i].os, data.getsysinfo[i].osarchitecture, data.getsysinfo[i].osversion, data.getsysinfo[i].osdate, data.getsysinfo[i].oslicense, data.getsysinfo[i].antivirus, data.getsysinfo[i].printer, data.getsysinfo[i].hddsize, data.getsysinfo[i].hdd_total_drive, data.getsysinfo[i].disk_c, data.getsysinfo[i].disk_d, data.getsysinfo[i].disk_e, data.getsysinfo[i].disk_f, data.getsysinfo[i].slotcount, data.getsysinfo[i].ram, data.getsysinfo[i].ramsize, data.getsysinfo[i].keyboard, data.getsysinfo[i].mouse, data.getsysinfo[i].monitor, data.getsysinfo[i].total_software, data.getsysinfo[i].total_shared, data.getsysinfo[i].total_user, data.getsysinfo[i].floppy, data.getsysinfo[i].cdrom, data.getsysinfo[i].cost, data.getsysinfo[i].order_no, data.getsysinfo[i].invoice_no, data.getsysinfo[i].attachment, data.getsysinfo[i].remark, data.getsysinfo[i].warranty_from_date, data.getsysinfo[i].warranty_to_date, data.getsysinfo[i].amc_from_date, data.getsysinfo[i].amc_to_date, data.getsysinfo[i].amc_vendor_name, data.getsysinfo[i].amc_cost, data.getsysinfo[i].vendor_location, data.getsysinfo[i].insurance_party, data.getsysinfo[i].insurance_party_name, data.getsysinfo[i].insurance_from_date, data.getsysinfo[i].insurance_to_date, data.getsysinfo[i].insurance_amount]);
                    }
                    var otable = $("#divasset").DataTable({
                        data: data1, scrollX: !0, searching: !1, dom: "<'top'lB>rt<'bottom'ip><'clear'>", buttons: [{ extend: 'colvisGroup', text: 'System Info', show: [0, 1, 2, 3, 4, 5, 6, 8], hide: [7, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54], bVisible: true }, { extend: 'colvisGroup', text: 'Hardware Info', show: [0, 1, 2, 7, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 36, 37], hide: [3, 4, 5, 6, 8, 33, 34, 35, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54], }, { extend: 'colvisGroup', text: 'Purchase Info', show: [0, 1, 2, 38, 39, 40, 41, 42], hide: [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54], }, { extend: 'colvisGroup', text: 'Insurance Info', show: [0, 1, 2, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54], hide: [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42], }, { extend: 'colvisGroup', text: 'Show all', show: ':hidden', }, "colvis", { text: "PDF", extend: "pdfHtml5", download: "open", filename: "Asset Information Report_" + today, orientation: "portrait", pageSize: "A4", exportOptions: { columns: ":visible", search: "applied", order: "applied" }, customize: function (t) { t.content.splice(0, 1); var e = new Date, n = e.getDate() + "-" + (e.getMonth() + 1) + "-" + e.getFullYear(); t.pageMargins = [20, 60, 20, 30], t.defaultStyle.fontSize = 7, t.styles.tableHeader.fontSize = 7, t.header = function () { return { columns: [{ margin: [0, -5, 30, 15], alignment: "left", width: 100, image: "data:image/png;base64," + pdflogo }, { margin: [-10, 10, 10, 0], alignment: "center", width: 410, text: "Asset Information Report", fontSize: 12 }, { alignment: "right", fontSize: 14, text: "" }], margin: 20 } }, t.footer = function (t, e) { return { columns: [{ alignment: "left", text: ["Created on: ", { text: n.toString() }] }, { alignment: "right", text: ["page ", { text: t.toString() }, " of ", { text: e.toString() }] }], margin: 20 } }; var a = { hLineWidth: function (t) { return .5 }, vLineWidth: function (t) { return .5 }, hLineColor: function (t) { return "#aaa" }, vLineColor: function (t) { return "#aaa" }, paddingLeft: function (t) { return 4 }, paddingRight: function (t) { return 4 } }; t.content[0].layout = a } }, 'excel'],
                        columns: [{ title: "Branch/ Unit" }, { title: "System Name" }, { title: "Virtual Name" }, { title: "IP Address" }, { title: "MAC Address" }, { title: "Username" }, { title: "Department Name" }, { title: "System Type" }, { title: "BIOS Date" }, { title: "Email Address" }, { title: "Motherboard" }, { title: "Processor" }, { title: "Manufacturer" }, { title: "Model" }, { title: "Service Tag" }, { title: "OS Name" }, { title: "OS Architecture" }, { title: "OS Version" }, { title: "OS Installation Date" }, { title: "OS License Status" }, { title: "Antivirus" }, { title: "Printer" }, { title: "HDD Size" }, { title: "HDD Total Drive" }, { title: "DiskUtilization C" }, { title: "DiskUtilization D" }, { title: "DiskUtilization E" }, { title: "DiskUtilization F" }, { title: "RAM Slots" }, { title: "RAM Type" }, { title: "RAM Size" }, { title: "Key Board" }, { title: "Mouse" }, { title: "Monitor" }, { title: "Total Software" }, { title: "Total Shared" }, { title: "Total User" }, { title: "Floppy Drive" }, { title: "CD ROM" }, { title: "Purchase Cost" }, { title: "Purchase Order No" }, { title: "Invoice No" }, { title: "Attachment" }, { title: "Remark" }, { title: "Warranty Period From" }, { title: "Warranty Period To" }, { title: "AMC From" }, { title: "AMC TO" }, { title: "AMC Vendor Name" }, { title: "AMC Cost" }, { title: "Vendor Location" }, { title: "Insurance Party" }, { title: "Insurance Party Name" }, { title: "Insurance From" }, { title: "Insurance To" }, { title: "Insurance Amount" }]
                    });
                    $(".table").css({ "width": "100%" });
                    $(".dataTables_scrollHeadInner ").css({ "width": "100%" });
                }
            }).done(function () {
                setTimeout(function () {
                    $("#overlay").fadeOut(300);
                }, 500);
            });
        }
    }
</script>
<script>
    //checkbox input hide & show
    $('#inputsystemname').hide();
    $('#add_system_chk').on('click', function () {
        if ($(this).is(':checked')) {
            $('#selectsys').hide();
            $('#inputsystemname').show();
        }
        else {
            $('#selectsys').show();
            $('#inputsystemname').hide();
            document.getElementById('add_systemname').value = "";
        }
    });
</script>
