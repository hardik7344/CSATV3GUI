
@{
    ViewData["Title"] = "report_antivirus_update";
    Layout = "~/Views/Shared/ownyit_main_page.cshtml";
}
<!--delete_range device model  content-->

<div class="modal fade" id="add_antivirus" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog modal-sm" style="width:650px">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" onclick="cleardata()" aria-hidden="true">&times;</button>
                <h6 class="modal-title">Add Antivirus</h6>
            </div>
            <div class="modal-body">
                <!--form  content-->
                <div class="row">
                    <div class="col-sm-12 col-md-12 col-lg-12">

                        <div class="row">
                            <div class="col-xs-12">
                                <form class="form-horizontal" method="post">
                                    <div class="form-group">
                                        <label for="nameField" class="col-xs-3 form_label">Antivirus Name</label>
                                        <div class="col-xs-9">
                                            <input type="text" name="antivirus_name" id="antivirus_name" class="form-control" placeholder="Enter antivirus name" />
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="nameField" class="col-xs-3 form_label">Service Name</label>
                                        <div class="col-xs-9">
                                            <input type="text" name="service_name" id="service_name" class="form-control" placeholder="Enter antivirus service name" />
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="nameField" class="col-xs-3 form_label"></label>
                                        <div class="col-xs-9">
                                            <input type="button" class="btn btn-primary" value="Add Antivirus" id="btnsaveiprange" onclick="fn_add_antivirus()" />
                                            <input type="button" class="btn btn-default" data-dismiss="modal" value="Cancel" onclick="cleardata()" />
                                        </div>
                                    </div>
                                </form>
                                <div class="row">

                                    <div class="col-sm-12 col-md-12 col-lg-12 ibox2-content" id="divdisantivirus_div">
                                        <table id="divdisantivirus" class="table table-striped table-bordered display nowrap" width="100%"></table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>  <!--form  content end-->
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div>
<div class='modal fade ' id='delete_antivirus' tabindex='-1' role='dialog' aria-labelledby='myModalLabel' aria-hidden='true'>
    <div class='modal-dialog  modal-small'>
        <div class='modal-content '>
            <div class='modal-header'>
                <button type='button' class='close' data-dismiss='modal' aria-hidden='true'>&times;</button>
                <h6 class='modal-title'>Conformation </h6>
            </div>
            <div class='modal-body' style="height: 100px;">
                <!--form  content-->
                <div class='row'>
                    <div class='col-sm-12 col-md-12 col-lg-12'>

                        <div class='row'>
                            <div class='col-xs-12'>
                                <form class='form-horizontal' method='post'>
                                    <div class='form-group'>

                                        <label for='nameField' class='col-xs-12'>
                                            <i class='glyphicon glyphicon-exclamation-sign delete_msg'></i>
                                            <span style='font-weight:normal;margin-left:30px;'>Are you sure you want to delete this record?</span>
                                        </label>

                                    </div>
                                    <div class='form-group'>
                                        <label for='nameField' class='col-xs-4'></label>
                                        <div class='col-xs-6'>
                                            <input type='button' class='btn btn-primary' name='yes' value='Yes' id="btndeleteantivirus" />
                                            <input type='button' class='btn btn-default' data-dismiss="modal" name='no' value='No' />
                                        </div>
                                    </div>
                                </form>
                            </div>

                        </div>

                    </div>
                </div>  <!--form  content end-->
            </div>

        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div><!-- /.modal -->
<div class="row row_top_margin">

    <!--side menu-->
    <div class="col-sm-2 col-md-2 col-lg-2 no_padding">
        <div class="ibox float-e-margins ">
            <div class="ibox-content sidemenu">
                @{
                    @Html.Partial("csat_report_menu");
                }
            </div>
        </div>
    </div>
    <!--side menu end-->

    <div class="col-sm-10 col-md-10 col-lg-10">
        <div class="ibox float-e-margins ">
            <div class="ibox-content" style="padding:4px;">
                <div class="pull-right form_label btn_top_margin">
                    <button class="btn btn-primary btn-md day" data-toggle="modal" data-target="#add_antivirus" onclick="show_antiviruslist()">Add Antivirus</button>
                </div>
                <ul class="breadcrumb" style="margin-bottom:0px;">
                    <li>
                        @Html.ActionLink("Reports", "report_agent_information", "csat_report")
                        <i class="icon-angle-right"></i>
                    </li>
                    <li> Antivirus Update </li>
                </ul>
            </div>
        </div>

        <div class="ibox float-e-margins" style="margin-bottom: 10px;">
            <div class="ibox-content">
                <div class="row">
                    <div class="col-sm-12 col-md-12 col-lg-12">

                        <div class="row">
                            <div class="col-xs-12">
                                <form class="form-horizontal" method="post">
                                    <div class="form-group">
                                        <label for="nameField" style="margin-top: -5px;background-color: #fff;text-align: center;color: #3D93C8;width: 120px;" class="col-xs-2 form_label">&nbsp;&nbsp;Advance Search&nbsp;&nbsp;</label>
                                        <div class="col-xs-10">
                                        </div>
                                    </div>

                                </form>
                            </div>
                        </div>
                    </div>

                </div>
                <div class="row">
                    <div class="col-sm-12 col-md-12 col-lg-12">

                        <div class="row">
                            <div class="col-xs-12">
                                <form class="form-horizontal" method="post">
                                    <div class="form-group">
                                        <label for="nameField" class="col-xs-1 form_label">Branch/ Unit</label>
                                        <div class="col-xs-4">
                                            <select class="form-control col-sm-3 col-lg-3 col-md-3" name="Branch/Unit" id="DrpOU13">
                                                <option value='-1'>Select Branch/ Unit</option>
                                            </select>
                                        </div>
                                        <label for="nameField" class="col-xs-1 form_label">System Name</label>
                                        <div class="col-xs-3">
                                            <select class="form-control col-sm-2 col-lg-2 col-md-2" name="System" id="drpDevice13">
                                                <option value="-1">Select System Name</option>
                                            </select>
                                        </div>
                                        <label for="nameField" class="col-xs-1 form_label">IP Address</label>
                                        <div class="col-xs-2">
                                            <input type="text" class="form-control col-sm-3 col-lg-3 col-md-3" placeholder="" name="ip" id="drpip13">
                                            @*<select class="form-control col-sm-2 col-lg-2 col-md-3" name="ip adrss" id="drpip13">
                                                    <option value="-1">Select IP Address</option>
                                                </select>*@
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="nameField" class="col-xs-1 form_label">Date Range</label>
                                        <div class="col-xs-4">
                                            <input type="text" name="avdatefilter" class="form-control" placeholder="DD/MM/YYYY hh:mm:ss - DD/MM/YYYY hh:mm:ss" id="avdate">
                                        </div>
                                        <label for="nameField" class="col-xs-1 form_label">Search</label>
                                        <div class="col-xs-2">
                                            <select class="form-control col-sm-2 col-lg-3 col-md-3" id="drpsearch13">
                                                <option value="-1">Select search</option>
                                                <option value="antivirus_name">Antivirus name</option>
                                                <option value="agent_version">Version</option>
                                            </select>
                                        </div>
                                        <div class="col-xs-2">
                                            <div class="input-group">
                                                <input type="search" class="form-control" placeholder="Search" id="searchvalue">
                                                <div class="input-group-btn">
                                                    <button class="btn btn-default" type="button" onclick="antivirusdatareport()">
                                                        <i class="glyphicon glyphicon-search"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="pull-left col-xs-1">
                                            <input type="button" class="btn btn-primary" value="Show" onclick="antivirusdatareport()">
                                        </div>
                                    </div>


                                </form>

                            </div>
                        </div>


                    </div>
                </div>


                <div class="row">

                    <div class="col-sm-12 col-md-12 col-lg-12 ibox2-content" id="divantivirusreport_div">
                        <table id="divantivirusreport" class="table table-striped table-bordered display nowrap" width="100%"></table>
                    </div>
                </div>
            </div>

        </div>
        <div class="space_bottom">&nbsp;</div>
    </div>
</div>
<script>
    function fn_add_antivirus() {
        //debugger;
        antivirus_name = document.getElementById("antivirus_name").value;
        service_name = document.getElementById("service_name").value;
        if (antivirus_name != "" && service_name != "") {
            var url1 = '@Url.Content("~/csat_report/AddAntivirus?antivirus_name=")' + antivirus_name + '&service_name=' + service_name;
            $.ajax({
                type: "POST",
                url: url1,
                dataType: "json",
                success: function (data) {
                    //debugger;
                    alert(data);
                    show_antiviruslist();
                    document.getElementById("antivirus_name").value = "";
                    document.getElementById("service_name").value = "";
                }
            });
        }
        else {
            alert("Please enter antivirus details");
        }

    }
    function show_antiviruslist()
        {
            $.ajax({
	        type : "POST",
                url: '@Url.Content("~/csat_report/Getaddantivirus")',
                success: function (response) {
                    //debugger;
                    var agent_divclear = document.getElementById('divdisantivirus_div');
                    agent_divclear.innerHTML = '&nbsp;';
                    $('#divdisantivirus_div').append("<table id='divdisantivirus' class='table table-striped table-bordered' width='100%'></table>");
                    otable = document.getElementById('divdisantivirus');
                    var data1 = [];
                    for (var i = 0; i < response.data.length; i++) {
                        var delete_div = "<i class=' glyphicon glyphicon-trash manage_icon ' type='button' data-toggle='modal'  title='Delete' onclick=deleteantivirusname('"+encodeURIComponent(response.data[i].antivirus_service_name)+"')></i>";
                        data1.push([response.data[i].antivirus_name, response.data[i].antivirus_service_name, delete_div]);
                        }
                    var otable = $("#divdisantivirus").DataTable({
                            data: data1, scrollX: !0, searching: !1, dom: "<'top'lB>rt<'bottom'ip><'clear'>", buttons: ["colvis", { text: "PDF", extend: "pdfHtml5", download: "open", filename: "Antivirus_Update_Report_" + today, orientation: "portrait", pageSize: "A4", exportOptions: { columns: ":visible", search: "applied", order: "applied" }, customize: function (t) { t.content.splice(0, 1); var e = new Date, n = e.getDate() + "-" + (e.getMonth() + 1) + "-" + e.getFullYear(); t.pageMargins = [20, 60, 20, 30], t.defaultStyle.fontSize = 7, t.styles.tableHeader.fontSize = 7, t.header = function () { return { columns: [{ margin: [0, -5, 30, 15], alignment: "left", width: 100, image: "data:image/png;base64," + pdflogo }, { margin: [-10, 10, 10, 0], alignment: "center", width: 410, text: "Antivirus Update Report", fontSize: 12 }, { alignment: "right", fontSize: 14, text: "" }], margin: 20 } }, t.footer = function (t, e) { return { columns: [{ alignment: "left", text: ["Created on: ", { text: n.toString() }] }, { alignment: "right", text: ["page ", { text: t.toString() }, " of ", { text: e.toString() }] }], margin: 20 } }; var a = { hLineWidth: function (t) { return .5 }, vLineWidth: function (t) { return .5 }, hLineColor: function (t) { return "#aaa" }, vLineColor: function (t) { return "#aaa" }, paddingLeft: function (t) { return 4 }, paddingRight: function (t) { return 4 } }; t.content[0].layout = a } }, 'excel'],
                        columns: [{ title: "Antivirus Name", width: '90px' }, { title: "Service name", width: '90px' }, { title: "Delete", orderable: false, className: 'dt-center', width: '30px' }],
                    });
                    $(".table").css({ "width": "100%" });
                    $(".dataTables_scrollHeadInner ").css({ "width": "100%" });
                }
	        });
        }
</script>
<script>
     // Delete Scan IP Range
    var servicename = "";
    function deleteantivirusname(servicenames) {
      // debugger;
        servicename = decodeURIComponent(servicenames)
        $('#delete_antivirus').modal('show');
        }
    $('#btndeleteantivirus').on('click', function () {
        //debugger;
                var url1 = '@Url.Content("~/csat_report/DeleteAntivirus?servicename=")' + servicename;
                $.ajax({
                type: "POST",
                url: url1,
                success: function (result) {
                    alert(result);
                    $('#delete_antivirus').modal('hide');
                    show_antiviruslist();
		         }
		         });

	        });
</script>
<script>
    function cleardata() {
        document.getElementById("antivirus_name").value = "";
        document.getElementById("service_name").value = "";
    }
    var startdate = "";
    var enddate = "";
    $('input[name="avdatefilter"]').val('');

    $(function () {
      //  debugger;
        $('input[name="avdatefilter"]').daterangepicker({
            autoUpdateInput: true,
            startDate: moment().startOf('hour').add(-24, 'hour'),
            endDate: moment().startOf('hour'),
            timePicker: true,
            locale: {
                cancelLabel: 'Clear',
                format: 'DD/MM/YYYY'
            }
            },
            function(start, end) {
                startdate = start;
                enddate = end;


            }
        );


        $('input[name="avdatefilter"]').on('apply.daterangepicker', function (ev, picker) {
            $(this).val(picker.startDate.format('DD/MM/YYYY') + ' - ' + picker.endDate.format('DD/MM/YYYY'));
            //startdate = picker.startDate.format('DD/MM/YYYY hh:mm A');
            //enddate = picker.endDate.format('DD/MM/YYYY hh:mm A');
        });

        $('input[name="avdatefilter"]').on('cancel.daterangepicker', function (ev, picker) {
            $(this).val('');
        });
        $(window).bind('scroll', function () {
            $(".daterangepicker").hide();
        });

    });



     $.get('@Url.Content("~/csat_report/GetOU/")', null, DataBind)
    function DataBind(data) {
        //debugger;
        var url = '@Url.Content("~/csat_report/GetOU/")';
        $.ajax({
            type: "POST",
            url: url,
            success: function (data) {
        var SetData = $('#DrpOU13');
	    jQuery('#DrpOU13').html('');

        var oudata = "<option value='-1'>Select Branch/ Unit</option>";
        for (var i = 0; i < data.ou.length; i++) {
            oudata += "<option value='" + data.ou[i].ouid + "'>" + data.ou[i].ouname + "</option>";
        }
        SetData.append(oudata);
            }
        });
    }

    $("#DrpOU13").change(function () {
        ouidvalue = this.value;
        var url = '@Url.Content("~/csat_report/Get_syatemname_ip?ouid=")' + this.value;
        $.ajax({
        type: "POST",
        url: url,
        success: function (data) {
         //debugger;
        var SetDatadevice = $('#drpDevice13');
        //var SetDataip = $('#drpip13');

        jQuery('#drpDevice13').html('');
        //jQuery('#drpip13').html('');

        var devicedata = "<option value='-1'>Select System Name</option>";
        //var ipdata = "<option value='-1'>Select IP Address</option>";

        for (var i = 0; i < data.systemip.length; i++) {
           devicedata+="<option value='"+ data.systemip[i].device_name +"'>"+ data.systemip[i].device_name +"</option>";
           //ipdata+="<option value='"+ data.systemip[i].ip +"'>"+ data.systemip[i].ip +"</option>";
            }

            SetDatadevice.append(devicedata);
            //SetDataip.append(ipdata);

        }

        });

    });

	var ouidvalue="";
    var systemvalue="";
    var ipvalue = "";
    var avsearch = "";
    $("#DrpOU13").change(function () {
        ouidvalue = this.value;
    });

    $("#drpDevice13").change(function () {
        systemvalue = this.value;

    });
    //$("#drpip13").change(function () {
    //    ipvalue = this.value;

    //});

    $("#drpsearch13").change(function () {
        //debugger;
        avsearch = this.value;
    });
function antivirusdatareport()
{
  //debugger;
    startdate = $('#avdate').data('daterangepicker').startDate.format('DD/MM/YYYY hh:mm A');
    enddate =$('#avdate').data('daterangepicker').endDate.format('DD/MM/YYYY hh:mm A');
    ipvalue = document.getElementById("drpip13").value;
    if(ouidvalue == '')
    ouidvalue = document.getElementById("DrpOU13").value;
    var e = document.getElementById("searchvalue");
    ValueSerach = e.value;
    $.ajax({
	type : "POST",
        url: '@Url.Content("~/csat_report/Getantivirusdata?IP=")' + ipvalue + '&Device=' + systemvalue + '&ouid=' + ouidvalue + '&startdate=' + startdate + '&enddate=' + enddate + '&FieldSerach=' + avsearch + '&ValueSerach=' + ValueSerach,
        success: function (response) {
            //debugger;
            var agent_divclear = document.getElementById('divantivirusreport_div');
            agent_divclear.innerHTML = '&nbsp;';
            $('#divantivirusreport_div').append("<table id='divantivirusreport' class='table table-striped table-bordered' width='100%'></table>");
            otable = document.getElementById('divantivirusreport');
            var data1 = [];
            for (var i = 0; i < response.data.length; i++) {
                var status = "";
                if (response.data[i].antivirus_Status == 'Yes') {
                    status = "<span class='badge badge-pill badge-success'>ON</span>";
                }
                else {
                    status = "<span class='badge badge-pill badge-danger'>OFF</span>";
                }
            var u_date = moment(response.data[i].update_time).utc().format('DD-MM-YYYY')
                data1.push([response.data[i].ou_longname, response.data[i].device_name, response.data[i].ip, response.data[i].antivirus_name, response.data[i].installed_date, response.data[i].agent_version, response.data[i].engine_version, u_date, response.data[i].ptnfile_version, status]);
            }
            var otable = $("#divantivirusreport").DataTable({
                scrollX: true,
                 data: data1, scrollX: !0, searching: !1, dom: "<'top'lB>rt<'bottom'ip><'clear'>", buttons: ["colvis", { text: "PDF", extend: "pdfHtml5", download: "open", filename: "Antivirus_Update_Report_" + today, orientation: "portrait", pageSize: "A4", exportOptions: { columns: ":visible", search: "applied", order: "applied" }, customize: function (t) { t.content.splice(0, 1); var e = new Date, n = e.getDate() + "-" + (e.getMonth() + 1) + "-" + e.getFullYear(); t.pageMargins = [20, 60, 20, 30], t.defaultStyle.fontSize = 7, t.styles.tableHeader.fontSize = 7, t.header = function () { return { columns: [{ margin: [0, -5, 30, 15], alignment: "left", width: 100, image: "data:image/png;base64," + pdflogo }, { margin: [-10, 10, 10, 0], alignment: "center", width: 410, text: "Antivirus Update Report", fontSize: 12 }, { alignment: "right", fontSize: 14, text: "" }], margin: 20 } }, t.footer = function (t, e) { return { columns: [{ alignment: "left", text: ["Created on: ", { text: n.toString() }] }, { alignment: "right", text: ["page ", { text: t.toString() }, " of ", { text: e.toString() }] }], margin: 20 } }; var a = { hLineWidth: function (t) { return .5 }, vLineWidth: function (t) { return .5 }, hLineColor: function (t) { return "#aaa" }, vLineColor: function (t) { return "#aaa" }, paddingLeft: function (t) { return 4 }, paddingRight: function (t) { return 4 } }; t.content[0].layout = a } }, 'excel'],
                columns: [{ title: "Branch/ Unit", width: '90px' }, { title: "System Name", width: '90px' }, { title: "IP Address", width: '90px' }, { title: "Antivirus Name", width: '90px' }, { title: "Installed Date", width: '90px' }, { title: "Agent Version", width: '90px' }, { title: "Virus Scan Engine", width: '90px' }, { title: "Last Update On", width: '90px' }, { title: "Smart Scan Agent Pattern" }, { title: "Status" }],
            });
            $(".table").css({ "width": "100%" });
            $(".dataTables_scrollHeadInner ").css({ "width": "100%" });
        }
	});
}

</script>
<script>
    $(function () {
        $('input[name="timerange"]').daterangepicker({
            autoUpdateInput: true,
            timePicker: true,
            timePickerSeconds: true,
            timePicker24Hour: true,
            startDate: moment().add(-24, 'hour'),
            endDate: moment(),
            locale: {
                cancelLabel: 'Clear',
                format: 'DD/MM/YYYY hh:mm:ss '
            }
        });

        $('input[name="timerange"]').on('apply.daterangepicker', function (ev, picker) {
            $(this).val(picker.startDate.format('DD/MM/YYYY hh:mm:ss') + ' - ' + picker.endDate.format('DD/MM/YYYY hh:mm:ss'));
        });

        $('input[name="timerange"]').on('cancel.daterangepicker', function (ev, picker) {
            $(this).val('');
        });

    });
</script>
<script type="text/javascript">
    var now = new Date();
    var day = ("0" + now.getDate()).slice(-2);
    var month = ("0" + (now.getMonth() + 1)).slice(-2);
    var today = now.getFullYear() + "-" + (month) + "-" + (day);

    $(document).ready(function () {
        $('.antivirus_Update_datatable').DataTable({
            paging: true,
            orderCellsTop: true,
            fixedHeader: true,
            order: [],
            columnDefs: [{ orderable: false, targets: [] }],
            colReorder: true,
            searching: false,
            info: false,
            responsive: false,
            dom: '<"html5buttons"B>lTfgitp',
            buttons: [
                {
                    extend: 'colvis',
                    columns: ':not(.noVis)',
                },
                {
                    extend: 'pdf', title: 'Antivirus Update Report' + today,
                    exportOptions: {
                        //  columns: ':visible',
                        columns: "thead th:not(.noExport)",
                    },
                    pageSize: 'A4',
                    customize: function (doc) {

                        doc.content.splice(0, 1);
                        var now = new Date();
                        var jsDate = now.getDate() + '-' + (now.getMonth() + 1) + '-' + now.getFullYear();
                        doc.pageMargins = [20, 60, 20, 30];
                        doc.defaultStyle.fontSize = 7;
                        doc.styles.tableHeader.fontSize = 7;

                        var report = 'Report Date :  ' + document.getElementById('datereport').value;
                        doc['header'] = (function () {
                            return {
                                columns: [
                                    {
                                        alignment: 'left',
                                        text: '',
                                        fontSize: 12,
                                    },
                                    {
                                        alignment: 'center',
                                        text: 'Antivirus Update Report',
                                        fontSize: 12,
                                    },
                                    {
                                        margin: [0, 20, 0, 0],
                                        alignment: 'right',
                                        italics: true,
                                        text: report,
                                        fontSize: 7,
                                    },
                                ],
                                margin: 20
                            }
                        });

                        doc['footer'] = (function (page, pages) {
                            return {
                                columns: [
                                    {
                                        alignment: 'left',
                                        text: ['Created on: ', { text: jsDate.toString() }]
                                    },
                                    {
                                        alignment: 'right',
                                        text: ['page ', { text: page.toString() }, ' of ', { text: pages.toString() }]
                                    }
                                ],
                                margin: 20
                            }
                        });

                        var objLayout = {};
                        objLayout['hLineWidth'] = function (i) { return .5; };
                        objLayout['vLineWidth'] = function (i) { return .5; };
                        objLayout['hLineColor'] = function (i) { return '#ddd'; };
                        objLayout['vLineColor'] = function (i) { return '#ddd'; };
                        objLayout['paddingLeft'] = function (i) { return 5; };
                        objLayout['paddingRight'] = function (i) { return 5; };
                        doc.content[0].layout = objLayout;

                    },

                },
                {
                    extend: 'excel', title: 'Antivirus Update Report' + today,
                    exportOptions: {
                        columns: "thead th:not(.noExport)",

                    },
                    customize: function (xlsx) {
                        var sheet = xlsx.xl.worksheets['sheet1.xml'];
                        var numrows = 2;
                        var clR = $('row', sheet);
                        //update Row
                        clR.each(function () {
                            var attr = $(this).attr('r');
                            var ind = parseInt(attr);
                            ind = ind + numrows;
                            $(this).attr("r", ind);
                        });

                        // Create row before data
                        $('row c ', sheet).each(function () {
                            var attr = $(this).attr('r');
                            var pre = attr.substring(0, 1);
                            var ind = parseInt(attr.substring(1, attr.length));
                            ind = ind + numrows;
                            $(this).attr("r", pre + ind);
                        });

                        function Addrow(index, data) {
                            msg = '<row r="' + index + '">'
                            for (i = 0; i < data.length; i++) {
                                var key = data[i].key;
                                var value = data[i].value;
                                msg += '<c t="inlineStr" r="' + key + index + '">';
                                msg += '<is>';
                                msg += '<t>' + value + '</t>';
                                msg += '</is>';
                                msg += '</c>';
                            }
                            msg += '</row>';
                            return msg;
                        }

                        var r1 = Addrow(1, [{ key: 'B', value: 'Antivirus Update Report - Date : ' + today }]);
                        var r2 = Addrow(2, [{ key: 'A', value: '' }]);

                        sheet.childNodes[0].childNodes[1].innerHTML = r1 + r2 + sheet.childNodes[0].childNodes[1].innerHTML;
                        $('row c[r^="B1"]', sheet).attr('s', '2');
                    },
                }
            ],
        });

        $(".table").css({ "width": "100%" });
        $(".dataTables_scrollHeadInner ").css({ "width": "100%" });
    });
</script>
