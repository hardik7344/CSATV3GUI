
@{
    ViewData["Title"] = "report_summary_compliance_management";
    Layout = "~/Views/Shared/ownyit_main_page.cshtml";
}

<body>
    <div class="row">
        <div class="ibox float-e-margins ">
            <div class="ibox-content" style="padding:4px;">
                <ul class="breadcrumb" style="margin-bottom:0px;">
                    <li>
                        @Html.ActionLink("Reports", "report_agent_information", "csat_report")
                        <i class="icon-angle-right"></i>
                    </li>
                    <li> Summary of Compliance Management  </li>
                </ul>
            </div>
        </div>
        <!--side menu-->
        <div class="col-sm-2 col-md-2 col-lg-2 no_padding">
            <div class="ibox float-e-margins ">
                <div class="ibox-content sidemenu">
                    @{
                        @Html.Partial("csat_report_menu");
                    }
                </div>
            </div>
        </div>
        <!--side menu end-->

        <div class="col-sm-10 col-md-10 col-lg-10">
            <div class="ibox float-e-margins" style="margin-bottom: 10px;">
                <div class="ibox-content">
                    <div class="row">
                        <div class="col-sm-12 col-md-12 col-lg-12">
                            <div class="row">
                                <div class="col-xs-12">
                                    <form class="form-horizontal" method="post">
                                        <div class="form-group">
                                            <label for="nameField" style="margin-top: -5px;background-color: #fff;text-align: center;color: #3D93C8;width: 120px;" class="col-xs-2 form_label">&nbsp;&nbsp;Advance Search&nbsp;&nbsp;</label>
                                            <div class="col-xs-10">
                                            </div>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-xs-12">
                            <form class="form-horizontal" method="post" name="frm_compliance_management_report" id="frm_compliance_management_report">
                                <div class="form-group">
                                    <label for="nameField" class="col-xs-1 form_label">Branch/ Unit</label>
                                    <div class="col-xs-3">
                                        <select class="form-control col-sm-3 col-lg-3 col-md-3" name="Branch/Unit" id="drpou">
                                            <option value='-1'>Select Branch/ Unit</option>
                                        </select>
                                    </div>
                                    <label for="nameField" class="col-xs-1 form_label">System Name</label>
                                    <div class="col-xs-2" id="selectsys">
                                        <select class="form-control col-sm-3 col-lg-3 col-md-3" name="Device" id="drpdevice">
                                            <option value='-1'>Select System Name</option>
                                        </select>
                                    </div>
                                    <div class="col-xs-2" id="inputsystemname">
                                        <input type="text" class="form-control col-sm-3 col-lg-3 col-md-3" name="add_systemname" id="add_systemname">
                                    </div>
                                    <div class="col-xs-1">
                                        <input type="checkbox" class="form-check-input" id="add_system_chk" name="add_system_chk" style="width:20px;height:25px;">
                                    </div>
                                    <label for="nameField" class="col-xs-1 form_label" style="margin-left:-54px;">IP Address</label>
                                    <div class="col-xs-2">
                                        <select class="form-control col-sm-3 col-lg-3 col-md-3" name="drp_ip" id="drp_ip">
                                            <option value="-1">Select IP Address</option>
                                        </select>

                                        @*<input type="text" class="form-control col-sm-3 col-lg-3 col-md-3" placeholder="" name="drpip" id="drpip">*@
                                    </div>
                                    <div class="pull-left col-xs-1">
                                        <input type="button" class="btn btn-primary" value="Show" onclick="compliance_management_databind()">
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>

            <!--form  content end-->
            <!--User info report form end-->
            <!--User info Datatable start-->
            <div class="row ibox2">
                <div class="col-sm-12 col-md-12 col-lg-12 ibox2-content" id="tblcompliance_management_div">
                    <table id="tblcompliance_management" class="table table-striped table-bordered display nowrap" width="100%"></table>
                </div>
            </div>
        </div>
        <div class="space_bottom">&nbsp;</div>
    </div>
</body>

<script>
    $(document).ready(function () {
        validateSingleForm("#frm_compliance_management_report");
    });
</script>
<script>
    var ouidvalue = "";
    var systemvalue = "";
    var ipvalue = "";

 $.get('@Url.Content("~/csat_report/GetOU/")', null, DataBind)
    function DataBind(data) {
        $("#overlay").show();
        $("#overlay").fadeIn(300);
        //debugger;
        var url = '@Url.Content("~/csat_report/GetOU/")';
        $.ajax({
            type: "POST",
            url: url,
            success: function (data) {
                var SetData = $('#drpou');
                jQuery('#drpou').html('');

                var oudata = "<option value='-1'>Select Branch/ Unit</option>";
                for (var i = 0; i < data.ou.length; i++) {
                    oudata += "<option value='" + data.ou[i].ouid + "'>" + data.ou[i].ouname + "</option>";
                }
                SetData.append(oudata);
            }
        }).done(function () {
            setTimeout(function () {
                $("#overlay").fadeOut(300);
            }, 500);
        });
    }
$("#drpou").change(function () {
        ouidvalue = this.value;
        var url = '@Url.Content("~/csat_report/Get_syatemname_ip?ouid=")' + this.value;
        $.ajax({
        type: "POST",
        url: url,
        success: function (data) {
        // debugger;
        var SetDatadevice = $('#drpdevice');
            var SetDataip = $('#drp_ip');

        jQuery('#drpdevice').html('');
            jQuery('#drp_ip').html('');

        var devicedata = "<option value='-1'>Select System Name</option>";
        var ipdata = "<option value='-1'>Select IP Address</option>";

        for (var i = 0; i < data.systemip.length; i++) {
           devicedata+="<option value='"+ data.systemip[i].device_name +"'>"+ data.systemip[i].device_name +"</option>";
           ipdata+="<option value='"+ data.systemip[i].ip +"'>"+ data.systemip[i].ip +"</option>";
            }
            SetDatadevice.append(devicedata);
            SetDataip.append(ipdata);
        }
        });

    });
	$("#drpou").change(function () {
        ouidvalue = this.value;
    });

    $("#drpdevice").change(function () {
        systemvalue = this.value;

    });
    $("#drp_ip").change(function () {
        ipvalue = this.value;

    });

    function compliance_management_databind()
    {
        var $valid = $('#frm_compliance_management_report').valid();
        if (!$valid) {
            $validatorform.focusInvalid();
            return false;
        }
        else {
            $("#overlay").show();
            $("#overlay").fadeIn(300);
            //debugger;
            //var ipvalue = document.getElementById("drp_ip").value;
            if (ouidvalue == '')
                ouidvalue = document.getElementById("drpou").value;
            var systemvalue = document.getElementById('add_systemname').value;
            if (systemvalue == "") {
                systemvalue = document.getElementById("drpdevice").value;
            }
            $.ajax({
                type: "POST",
                url: '@Url.Content("~/csat_report/GetCompliance_Management_Summary_report?ip=")' + ipvalue + '&systemname=' + systemvalue + '&ouid=' + ouidvalue,
                dataType: 'json',
                success: function (data) {
                    //debugger;
                    //var dataclear = document.getElementById('tblcompliance_management_div');
                    //dataclear.innerHTML = '&nbsp;';
                    //$('#tblcompliance_management_div').append("<table id='tblcompliance_management' class='table table-striped table-bordered' width='100%'></table>");
                    //otable = document.getElementById('tblcompliance_management');
                    //var data1 = [];
                    //for (var i = 0; i < data.cm_data.length; i++) {
                    //    var sv = data.cm_data[i].encryption_tool_installed_sdesk + "/" + data.cm_data[i].encryption_tool_installed_vcrypt
                    //    data1.push([data.cm_data[i].ou_longname, data.cm_data[i].device_name, data.cm_data[i].mac_address, data.cm_data[i].ip_address, data.cm_data[i].role_of_pc, data.cm_data[i].user_name, data.cm_data[i].os_with_services_pack, data.cm_data[i].air_gap_violation, data.cm_data[i].attempt_todelete_log_reg, data.cm_data[i].usb_based_mass_storage_device_used_name, data.cm_data[i].cl_data_exist_on_pc, data.cm_data[i].official_data_internet_pc, data.cm_data[i].unwanted_data_exists, null, null, null, sv, data.cm_data[i].folder_sharing_exists, data.cm_data[i].pirated_unactivated_os, data.cm_data[i].malwarev_found, data.cm_data[i].pirated_unactivated_os, null, data.cm_data[i].av_installed, null, null, data.cm_data[i].default_sharing_exists, null, data.cm_data[i].screen_saver_psw, data.cm_data[i].av_last_updated_on, null, null, null, data.cm_data[i].password_policy_implemented, data.cm_data[i].audit_policy_implemented, null, data.cm_data[i].systemname, data.cm_data[i].ip, data.cm_data[i].username, data.cm_data[i].status, data.cm_data[i].ou_longname, data.cm_data[i].systemname, data.cm_data[i].ip, data.cm_data[i].username, data.cm_data[i].status, data.cm_data[i].ou_longname, data.cm_data[i].systemname, data.cm_data[i].ip, data.cm_data[i].username, data.cm_data[i].status, data.cm_data[i].ou_longname, data.cm_data[i].systemname, data.cm_data[i].ip, data.cm_data[i].username, data.cm_data[i].status]);
                    //}
                    //var otable = $("#tblcompliance_management").DataTable({
                    //    data: data1, scrollX: !0, searching: !1, dom: "<'top'lB>rt<'bottom'ip><'clear'>", buttons: ["colvis", { text: "PDF", extend: "pdfHtml5", download: "open", filename: "User Information_" + today, orientation: "portrait", pageSize: "A4", exportOptions: { columns: ":visible", search: "applied", order: "applied" }, customize: function (t) { t.content.splice(0, 1); var e = new Date, n = e.getDate() + "-" + (e.getMonth() + 1) + "-" + e.getFullYear(); t.pageMargins = [20, 60, 20, 30], t.defaultStyle.fontSize = 7, t.styles.tableHeader.fontSize = 7, t.header = function () { return { columns: [{ margin: [0, -5, 30, 15], alignment: "left", width: 100, image: "data:image/png;base64," + pdflogo }, { margin: [-10, 10, 10, 0], alignment: "center", width: 410, text: "User Information Report", fontSize: 12 }, { alignment: "right", fontSize: 14, text: "" }], margin: 20 } }, t.footer = function (t, e) { return { columns: [{ alignment: "left", text: ["Created on: ", { text: n.toString() }] }, { alignment: "right", text: ["page ", { text: t.toString() }, " of ", { text: e.toString() }] }], margin: 20 } }; var a = { hLineWidth: function (t) { return .5 }, vLineWidth: function (t) { return .5 }, hLineColor: function (t) { return "#aaa" }, vLineColor: function (t) { return "#aaa" }, paddingLeft: function (t) { return 4 }, paddingRight: function (t) { return 4 } }; t.content[0].layout = a } }, 'excel'],
                    //    columns: [{ title: "Branch/ Unit" }, { title: "PC Name" }, { title: "MAC Address" }, { title: "IP Address" }, { title: "Role of PC" }, { title: "User Name" }, { title: "OS Details" }, { title: "Air Gap/ Unwanted Sites Accessed" }, { title: "Logs Deleted" }, { title: "USB Usages" }, { title: "CL Data w/o Encryption" }, { title: "Official Data w/o Encryption" }, { title: "Unwanted Data" }, { title: "Formated w/o Permission" }, { title: "Virtualization on end pt terminals" }, { title: "Cmptrs not produced for audit" }, { title: "Encryption tool not installed" }, { title: "Shared Folder" }, { title: "Non-Genuine/ Pirated Sw (KMS Activator)" }, { title: "Malware" }, { title: "Non-Activated Sw" }, { title: "Unpatched OS" }, { title: "AV not Installed" }, { title: "Non-Activated OS" }, { title: "Obsolete OS" }, { title: "Default Share" }, { title: "USB Storage Enabled" }, { title: "Password Not Set at all Levels" }, { title: "AV not Updated " }, { title: "Unwanted Service Running" }, { title: "Pers Fw no Configured" }, { title: "Privacy Feature Enabled" }, { title: "Password Policy not Impl" }, { title: "Audit Policy not Impl" }, { title: "BIOS not Hardenad" }, { title: "Domain Controller not Impl" }, { title: "Admin Acct not Renamed" }, { title: "Auto Patch Mgt not config" }, { title: "Use of Admin Acct for Daily Use" }, { title: "Unauthorized Sw" }, { title: "Incorrect Sys Date and Time" }, { title: "Guest Acct not Disabled" }, { title: "Clear Virtual Memory Not Set" }, { title: "IPv6 not Disabled" }]
                    //});
                    //$(".table").css({ "width": "100%" });
                    //$(".dataTables_scrollHeadInner ").css({ "width": "100%" });

                    //Dynamic Datatable
                    $(document).ready(function () {
                        $('#tblcompliance_management').DataTable({
                            data: data.cm_data,
                            columns: [
                                {
                                    "data": "ou_longname",
                                    "title": "Branch/ Unit"
                                },
                                {
                                    "data": "device_name",
                                    "title": "PC Name"
                                },
                                {
                                    "data": "mac_address",
                                    "title": "MAC Address",
                                },
                                {
                                    "data": "ip_address",
                                    "title": "IP Address"
                                },
                                {
                                    "data": "role_of_pc",
                                    "title": "Role of PC",
                                },
                                {
                                    "data": "user_name",
                                    "title": "User Name"
                                },
                                {
                                    "data": "os_with_services_pack",
                                    "title": "OS Details",
                                },
                                {
                                    "data": "air_gap_violation",
                                    "title": "Air Gap/ Unwanted Sites Accessed"
                                },
                                {
                                    "data": "attempt_todelete_log_reg",
                                    "title": "Logs Deleted",
                                },
                                {
                                    "data": "usb_based_mass_storage_device_used_name",
                                    "title": "USB Usages"
                                },
                                {
                                    "data": "cl_data_exist_on_pc",
                                    "title": "CL Data w/o Encryption"
                                },
                                {
                                    "data": "official_data_internet_pc",
                                    "title": "Official Data w/o Encryption",
                                },
                                {
                                    "data": "unwanted_data_exists",
                                    "title": "Unwanted Data"
                                },
                                {
                                    "data": "formated_permission",
                                    "title": "Formated w/o Permission",
                                },
                                {
                                    "data": "virtualization_on_terminals",
                                    "title": "Virtualization on end pt terminals"
                                },
                                {
                                    "data": "cmptrs_not_produced_audit",
                                    "title": "Cmptrs not produced for audit"
                                },
                                {
                                    "data": "encryption_tool_installed_sdesk",
                                    "title": "Encryption tool not installed",
                                },
                                {
                                    "data": "folder_sharing_exists",
                                    "title": "Shared Folder"
                                },
                                {
                                    "data": "pirated_unactivated_os",
                                    "title": "Non-Genuine/ Pirated Sw (KMS Activator)",
                                },
                                {
                                    "data": "malwarev_found",
                                    "title": "Malware"
                                },
                                {
                                    "data": "non_activated_sw",
                                    "title": "Non-Activated Sw"
                                },
                                {
                                    "data": "unpatched_os",
                                    "title": "Unpatched OS",
                                },
                                {
                                    "data": "av_installed",
                                    "title": "AV not Installed"
                                },
                                {
                                    "data": "pirated_unactivated_os",
                                    "title": "Non-Activated OS",
                                },
                                {
                                    "data": "obsolete_os",
                                    "title": "Obsolete OS"
                                }, {
                                    "data": "default_sharing_exists",
                                    "title": "Default Share"
                                },
                                {
                                    "data": "usb_storage_enabled",
                                    "title": "USB Storage Enabled",
                                },
                                {
                                    "data": "screen_saver_psw",
                                    "title": "Password Not Set at all Levels"
                                },
                                {
                                    "data": "av_last_updated_on",
                                    "title": "AV not Updated ",
                                },
                                {
                                    "data": "unwanted_service_running",
                                    "title": "Unwanted Service Running"
                                },
                                {
                                    "data": "pers_fw_configured",
                                    "title": "Pers Fw no Configured"
                                },
                                {
                                    "data": "privacy_feature_enabled",
                                    "title": "Privacy Feature Enabled",
                                },
                                {
                                    "data": "password_policy_implemented",
                                    "title": "Password Policy not Impl"
                                },
                                {
                                    "data": "audit_policy_implemented",
                                    "title": "Audit Policy not Impl",
                                },
                                {
                                    "data": "bios_not_hardenad",
                                    "title": "BIOS not Hardenad"
                                },
                                {
                                    "data": "actine_directory_domain_controller_impl",
                                    "title": "Domain Controller not Impl"
                                },
                                {
                                    "data": "administrator_renamed",
                                    "title": "Admin Acct not Renamed",
                                },
                                {
                                    "data": "auto_patch_mgt_not_config",
                                    "title": "Auto Patch Mgt not config"
                                },
                                {
                                    "data": "usage_of_admin_acct_for_daily_week",
                                    "title": "Use of Admin Acct for Daily Use",
                                },
                                {
                                    "data": "unauthorized_sw",
                                    "title": "Unauthorized Sw"
                                },
                                {
                                    "data": "system_date_time_wrong",
                                    "title": "Incorrect Sys Date and Time"
                                },
                                {
                                    "data": "guest_account_enabled",
                                    "title": "Guest Acct not Disabled",
                                },
                                {
                                    "data": "clear_virtual_memory_enabled",
                                    "title": "Clear Virtual Memory Not Set"
                                },
                                {
                                    "data": "ipv6_disabled",
                                    "title": "IPv6 not Disabled",
                                },
                            ],
                            scrollX: !0, searching: !1, dom: "<'top'lB>rt<'bottom'ip><'clear'>", buttons: ["colvis", { text: "PDF", extend: "pdfHtml5", download: "open", filename: "Summary of Compliance Management_" + today, orientation: "portrait", pageSize: "A4", exportOptions: { columns: ":visible", search: "applied", order: "applied" }, customize: function (t) { t.content.splice(0, 1); var e = new Date, n = e.getDate() + "-" + (e.getMonth() + 1) + "-" + e.getFullYear(); t.pageMargins = [20, 60, 20, 30], t.defaultStyle.fontSize = 7, t.styles.tableHeader.fontSize = 7, t.header = function () { return { columns: [{ margin: [0, -5, 30, 15], alignment: "left", width: 100, image: "data:image/png;base64," + pdflogo }, { margin: [-10, 10, 10, 0], alignment: "center", width: 410, text: "Summary of Compliance Management Report", fontSize: 12 }, { alignment: "right", fontSize: 14, text: "" }], margin: 20 } }, t.footer = function (t, e) { return { columns: [{ alignment: "left", text: ["Created on: ", { text: n.toString() }] }, { alignment: "right", text: ["page ", { text: t.toString() }, " of ", { text: e.toString() }] }], margin: 20 } }; var a = { hLineWidth: function (t) { return .5 }, vLineWidth: function (t) { return .5 }, hLineColor: function (t) { return "#aaa" }, vLineColor: function (t) { return "#aaa" }, paddingLeft: function (t) { return 4 }, paddingRight: function (t) { return 4 } }; t.content[0].layout = a } }, 'excel'],
                            "bDestroy": true
                        });
                    });
                }
            }).done(function () {
                setTimeout(function () {
                    $("#overlay").fadeOut(300);
                }, 500);
            });
        }
    }


</script>


<script>
    //checkbox input hide & show
    $('#inputsystemname').hide();
    $('#add_system_chk').on('click', function () {
        if ($(this).is(':checked')) {
            $('#selectsys').hide();
            $('#inputsystemname').show();
        }
        else {
            $('#selectsys').show();
            $('#inputsystemname').hide();
            document.getElementById('add_systemname').value = "";
        }
    });
</script>