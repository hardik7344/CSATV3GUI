
@{
    ViewData["Title"] = "setting_updater";
    Layout = "~/Views/Shared/ownyit_main_page.cshtml";
}
<script src="~/js/main.js"></script>
<script type="text/javascript">

    $(document).ready(function () {
        $('#activity_type').on('change', function () {
            //debugger;
            if (this.value == '1') {
                $("#download").show();
            }
            else {
                $("#download").hide();
            }
            if (this.value == '2') {
                $("#execute").show();
            }
            else {
                $("#execute").hide();
            }
            if (this.value == '3') {
                $("#upload").show();
            }
            else {
                $("#upload").hide();
            }



            //if (this.value == '1') {
            //    $("#download").show();
            //    $("#execute").hide();
            //    $("#upload").hide();
            //}
            //if (this.value == '2') {
            //    $("#execute").show();
            //    $("#download").hide();
            //    $("#upload").hide();
            //}
            //if (this.value == '3') {
            //    $("#upload").show();
            //    $("#download").hide();
            //    $("#execute").hide();
            //}
        });
    });
</script>

<!--file upload  -->
<script type="text/javascript">
    function bs_input_file() {
        $(".input-file").before(
            function () {
                if (!$(this).prev().hasClass('input-file')) {
                    var element = $("<input type='file' class='input-file' style='visibility:hidden; height:0'>");
                    element.attr("name", $(this).attr("name"));
                    element.change(function () {
                        //element.next(element).find('input').val((element.val()).split('\\').pop());
                        element.next(element).find('input').val(element.val());
                    });
                    $(this).find("button.btn-choose").click(function () {
                        element.click();
                    });
                    $(this).find("button.btn-reset").click(function () {
                        element.val(null);
                        $(this).parents(".input-file").find('input').val('');
                    });
                    $(this).find('input').css("cursor", "pointer");
                    $(this).find('input').mousedown(function () {
                        $(this).parents('.input-file').prev().click();
                        return false;
                    });
                    return element;
                }
            }
        );
    }
    $(function () {
        bs_input_file();
    });
</script> <!--file upload  -->
@*<div class="row">
        <div class="headerbar">
            <a href="#" style="padding-left:10px;">Report</a>
        </div>
    </div>*@
<body onload="DataBind();">
    <div class="row">

        <div class="ibox float-e-margins ">
            <div class="ibox-content" style="padding:4px;">
                <div class="pull-right form_label btn_top_margin">
                    <button class="btn btn-primary btn-md day" data-toggle="modal" data-target="#add_task" title="Add Task">Add Task <b style="font-weight:bolder;">+</b></button>
                </div>
                <ul class="breadcrumb" style="margin-bottom:0px;">
                    <li>
                        @Html.ActionLink("Settings", "setting_scan_ip_range", "csat_settings_page")
                        <i class="icon-angle-right"></i>
                    </li>
                    <li>Updater </li>
                </ul>
            </div>
        </div>

        <!--side menu-->
        <div class="col-sm-2 col-md-2 col-lg-2 no_padding">
            <div class="ibox float-e-margins ">
                <div class="ibox-content sidemenu">
                    @{
                        @Html.Partial("csat_settings_page_menu");
                    }
                </div>
            </div>
        </div>
        <!--side menu end-->
        <div class="col-sm-10 col-md-10 col-lg-10">
            <div class="ibox float-e-margins" style="margin:0px;">
                <div class="ibox-content">
                    <div class="row">
                        <div class="row">
                            <div class="col-sm-12 col-md-12 col-lg-12" id="div_display_task_master_div">
                                <table id="div_display_task_master" class="table table-striped table-bordered " width="100%"></table>
                            </div>
                        </div>

                    </div>

                </div>
            </div>
            <div class="space_bottom">&nbsp;</div>
        </div>
    </div>

    <!--Add New Task model box  Content-->

    <div class="modal fade" id="add_task" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static" data-keyboard="false">
        <div class="modal-dialog  modal-small">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h6 class=" modal-title">
                        Add Task
                    </h6>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-xs-12">
                            <form class="form-horizontal" method="post" name="frm_csat_updater_add_task" id="frm_csat_updater_add_task">
                                <div class="form-group">
                                    <label for="nameField" class="col-xs-4">Task Name  <b class="loginmsg">*</b></label>
                                    <div class="col-xs-8">
                                        <input class="form-control" type="text" name="txt_task_name" placeholder="Enter Task Name" id="txt_task_name" />
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="nameField" class="col-xs-4">Task Description</label>
                                    <div class="col-xs-8">
                                        <textarea class="form-control" placeholder="Enter Task Description" id="txt_task_desc" name="txt_task_desc" style="resize:none"></textarea>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="nameField" class="col-xs-4"></label>
                                    <div class="col-xs-6">
                                        <input type="button" class="btn btn-primary" name="save" value="Submit" onclick="return validate();" />
                                        <input type="button" class="btn btn-primary" name="close" value="Cancel" data-dismiss="modal" onclick="cleardata()" />
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div><!-- /.modal-content -->
        </div><!-- /.modal-dialog -->
    </div>

    <!-- End  New Task  pop-up model box Content end-->
    <!--Add New activity model box  Content-->

    <div class="modal fade" id="add_activity" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static" data-keyboard="false">
        <div class="modal-dialog  modal-md">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true" onclick="cleardata()">&times;</button>
                    <h6 class=" modal-title">
                        Add Activity Detail
                    </h6>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-xs-12">
                            <form class="form-horizontal" method="post" id="frm_csat_updater_add_activity" name="frm_csat_updater_add_activity">
                                <div class="form-group">
                                    <label for="nameField" class="col-xs-2">Task Name</label>

                                    <input type="hidden" id="hdn_add_activity_task_id" value="" />
                                    <div class="col-xs-4" id="div_add_activity_task_name">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="nameField" class="col-xs-2">Activity Type</label>
                                    <div class="col-xs-4">
                                        <select class="form-control col-sm-3 col-lg-3 col-md-3" name="Activity" id="activity_type">
                                            <option value="-1">Select Activity Type </option>
                                            <option value="1" selected="selected">Download</option>
                                            <option value="2">Execute</option>
                                            <option value="3">Upload</option>
                                        </select>
                                    </div>

                                </div>
                                <div id="download">
                                    <div class="form-group">
                                        <label for="nameField" class="col-xs-2">File 32-bit</label>
                                        <div class="col-xs-4">
                                            @*<div class="input-group input-file" name="Attechment">*@
                                            <input type="text" class="form-control" placeholder='Enter a file (32 bit)' id="txt_activity_file_32" name="txt_activity_file_32" />
                                            @*<span class="input-group-btn">
                                                    <button class="btn btn-default btn-choose" type="button">Choose</button>
                                                </span>*@
                                            @*</div>*@
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="nameField" class="col-xs-2">Destination Path </label>
                                        <div class="col-xs-4">
                                            <input class="form-control" type="text" name="txt_activity_destination_path_32" placeholder="Enter Destination path (32-bit)" id="txt_activity_destination_path_32" />
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="nameField" class="col-xs-2">File 64-bit</label>
                                        <div class="col-xs-4">
                                            @*<div class="input-group input-file" name="Attechment">*@
                                            <input type="text" class="form-control" placeholder='Enter a file (64 bit)' id="txt_activity_file_64" name="txt_activity_file_64" />
                                            @*<span class="input-group-btn">
                                                    <button class="btn btn-default btn-choose" type="button">Choose</button>
                                                </span>*@
                                            @*</div>*@
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="nameField" class="col-xs-2">Destination Path</label>
                                        <div class="col-xs-4">
                                            <input class="form-control" type="text" name="txt_activity_destination_path_64" placeholder="Enter Destination path (64-bit)" id="txt_activity_destination_path_64" />
                                        </div>
                                    </div>
                                </div>
                                <div id="execute" style="display:none;">
                                    <div class="form-group">
                                        <label for="nameField" class="col-xs-2">Command 32-bit</label>
                                        <div class="col-xs-4">
                                            <input class="form-control" type="text" name="txt_activity_command_32" placeholder="Enter Command (32-bit)" id="txt_activity_command_32" />
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="nameField" class="col-xs-2">Command 64-bit</label>
                                        <div class="col-xs-4">
                                            <input class="form-control" type="text" name="txt_activity_command_64" placeholder="Enter Command (64-bit)" id="txt_activity_command_64" />
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="nameField" class="col-xs-2">Working directory</label>
                                        <div class="col-xs-4">
                                            <input class="form-control" type="text" name="txt_activity_working_directory" placeholder="Enter Working directory" id="txt_activity_working_directory" />
                                        </div>
                                    </div>
                                </div>
                                <div id="upload" style="display:none;">
                                    <div class="form-group">
                                        <label for="nameField" class="col-xs-2">Source Folder Path</label>
                                        <div class="col-xs-4">
                                            <input class="form-control" type="text" name="txt_source_folder_path" placeholder="Enter Source Folder Path" id="txt_source_folder_path" />
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="nameField" class="col-xs-2">Source Filename</label>
                                        <div class="col-xs-4">
                                            <input class="form-control" type="text" name="txt_source_filename" placeholder="Enter Source Filename" id="txt_source_filename" />
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="nameField" class="col-xs-2">Server Folder Path</label>
                                        <div class="col-xs-4">
                                            <input class="form-control" type="text" name="txt_server_folder_path" placeholder="Enter Server Folder Path" id="txt_server_folder_path" />
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="nameField" class="col-xs-2">Server Filename</label>
                                        <div class="col-xs-4">
                                            <input class="form-control" type="text" name="txt_server_filename" placeholder="Enter Server Filename" id="txt_server_filename" />
                                        </div>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="nameField" class="col-xs-2"></label>
                                    <div class="col-xs-6">
                                        <input type="button" class="btn btn-primary" name="save" value="Submit" onclick="submit_new_activity();" />
                                        <input type="button" class="btn btn-primary" name="close" value="Cancel" data-dismiss="modal" onclick="cleardata()" />
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div><!-- /.modal-content -->
        </div><!-- /.modal-dialog -->
    </div>

    <!-- End  New activity pop-up model box Content end-->
    <!-- Activity count-->
    <div class="modal fade" id="activity_count" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static" data-keyboard="false">
        <div class="modal-dialog  modal-lg" style="margin-top: 82px;">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h6 class=" modal-title">
                        Activity Details
                    </h6>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="row">
                            <div class="col-sm-12 col-md-12 col-lg-12" id="div_show_activity_only_div">
                                <table id="div_show_activity_only" class="table table-striped table-bordered " width="99%"></table>
                            </div>
                        </div>

                    </div>

                </div>
            </div><!-- /.modal-content -->
        </div><!-- /.modal-dialog -->
    </div>
    <!-- Activity count-->
    <!--Apply task -->
    <div class="modal fade" id="apply_task" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static" data-keyboard="false">
        <div class="modal-dialog  modal-lg" style="margin-top: 82px;">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h6 class=" modal-title">
                        Apply Task
                    </h6>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="row">
                            <div class="col-sm-12 col-md-12 col-lg-12" id="div_open_apply_activity_div">
                                <table id="div_open_apply_activity" class="table table-striped table-bordered " width="99%"></table>
                            </div>
                        </div>

                    </div>

                    &nbsp;  &nbsp;
                    <div class="row">
                        <div class="col-xs-12">
                            <form class="form-horizontal" method="post">
                                <div class="form-group">
                                    <label for="nameField" class="col-xs-1">System Name</label>
                                    <div class="col-xs-2" id="div_system_drp">
                                    </div>
                                    <label for="nameField" class="col-xs-1 text-align-right">IP Address</label>
                                    <div class="col-xs-2" id="div_ip_drp">
                                    </div>
                                    <div class="pull-left col-xs-1">
                                        <input type="button" class="btn btn-primary" value="Show" onclick="open_activity_popup_apply(0);">
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                    <div class="row">
                        <div class="row">
                            <div class="col-sm-12 col-md-12 col-lg-12" id="div_apply_activity_devices_div">
                                <table id="div_apply_activity_devices" class="table table-striped table-bordered " width="99%"></table>
                            </div>
                        </div>

                    </div>

                </div>
            </div><!-- /.modal-content -->
        </div><!-- /.modal-dialog -->
    </div>
    <!-- Activity count-->
    <!--Apply on task start -->
    <div class="modal fade" id="apply_on_task" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static" data-keyboard="false">
        <div class="modal-dialog  modal-md" style="margin-top: 82px;">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h6 class=" modal-title">
                        Apply on Task
                    </h6>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="row">
                            <div class="col-sm-12 col-md-12 col-lg-12" id="div_apply_on_devices_div">
                                <table id="div_apply_on_devices" class="table table-striped table-bordered " width="99%"></table>
                            </div>
                        </div>

                    </div>

                </div>
            </div><!-- /.modal-content -->
        </div><!-- /.modal-dialog -->
    </div>
    <!--Apply on task  end-->
    <!--Apply success task start -->
    <div class="modal fade" id="apply_success_task" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static" data-keyboard="false">
        <div class="modal-dialog  modal-md" style="margin-top: 82px;">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h6 class=" modal-title">
                        Apply Successfully Task
                    </h6>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="row">
                            <div class="col-sm-12 col-md-12 col-lg-12" id="div_apply_success_devices_div">
                                <table id="div_apply_success_devices" class="table table-striped table-bordered " width="100%"></table>
                            </div>
                        </div>
                    </div>
                </div>
            </div><!-- /.modal-content -->
        </div><!-- /.modal-dialog -->
    </div>
    <!--Apply success task  end-->
    <!--delete_task  model  content-->

    <div class="modal fade" id="delete_task" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static" data-keyboard="false">
        <div class="modal-dialog  modal-small">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h6 class=" modal-title">
                        Conformation
                    </h6>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-xs-10">
                            <form class="form-horizontal" method="post">
                                <div class="form-group">

                                    <label for="nameField" class="col-xs-12">
                                        <i class="glyphicon glyphicon-exclamation-sign delete_msg"></i>
                                        <span style="font-weight:normal;margin-left:30px;">Are you sure you want to delete this task?</span>
                                    </label>

                                </div>
                                <div class="form-group">
                                    <label for="nameField" class="col-xs-4"></label>
                                    <div class="col-xs-6">
                                        <input type="button" class="btn btn-primary" name="yes" value="Yes" id="btndelete" />
                                        <input type="button" class="btn btn-default" name="no" value="No" id="btndeletecancle" data-dismiss="modal" />
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div><!-- /.modal-content -->
        </div><!-- /.modal-dialog -->
    </div>
    <script>
        $(document).ready(function () {
            validateSingleForm("#frm_csat_updater_add_task");
            validateSingleForm("#frm_csat_updater_add_activity");
        });
    </script>

    <!--delete_task device model  content-->
    <script>
    $(".parent").each(function (index) {
        var group = $(this).data("group");
        var parent = $(this);

        parent.change(function () {  //"select all" change
            $(group).prop('checked', parent.prop("checked"));
        });
        $(group).change(function () {
            parent.prop('checked', false);
            if ($(group + ':checked').length == $(group).length) {
                parent.prop('checked', true);

            }
        });
    });

        function DataBind(data) {
            $("#overlay").show();
            $("#overlay").fadeIn(300);
        var url1 = '@Url.Content("~/csat_settings_page/csat_updater_all_task_data/")';
        $.ajax({
            type: "POST",
            url: url1,
            success: function (data) {
                var dataclear = document.getElementById('div_display_task_master_div');
                dataclear.innerHTML = '&nbsp;';
                $('#div_display_task_master_div').append("<table id='div_display_task_master' class='table table-striped table-bordered' width='100%'></table>");
                dtable = document.getElementById('div_display_task_master');
                var data1 = [];
                for (var i = 0; i < data.csat_task_data.length; i++) {
                    //debugger;
                    var activity_count = "<div class='icon'><a href='' data-toggle='modal' data-target='#activity_count' onclick='open_activity_popup(" + data.csat_task_data[i].task_id + ")'>" + data.csat_task_data[i].activity + "</a></div>";
                    var apply_on_task = "<div class='icon'><a href='' data-toggle='modal' data-target='#apply_on_task' onclick='open_popup_apply_on_devices(" + data.csat_task_data[i].task_id + ")'>" + data.csat_task_data[i].applyon + "</a></div>";
                    var apply_success_task = "<div class='icon'><a href='' data-toggle='modal' data-target='#apply_success_task' onclick='open_popup_apply_success_devices(" + data.csat_task_data[i].task_id + ")'>" + data.csat_task_data[i].appliedsuccess + "</a></div>";
                    var open_activity_popup = "<i class='manage_icon ' type='button' data-toggle='modal'  title='Apply' onclick='open_activity_popup_apply(" + data.csat_task_data[i].task_id + ")'><img src='../images/user_right.png' /></i>";
                    var deletetaskdata = "<div class='icon'><i class=' glyphicon glyphicon-trash manage_icon ' type='button' data-toggle='modal'  title='Delete' onclick='deletetaskdata(" + data.csat_task_data[i].task_id + ")'></i></div>";
                    var add_activity = "<div class='icon'><i class=' glyphicon glyphicon-edit manage_icon ' type='button' data-toggle='modal' data-target='#add_activity' title='Add Activity' onclick='open_new_activity_add(" + data.csat_task_data[i].task_id + ")'></i></div>";
                    data1.push([data.csat_task_data[i].task_name, data.csat_task_data[i].task_desc, activity_count, apply_on_task, apply_success_task, open_activity_popup, deletetaskdata, add_activity]);
                }
                var dtable = $("#div_display_task_master").DataTable({
                    data: data1, scrollX: !0, searching: !1, dom: "<'top'lB>rt<'bottom'ip><'clear'>", buttons: ["colvis"],
                    columns: [{ title: "Task Name" }, { title: "Task Description" }, { title: "Activities", orderable: false, className: 'dt-center', width: '20px' }, { title: "Apply on", orderable: false, className: 'dt-center', width: '90px' }, { title: "Applied successfully", orderable: false, className: 'dt-center', width: '120px' }, { title: "Apply", orderable: false, className: 'dt-center', width: '15px' }, { title: "Delete", orderable: false, className: 'dt-center', width: '15px' }, { title: "Add Activity", orderable: false, className: 'dt-center', width: '90px' }]
                });
                $(".table").css({ "width": "100%" });
                $(".dataTables_scrollHeadInner ").css({ "width": "100%" });

            }
        }).done(function () {
            setTimeout(function () {
                $("#overlay").fadeOut(300);
            }, 500);
        });
    }
    function validate() {
        var $valid = $('#frm_csat_updater_add_task').valid();
         if (!$valid) {
            $validatorform.focusInvalid();
            return false;
         }
         else {
                //if (document.add_task_form.txt_task_name.value == "") {
                //    alert("Please Enter Task Details !");
                //    document.add_task_form.txt_task_name.focus();
                //    return false;
                //}
                //else {
                //    //return (true);
                    add_new_task();
                //}
         }
    }
    function add_new_task() {
       // debugger;
        var task_name = document.getElementById("txt_task_name").value;
        var task_desc = document.getElementById("txt_task_desc").value;
        var url1 = '@Url.Content("~/csat_settings_page/csat_updater_add_new_task?taskname=")' + task_name + '&taskdesc=' + task_desc;
        $.ajax({
            type: "POST",
            url: url1,
            success: function (data) {
                //debugger;
                alert(data);
              //  DataTaskBind();
                $('#add_task').modal('hide');
                DataBind();
                document.getElementById("txt_task_name").value = "";
                document.getElementById("txt_task_desc").value = "";
            }
        });

    }
    function open_new_activity_add(task_id) {
        $('#add_activity').modal('show');
        var url1 = '@Url.Content("~/csat_settings_page/csat_updater_open_activity_add?taskid=")' + task_id;
        $.ajax({
            type: "POST",
            url: url1,
            success: function (data) {
                if (data.csat_task_data_open_activity.length > 0) {
                    document.getElementById("hdn_add_activity_task_id").value = task_id;
                    //div_add_activity_task_name
                    var Setactivitydata = $('#div_add_activity_task_name');
                    jQuery('#div_add_activity_task_name').html('');
                    Setactivitydata.append("<label for='nameField' class='col - xs - 2'>" + data.csat_task_data_open_activity[0].task_name +"</label>");
                }
            }
        });
    }
    function submit_new_activity()
    {
        //debugger;
        var $valid = $('#frm_csat_updater_add_activity').valid();
        if (!$valid) {
            $validatorform.focusInvalid();
            return false;
        }
        else {

            var activity_type = document.getElementById("activity_type").value;
            //if (activity_type == '1') {
            //    if (document.getElementById("txt_activity_file_32").value.length <= 0 || document.getElementById("txt_activity_file_64").value.length <= 0 || document.getElementById("txt_activity_destination_path_32").value.length <= 0 || document.getElementById("txt_activity_destination_path_64").value.length <= 0) {
            //        alert('Please enter valid information');
            //        return;
            //    }
            //}
            //if (activity_type == '2') {
            //    if (document.getElementById("txt_activity_command_32").value.length <= 0 || document.getElementById("txt_activity_command_64").value.length <= 0) {
            //        alert('Please enter valid information');
            //        return;
            //    }
            //}
            //if (activity_type == '3') {
            //    if (document.getElementById("txt_source_folder_path").value.length <= 0 || document.getElementById("txt_source_filename").value.length <= 0 || document.getElementById("txt_server_filename").value.length <= 0) {
            //        alert('Please enter valid information');
            //        return;
            //    }
            //}

            var task_id = document.getElementById("hdn_add_activity_task_id").value;
            var dw_file_32 = document.getElementById("txt_activity_file_32").value;
            var dw_file_64 = document.getElementById("txt_activity_file_64").value;
            var command_32 = document.getElementById("txt_activity_command_32").value;
            var command_64 = document.getElementById("txt_activity_command_64").value;
            var working_directory = document.getElementById("txt_activity_working_directory").value;
            var destination_path_32 = document.getElementById("txt_activity_destination_path_32").value;
            var destination_path_64 = document.getElementById("txt_activity_destination_path_64").value;
            var source_folder_path = document.getElementById("txt_source_folder_path").value;
            var source_filename = document.getElementById("txt_source_filename").value;
            var server_folder_path = document.getElementById("txt_server_folder_path").value;
            var server_filename = document.getElementById("txt_server_filename").value;

            var url1 = '@Url.Content("~/csat_settings_page/csat_updater_add_new_activity?task_id=")' + task_id + '&activity_type=' + activity_type + '&dw_file_32=' + dw_file_32 + '&dw_file_64=' + dw_file_64 + '&command_32=' + command_32 + '&command_64=' + command_64 + '&destination_path_32=' + destination_path_32 + '&destination_path_64=' + destination_path_64 + '&working_directory=' + working_directory + '&source_folder_path=' + source_folder_path + '&source_filename=' + source_filename + '&server_folder_path=' + server_folder_path + '&server_filename=' + server_filename;
            $.ajax({
                type: "POST",
                url: url1,
                success: function (data) {
                    alert(data);
                    // DataTaskBind();
                    document.getElementById("activity_type").value = "1";
                    document.getElementById("hdn_add_activity_task_id").value = '';
                    document.getElementById("txt_activity_file_32").value = '';
                    document.getElementById("txt_activity_file_64").value = '';
                    document.getElementById("txt_activity_command_32").value = '';
                    document.getElementById("txt_activity_command_64").value = '';
                    document.getElementById("txt_activity_working_directory").value = '';
                    document.getElementById("txt_activity_destination_path_32").value = '';
                    document.getElementById("txt_activity_destination_path_64").value = '';
                    document.getElementById("txt_source_folder_path").value = '';
                    document.getElementById("txt_source_filename").value = '';
                    document.getElementById("txt_server_folder_path").value = '';
                    document.getElementById("txt_server_filename").value = '';
                    DataBind();
                    $('#add_activity').modal('hide');

                }
            });
        }
    }
    function open_activity_popup_apply(task_id) {
        //debugger;
        //$('#apply_task').modal('show');
        var devicename = "";
        var deviceip = "";

        if (task_id == "0") {
            task_id = document.getElementById("hdn_add_activity_task_id").value;
            devicename = document.getElementById('drp_System').value;
            deviceip = document.getElementById('drp_ip').value;
        }
        document.getElementById("hdn_add_activity_task_id").value = task_id;
        var url1 = '@Url.Content("~/csat_settings_page/csat_updater_open_activity_show?taskid=")' + task_id + '&devicename=' + devicename + '&ipaddress=' + deviceip;
        $.ajax({
            type: "POST",
            url: url1,
            success: function (data) {
                if (data.csat_task_data_open_activity.length > 0) {
                    $('#apply_task').modal('show');
                    var dataclear = document.getElementById('div_open_apply_activity_div');
                    dataclear.innerHTML = '&nbsp;';
                    $('#div_open_apply_activity_div').append("<table id='div_open_apply_activity' class='table table-striped table-bordered' width='100%'></table>");
                    dtable = document.getElementById('div_open_apply_activity');
                    var data1 = [];
                    for (var i = 0; i < data.csat_task_data_open_activity.length; i++) {
                        //debugger;
                        data1.push([data.csat_task_data_open_activity[i].task_type, data.csat_task_data_open_activity[i].download_url_32, data.csat_task_data_open_activity[i].download_url_64, data.csat_task_data_open_activity[i].download_size_32, data.csat_task_data_open_activity[i].download_size_64, data.csat_task_data_open_activity[i].destination_path_32, data.csat_task_data_open_activity[i].destination_path_64, data.csat_task_data_open_activity[i].task_param_32, data.csat_task_data_open_activity[i].task_param_64]);
                    }
                    var dtable = $("#div_open_apply_activity").DataTable({
                        data: data1, scrollX: !0, searching: !1, dom: "<'top'lB>rt<'bottom'ip><'clear'>", buttons: ["colvis"],
                        columns: [{ title: "Activity Type" }, { title: "Download URL 32-bit" }, { title: "Download URL 64-bit" }, { title: "Size(KB) 32-bit" }, { title: "Size(KB) 64-bit" }, { title: "Destination Path 32-bit" }, { title: "Destination Path 64-bit" }, { title: "Command 32-bit" }, { title: "Command 64-bit" }]
                    });
                    $(".table").css({ "width": "100%" });
                    $(".dataTables_scrollHeadInner ").css({ "width": "100%" });
                    //debugger;
                    var agent_divclear = document.getElementById('div_apply_activity_devices_div');
                    agent_divclear.innerHTML = '&nbsp;';
                    $('#div_apply_activity_devices_div').append("<table id='div_apply_activity_devices' class='table table-striped table-bordered' width='100%'></table><div class='col-xs-11 pull-left'><input type='button' class='btn btn-primary' style='margin-bottom:15px;margin-top: -20px; margin-left: -8px;' value='Apply' id='task_apply_device' /></div>");
                    otable = document.getElementById('div_apply_activity_devices');
                    var data1 = [];
                    for (var i = 0; i < data.csat_task_apply_devices_search.length; i++) {
                        data1.push([data.csat_task_apply_devices_search[i].updater_device_id, data.csat_task_apply_devices_search[i].device_name, data.csat_task_apply_devices_search[i].ip, data.csat_task_apply_devices_search[i].mac]);
                    }
                    var otable = $("#div_apply_activity_devices").DataTable({
                        data: data1, scrollX: !0, searching: !1, dom: "<'top'lB>rt<'bottom'ip><'clear'>", buttons: ["colvis"],
                        'columnDefs': [{ 'targets': 0, 'checkboxes': { 'selectRow': true } }, { orderable: false, targets: 1 }], 'select': { 'style': 'multi' }, 'order': [[2, 'asc']],
                        columns: [{ title: "", width: '10px' }, { title: "System Name", width: '90px' }, { title: "IP Address", width: '50px' }, { title: "MAC Address", width: '60px' }]
                    });
                    $(".table").css({ "width": "100%" });
                    $(".dataTables_scrollHeadInner ").css({ "width": "100%" });
                    $('#task_apply_device').on('click', function (e) {
                       // debugger;
                        var form = this;
                        var rows_selected = otable.column(0).checkboxes.selected();
                        $.each(rows_selected, function (index) {
                            deviceidall = "";
                            for (var i = 0; i < rows_selected.length; i++) {
                                deviceidall += "," + rows_selected[i];
                            }
                            apply_task_on_devices(deviceidall)
                            return false;
                        });
                        if (deviceidall == "") {
                            deviceidall = "";
                            apply_task_on_devices(deviceidall)
                        }

                    });

                    var Setactivitydatadevices_search = $('#div_system_drp');
                    var Setactivitydataip_search = $('#div_ip_drp');
                    jQuery('#div_system_drp').html('');
                    jQuery('#div_ip_drp').html('');
                    var csat_updater_data_devices_search = "<select class='form-control col-sm - 3 col-lg - 3 col-md - 3' name='System' id='drp_System'><option>Select System Name</option>";
                    var csat_updater_data_ip_search = "<select class='form-control col-sm-3 col-lg-3 col-md-3' name='ip' id='drp_ip'><option>Select IP Address</option>";
                    for (var i = 0; i < data.csat_task_apply_devices.length; i++) {
                        csat_updater_data_devices_search += "<option>" + data.csat_task_apply_devices[i].device_name + "</option>";
                        csat_updater_data_ip_search += "<option>" + data.csat_task_apply_devices[i].ip + "</option>";
                    }
                    csat_updater_data_devices_search += "</select>";
                    csat_updater_data_ip_search += "</select>";
                    Setactivitydatadevices_search.append(csat_updater_data_devices_search);
                    Setactivitydataip_search.append(csat_updater_data_ip_search);
                }
                else {
                    alert('There are no activity in this task');
                }
            }
        });
    }
   function open_activity_popup(task_id) {
        //open popup for display activity
        //debugger;
        $('#activity_count').modal('show');

        document.getElementById("hdn_add_activity_task_id").value = task_id;
        var url1 = '@Url.Content("~/csat_settings_page/csat_updater_open_activity_show_only?taskid=")' + task_id;
        $.ajax({
            type: "POST",
            url: url1,
            success: function (data) {
                    var dataclear = document.getElementById('div_show_activity_only_div');
                    dataclear.innerHTML = '&nbsp;';
                    $('#div_show_activity_only_div').append("<table id='div_show_activity_only' class='table table-striped table-bordered' width='100%'></table>");
                    dtable = document.getElementById('div_show_activity_only');
                    var data1 = [];
                    for (var i = 0; i < data.csat_task_data_open_activity.length; i++) {
                        //debugger;
                        data1.push([data.csat_task_data_open_activity[i].task_type, data.csat_task_data_open_activity[i].download_url_32, data.csat_task_data_open_activity[i].download_url_64, data.csat_task_data_open_activity[i].download_size_32, data.csat_task_data_open_activity[i].download_size_64, data.csat_task_data_open_activity[i].destination_path_32, data.csat_task_data_open_activity[i].destination_path_64, data.csat_task_data_open_activity[i].task_param_32, data.csat_task_data_open_activity[i].task_param_64]);
                    }
                    var dtable = $("#div_show_activity_only").DataTable({
                        data: data1, scrollX: !0, searching: !1, dom: "<'top'lB>rt<'bottom'ip><'clear'>", buttons: ["colvis"],
                        columns: [{ title: "Activity Type" }, { title: "Download URL 32-bit" }, { title: "Download URL 64-bit" }, { title: "Size(KB) 32-bit" }, { title: "Size(KB) 64-bit" }, { title: "Destination Path 32-bit" }, { title: "Destination Path 64-bit" }, { title: "Command 32-bit" }, { title: "Command 64-bit" }]
                });
                $(".table").css({ "width": "100%" });
                $(".dataTables_scrollHeadInner ").css({ "width": "100%" });

            }
        });
    }

    function open_popup_apply_on_devices(task_id) {
        //open popup for display activity
        $('#apply_on_task').modal('show');
        var url1 = '@Url.Content("~/csat_settings_page/csat_updater_open_task_apply_on_devices?taskid=")' + task_id;
        $.ajax({
            type: "POST",
            url: url1,
            success: function (data) {
                //debugger;
                var dataclear = document.getElementById('div_apply_on_devices_div');
                dataclear.innerHTML = '&nbsp;';
                $('#div_apply_on_devices_div').append("<table id='div_apply_on_devices' class='table table-striped table-bordered' width='100%'></table>");
                dtable = document.getElementById('div_apply_on_devices');
                var data1 = [];
                for (var i = 0; i < data.csat_task_apply_on_devices.length; i++) {
                    //debugger;
                    data1.push([data.csat_task_apply_on_devices[i].device_name, data.csat_task_apply_on_devices[i].ip, data.csat_task_apply_on_devices[i].mac]);
                }
                var dtable = $("#div_apply_on_devices").DataTable({
                    data: data1, scrollX: !0, searching: !1, dom: "<'top'lB>rt<'bottom'ip><'clear'>", buttons: [],
                    columns: [{ title: "System Name" }, { title: "IP Address" }, { title: "MAC Address" }]
                });
                $(".table").css({ "width": "100%" });
                $(".dataTables_scrollHeadInner ").css({ "width": "100%" });

            }
        });
    }
    function open_popup_apply_success_devices(task_id) {
        //open popup for display activity
        $('#apply_success_task').modal('show');
        var url1 = '@Url.Content("~/csat_settings_page/csat_updater_open_task_apply_success_devices?taskid=")' + task_id;
        $.ajax({
            type: "POST",
            url: url1,
            success: function (data) {
                var dataclear = document.getElementById('div_apply_success_devices_div');
                dataclear.innerHTML = '&nbsp;';
                $('#div_apply_success_devices_div').append("<table id='div_apply_success_devices' class='table table-striped table-bordered' width='100%'></table>");
                dtable = document.getElementById('div_apply_success_devices');
                var data1 = [];
                for (var i = 0; i < data.csat_task_apply_success_devices.length; i++) {
                    //debugger;
                    data1.push([data.csat_task_apply_success_devices[i].device_name, data.csat_task_apply_success_devices[i].ip, data.csat_task_apply_success_devices[i].mac]);
                }
                var dtable = $("#div_apply_success_devices").DataTable({
                    data: data1, scrollX: !0, searching: !1, dom: "<'top'lB>rt<'bottom'ip><'clear'>", buttons: [],
                    columns: [{ title: "System Name" }, { title: "IP Address" }, { title: "MAC Address" }]
                });
                $(".table").css({ "width": "100%" });
                $(".dataTables_scrollHeadInner ").css({ "width": "100%" });

            }
        });
    }
    var taskid = "";
    function deletetaskdata(task_id) {
     //   debugger;
        taskid = task_id;
        $("#delete_task").modal('show');
    }

     $('#btndelete').on('click',function(){
         var url1 = '@Url.Content("~/csat_settings_page/csat_updater_task_delete?taskid=")' + taskid;
	 $.ajax({
            type: "POST",
            url:url1,
            success: function (result) {
			alert(result);
                $('#delete_task').modal('hide');
                //   DataTaskBind();
                DataBind();
			}
			});

	});
	$('#btndeletecancle').on('click',function(){
        $('#delete_task').modal('hide');
    });

        var deviceidall = "";
        function apply_task_on_devices(deviceidall) {
        //debugger;
        var task_id = document.getElementById("hdn_add_activity_task_id").value;
        //getcheckeddevice();
            if (deviceidall != "") {
                var url1 = '@Url.Content("~/csat_settings_page/csat_updater_apply_task_on_devices?taskid=")' + task_id + '&deviceids=' + deviceidall;
                $.ajax({
                    type: "POST",
                    url: url1,
                    success: function (data) {
                        alert(data);
                        $('#apply_task').modal('hide');
                        DataBind();
                        //Unchecksoftcount(chk_popup_activity_apply_device_header, chk_popup_activity_apply_device);
                    }
                });
            }
            else {
                alert('Please select atleast one device');

            }

    }
    function getcheckeddevice() {
        //debugger;
        deviceids = "";
        var checkboxes = document.querySelectorAll('input[id="chk_popup_activity_apply_device"]');
        for (var i = 0; i < checkboxes.length; i++) {
            if (checkboxes[i].checked == true) {
                deviceids += "," + checkboxes[i].value;
            }
            else {
            }
        }
    }
        function cleardata() {
        document.getElementById("activity_type").value = "1";
        document.getElementById("txt_task_name").value = "";
        document.getElementById("txt_task_desc").value = "";
        document.getElementById("txt_activity_file_32").value = "";
        document.getElementById("txt_activity_destination_path_32").value = "";
        document.getElementById("txt_activity_destination_path_64").value = "";
        document.getElementById("txt_activity_file_64").value = "";
        document.getElementById("txt_activity_command_32").value = "";
        document.getElementById("txt_activity_command_64").value = "";
        document.getElementById("txt_activity_working_directory").value = "";
        document.getElementById("txt_source_folder_path").value = '';
        document.getElementById("txt_source_filename").value = '';
        document.getElementById("txt_server_folder_path").value = '';
        document.getElementById("txt_server_filename").value = '';
    }
    //function Unchecksoftcount(headid, rawid) {
    //    // debugger;
    //    headid.checked = false;

    //    for (var i = 0; i < rawid.length; i++) {
    //        if (rawid[i].checked == true) {
    //            rawid[i].checked = false;
    //        }
    //        else {
    //        }
    //    }
    //}
    </script>
</body>